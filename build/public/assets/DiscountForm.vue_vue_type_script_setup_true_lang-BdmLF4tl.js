import{_ as K}from"./Switch-sBWkdoVy.js";import{a as O,_ as R}from"./Button-CI_-soaG.js";import{_ as L}from"./SelectMenu-DKAhKU-v.js";import{_ as z}from"./Card-BjL1m_sW.js";import{_ as H}from"./Textarea-CZyY9J1c.js";import{_ as G}from"./FormField-qFQ_28ZO.js";import{_ as J}from"./ColorModeButton-Bf7Nr8w3.js";import{d as Q,h as y,c as g,a as k,j as d,b as t,f as l,w as s,u as w,m as D,t as p,e as b,o as m,k as U,D as W,l as T}from"./app-CyjtdGoI.js";import{_ as X}from"./ProductSelector.vue_vue_type_script_setup_true_lang-BL_enzOX.js";import{_ as V}from"./CurrencyInput.vue_vue_type_script_setup_true_lang-D_sdRYGZ.js";const Y={class:"p-6 max-w-7xl mx-auto space-y-6"},Z={class:"flex items-center gap-4"},ee={class:"text-2xl font-bold text-gray-900 dark:text-white"},ae={class:"text-gray-500 dark:text-gray-400"},te={class:"space-y-4"},le={class:"space-y-4"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},se={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ie={class:"p-4 rounded-lg bg-primary-50 dark:bg-primary-900/20 border border-primary-200 dark:border-primary-800"},ne={class:"flex items-center gap-3"},de={class:"p-2 rounded-full bg-primary-100 dark:bg-primary-800"},re={class:"text-xl font-bold text-primary-700 dark:text-primary-300"},ue={class:"space-y-4"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pe={key:0,class:"text-xs text-gray-500"},ce={key:1,class:"text-xs text-gray-500"},ve={class:"flex items-center gap-3"},_e={key:0,class:"mt-2 text-sm text-red-500"},fe={class:"flex items-center justify-end gap-4"},Te=Q({__name:"DiscountForm",props:{discount:{},products:{},mode:{}},setup(c){const n=c,h=r=>r?new Date(r).toISOString().slice(0,16):"",P={name:"",description:"",type:"percentage",value:0,min_purchase:0,max_discount:null,start_date:"",end_date:"",usage_limit:null,is_active:!0,applies_to_all:!1,product_ids:[]},e=y(n.mode==="edit"&&n.discount?{name:n.discount.name,description:n.discount.description||"",type:n.discount.type,value:n.discount.value,min_purchase:n.discount.minPurchase,max_discount:n.discount.maxDiscount,start_date:h(n.discount.startDate),end_date:h(n.discount.endDate),usage_limit:n.discount.usageLimit,is_active:n.discount.isActive,applies_to_all:n.discount.appliesToAll,product_ids:n.discount.productIds||[]}:{...P}),v=y(!1),i=y({}),B=[{label:"Persentase (%)",value:"percentage"},{label:"Nominal (Rp)",value:"fixed"}],N=()=>(i.value={},e.value.name.trim()||(i.value.name="Nama diskon wajib diisi"),e.value.value<=0&&(i.value.value="Nilai diskon harus lebih dari 0"),e.value.type==="percentage"&&e.value.value>100&&(i.value.value="Nilai persentase maksimal 100%"),e.value.start_date||(i.value.start_date="Tanggal mulai wajib diisi"),e.value.end_date||(i.value.end_date="Tanggal selesai wajib diisi"),e.value.start_date&&e.value.end_date&&e.value.start_date>e.value.end_date&&(i.value.end_date="Tanggal selesai harus setelah tanggal mulai"),!e.value.applies_to_all&&e.value.product_ids.length===0&&(i.value.products='Pilih minimal satu produk atau aktifkan "Berlaku untuk semua produk"'),Object.keys(i.value).length===0),$=()=>{N()&&(v.value=!0,n.mode==="edit"&&n.discount?T.put(`/admin/promotions/discounts/${n.discount.id}`,e.value,{onFinish:()=>{v.value=!1},onError:r=>{i.value=r}}):T.post("/admin/promotions/discounts",e.value,{onFinish:()=>{v.value=!1},onError:r=>{i.value=r}}))},S=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(r),I=g(()=>e.value.type==="percentage"?`${e.value.value}%`:S(e.value.value)),j=g(()=>n.mode==="edit"?"Edit Diskon":"Buat Diskon Baru"),F=g(()=>n.mode==="edit"?n.discount?.name||"":"Buat diskon untuk customer dan terapkan ke produk pilihan"),C=g(()=>n.mode==="edit"?"Simpan Perubahan":"Simpan Diskon");return(r,a)=>{const x=O,_=J,u=G,M=H,f=z,q=L,A=R,E=K;return m(),k("div",Y,[d(" Header "),t("div",Z,[l(w(D),{href:"/admin/promotions/discounts"},{default:s(()=>[l(x,{icon:"i-heroicons-arrow-left",color:"neutral",variant:"ghost",size:"sm"})]),_:1}),t("div",null,[t("h1",ee,p(j.value),1),t("p",ae,p(F.value),1)])]),d(" Form "),t("form",{onSubmit:W($,["prevent"]),class:"space-y-6"},[d(" Basic Info "),l(f,null,{header:s(()=>[...a[13]||(a[13]=[t("h3",{class:"font-semibold text-gray-900 dark:text-white"},"Informasi Dasar",-1)])]),default:s(()=>[t("div",te,[l(u,{label:"Nama Diskon",error:i.value.name,required:""},{default:s(()=>[l(_,{modelValue:e.value.name,"onUpdate:modelValue":a[0]||(a[0]=o=>e.value.name=o),placeholder:"Contoh: Diskon Tahun Baru",color:i.value.name?"error":void 0,class:"w-full"},null,8,["modelValue","color"])]),_:1},8,["error"]),l(u,{label:"Deskripsi"},{default:s(()=>[l(M,{modelValue:e.value.description,"onUpdate:modelValue":a[1]||(a[1]=o=>e.value.description=o),placeholder:"Deskripsi singkat tentang diskon ini",rows:3,class:"w-full"},null,8,["modelValue"])]),_:1})])]),_:1}),d(" Discount Value "),l(f,null,{header:s(()=>[...a[14]||(a[14]=[t("h3",{class:"font-semibold text-gray-900 dark:text-white"},"Nilai Diskon",-1)])]),default:s(()=>[t("div",le,[t("div",oe,[l(u,{label:"Tipe Diskon",required:""},{default:s(()=>[l(q,{modelValue:e.value.type,"onUpdate:modelValue":a[2]||(a[2]=o=>e.value.type=o),items:B,"value-key":"value",class:"w-full"},null,8,["modelValue"])]),_:1}),l(u,{label:e.value.type==="percentage"?"Nilai (%)":"Nilai (Rp)",error:i.value.value,required:""},{default:s(()=>[e.value.type==="percentage"?(m(),b(_,{key:0,modelValue:e.value.value,"onUpdate:modelValue":a[3]||(a[3]=o=>e.value.value=o),modelModifiers:{number:!0},type:"number",min:0,max:100,placeholder:"10",color:i.value.value?"error":void 0,class:"w-full"},null,8,["modelValue","color"])):(m(),b(V,{key:1,modelValue:e.value.value,"onUpdate:modelValue":a[4]||(a[4]=o=>e.value.value=o),placeholder:"50.000",color:i.value.value?"error":void 0},null,8,["modelValue","color"]))]),_:1},8,["label","error"])]),t("div",se,[l(u,{label:"Minimal Pembelian"},{hint:s(()=>[...a[15]||(a[15]=[t("span",{class:"text-xs text-gray-500"},"Kosongkan jika tidak ada minimal",-1)])]),default:s(()=>[l(V,{modelValue:e.value.min_purchase,"onUpdate:modelValue":a[5]||(a[5]=o=>e.value.min_purchase=o),placeholder:"0"},null,8,["modelValue"])]),_:1}),e.value.type==="percentage"?(m(),b(u,{key:0,label:"Maksimal Diskon"},{hint:s(()=>[...a[16]||(a[16]=[t("span",{class:"text-xs text-gray-500"},"Kosongkan jika tidak ada batasan",-1)])]),default:s(()=>[l(V,{modelValue:e.value.max_discount,"onUpdate:modelValue":a[6]||(a[6]=o=>e.value.max_discount=o),placeholder:"Tidak ada batasan"},null,8,["modelValue"])]),_:1})):d("v-if",!0)]),d(" Preview "),t("div",ie,[t("div",ne,[t("div",de,[l(A,{name:"i-heroicons-tag",class:"w-5 h-5 text-primary-600 dark:text-primary-400"})]),t("div",null,[a[17]||(a[17]=t("p",{class:"text-sm text-primary-600 dark:text-primary-400"},"Preview Diskon",-1)),t("p",re,p(I.value),1)])])])])]),_:1}),d(" Period "),l(f,null,{header:s(()=>[...a[18]||(a[18]=[t("h3",{class:"font-semibold text-gray-900 dark:text-white"},"Periode & Penggunaan",-1)])]),default:s(()=>[t("div",ue,[t("div",me,[l(u,{label:"Tanggal Mulai",error:i.value.start_date,required:""},{default:s(()=>[l(_,{modelValue:e.value.start_date,"onUpdate:modelValue":a[7]||(a[7]=o=>e.value.start_date=o),type:"datetime-local",color:i.value.start_date?"error":void 0,class:"w-full"},null,8,["modelValue","color"])]),_:1},8,["error"]),l(u,{label:"Tanggal Selesai",error:i.value.end_date,required:""},{default:s(()=>[l(_,{modelValue:e.value.end_date,"onUpdate:modelValue":a[8]||(a[8]=o=>e.value.end_date=o),type:"datetime-local",color:i.value.end_date?"error":void 0,class:"w-full"},null,8,["modelValue","color"])]),_:1},8,["error"])]),l(u,{label:"Batas Penggunaan"},{hint:s(()=>[c.mode==="edit"&&c.discount?.usageCount?(m(),k("span",pe," Sudah digunakan: "+p(c.discount.usageCount)+" kali ",1)):(m(),k("span",ce," Kosongkan jika tidak ada batasan penggunaan "))]),default:s(()=>[l(_,{modelValue:e.value.usage_limit,"onUpdate:modelValue":a[9]||(a[9]=o=>e.value.usage_limit=o),modelModifiers:{number:!0},type:"number",min:0,placeholder:"Tidak ada batasan",class:"w-full"},null,8,["modelValue"])]),_:1}),t("div",ve,[l(E,{modelValue:e.value.is_active,"onUpdate:modelValue":a[10]||(a[10]=o=>e.value.is_active=o)},null,8,["modelValue"]),a[19]||(a[19]=t("div",null,[t("p",{class:"font-medium text-gray-900 dark:text-white"},"Aktifkan Diskon"),t("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," Diskon akan aktif sesuai periode yang ditentukan ")],-1))])])]),_:1}),d(" Products "),l(f,null,{header:s(()=>[...a[20]||(a[20]=[t("h3",{class:"font-semibold text-gray-900 dark:text-white"},"Produk",-1)])]),default:s(()=>[l(X,{products:c.products,"selected-ids":e.value.product_ids,"onUpdate:selectedIds":a[11]||(a[11]=o=>e.value.product_ids=o),"applies-to-all":e.value.applies_to_all,"onUpdate:appliesToAll":a[12]||(a[12]=o=>e.value.applies_to_all=o)},null,8,["products","selected-ids","applies-to-all"]),i.value.products?(m(),k("p",_e,p(i.value.products),1)):d("v-if",!0)]),_:1}),d(" Actions "),t("div",fe,[l(w(D),{href:"/admin/promotions/discounts"},{default:s(()=>[l(x,{color:"neutral",variant:"ghost",disabled:v.value},{default:s(()=>[...a[21]||(a[21]=[U(" Batal ",-1)])]),_:1},8,["disabled"])]),_:1}),l(x,{type:"submit",color:"primary",loading:v.value},{default:s(()=>[U(p(C.value),1)]),_:1},8,["loading"])])],32)])}}});export{Te as _};
