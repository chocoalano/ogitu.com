import{d as O,a as w,b as t,f as m,t as S,w as I,k as A,o as h,j as l,e as q,u as N,F as Z,r as me,T as _e,h as U,c as F,O as Ce,U as $e,V as re,W as L,q as le,A as Se,X as Y,x as Ie,Y as Ee,Z as te,I as Ue,D as ge,n as Ae,_ as Be,y as je,l as ae}from"./app-CyjtdGoI.js";import{A as Fe}from"./admin-BzR6vrex.js";import{a as W,_ as J,t as de,f as ue,c as ce,d as Ke,e as Te,h as Ne,i as De}from"./Button-CI_-soaG.js";import{_ as fe}from"./ColorModeButton-Bf7Nr8w3.js";import{_ as Ve}from"./Badge-DfumusWV.js";import{_ as pe}from"./Modal-Bgd8PL5Y.js";import{_ as Pe}from"./Checkbox-9qpvU9Db.js";import{_ as Me}from"./Textarea-CZyY9J1c.js";import{_ as qe}from"./Select-D6kv-Jzs.js";import"./Tooltip-BrTR-Vq7.js";import"./useFormControl-D_pV87FU.js";import"./VisuallyHiddenInput-BGOu5NlX.js";import"./Label-yeknIWsP.js";const ze={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Re={class:"text-sm text-slate-500 dark:text-slate-400 mt-1"},Oe=O({__name:"CategoryHeader",props:{storeName:{}},emits:["add"],setup(a,{emit:g}){const n=g;return(o,r)=>{const s=W;return h(),w("div",ze,[t("div",null,[r[1]||(r[1]=t("h1",{class:"text-2xl font-bold text-slate-900 dark:text-white"},"Kategori Produk",-1)),t("p",Re," Kelola kategori produk untuk toko "+S(a.storeName),1)]),m(s,{icon:"i-heroicons-plus",color:"primary",onClick:r[0]||(r[0]=b=>n("add"))},{default:I(()=>[...r[2]||(r[2]=[A(" Tambah Kategori ",-1)])]),_:1})])}}}),He={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Le={class:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700"},Ge={class:"flex items-center gap-3"},We={class:"w-10 h-10 rounded-lg bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center"},Je={class:"text-lg font-semibold text-slate-900 dark:text-white"},Qe={class:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700"},Xe={class:"flex items-center gap-3"},Ye={class:"w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center"},Ze={class:"text-lg font-semibold text-slate-900 dark:text-white"},et={class:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700"},tt={class:"flex items-center gap-3"},at={class:"w-10 h-10 rounded-lg bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center"},st={class:"text-lg font-semibold text-slate-900 dark:text-white"},nt={class:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700"},ot={class:"flex items-center gap-3"},it={class:"w-10 h-10 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center"},rt={class:"text-lg font-semibold text-slate-900 dark:text-white"},lt=O({__name:"CategoryStats",props:{stats:{}},setup(a){return(g,n)=>{const o=J;return h(),w("div",He,[l(" Total Categories "),t("div",Le,[t("div",Ge,[t("div",We,[m(o,{name:"i-heroicons-folder",class:"w-5 h-5 text-violet-500"})]),t("div",null,[n[0]||(n[0]=t("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Total Kategori",-1)),t("p",Je,S(a.stats.totalCategories),1)])])]),l(" Main Categories "),t("div",Qe,[t("div",Xe,[t("div",Ye,[m(o,{name:"i-heroicons-folder-open",class:"w-5 h-5 text-blue-500"})]),t("div",null,[n[1]||(n[1]=t("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Kategori Utama",-1)),t("p",Ze,S(a.stats.mainCategories),1)])])]),l(" Sub Categories "),t("div",et,[t("div",tt,[t("div",at,[m(o,{name:"i-heroicons-rectangle-stack",class:"w-5 h-5 text-amber-500"})]),t("div",null,[n[2]||(n[2]=t("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Sub-Kategori",-1)),t("p",st,S(a.stats.subCategories),1)])])]),l(" Active Categories "),t("div",nt,[t("div",ot,[t("div",it,[m(o,{name:"i-heroicons-check-circle",class:"w-5 h-5 text-green-500"})]),t("div",null,[n[3]||(n[3]=t("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Kategori Aktif",-1)),t("p",rt,S(a.stats.activeCategories),1)])])])])}}});function ve(){const a=s=>!(!s||s.includes("placehold.co")||s==="/images/placeholder.png"),g=(s,b="No Image")=>!s||s.includes("placehold.co")?`https://placehold.co/100x100/1a1a2e/ffffff?text=${encodeURIComponent(b)}`:s;return{getImageUrl:g,getCategoryImageUrl:s=>g(s,"Category"),getProductImageUrl:s=>g(s,"Product"),getAvatarUrl:s=>g(s,"User"),isValidImageUrl:a}}const dt={class:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden"},ut={class:"flex items-center gap-3 p-4 bg-slate-50 dark:bg-slate-900/30 hover:bg-slate-100 dark:hover:bg-slate-900/50 transition-colors"},ct={key:1,class:"w-6 h-6"},mt={class:"w-10 h-10 rounded-lg overflow-hidden bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center shrink-0"},gt=["src","alt"],ft={class:"flex-1 min-w-0"},pt={class:"flex items-center gap-2"},vt={class:"font-medium text-slate-900 dark:text-white"},ht={key:0,class:"text-xs text-slate-500 dark:text-slate-400 truncate"},bt={class:"flex items-center gap-1"},xt={key:0,class:"overflow-hidden"},yt={class:"divide-y divide-slate-200 dark:divide-slate-700"},kt={class:"w-8 h-8 rounded-lg overflow-hidden bg-slate-100 dark:bg-slate-700 flex items-center justify-center shrink-0"},wt=["src","alt"],_t={class:"flex-1 min-w-0"},Ct={class:"flex items-center gap-2"},$t={class:"text-sm text-slate-700 dark:text-slate-300"},St={key:0,class:"text-xs text-slate-500 dark:text-slate-400 truncate"},It={class:"flex items-center gap-1"},Et=O({__name:"CategoryItem",props:{category:{},isExpanded:{type:Boolean}},emits:["toggle","edit","delete","toggle-active"],setup(a,{emit:g}){const n=g,{getCategoryImageUrl:o,isValidImageUrl:r}=ve(),s=(_,p)=>{_.stopPropagation(),n("edit",p)},b=(_,p)=>{_.stopPropagation(),n("delete",p)},x=(_,p)=>{_.stopPropagation(),n("toggle-active",p)};return(_,p)=>{const B=J,y=Ve,c=W;return h(),w("div",dt,[l(" Parent Category Header "),t("div",ut,[l(" Expand Button "),a.category.children.length>0?(h(),w("button",{key:0,class:"w-6 h-6 flex items-center justify-center rounded hover:bg-slate-200 dark:hover:bg-slate-700",onClick:p[0]||(p[0]=u=>n("toggle"))},[m(B,{name:a.isExpanded?"i-heroicons-chevron-down":"i-heroicons-chevron-right",class:"w-4 h-4 text-slate-500 transition-transform"},null,8,["name"])])):(h(),w("div",ct)),l(" Category Icon "),t("div",mt,[N(r)(a.category.image)?(h(),w("img",{key:0,src:N(o)(a.category.image),alt:a.category.name,class:"w-full h-full object-cover"},null,8,gt)):(h(),q(B,{key:1,name:"i-heroicons-folder",class:"w-5 h-5 text-violet-500"}))]),l(" Category Info "),t("div",ft,[t("div",pt,[t("p",vt,S(a.category.name),1),a.category.isActive?l("v-if",!0):(h(),q(y,{key:0,color:"neutral",variant:"subtle",size:"xs"},{default:I(()=>[...p[4]||(p[4]=[A(" Nonaktif ",-1)])]),_:1}))]),a.category.description?(h(),w("p",ht,S(a.category.description),1)):l("v-if",!0)]),l(" Children Count "),a.category.children.length>0?(h(),q(y,{key:2,color:"primary",variant:"subtle",size:"sm"},{default:I(()=>[A(S(a.category.children.length)+" sub-kategori ",1)]),_:1})):l("v-if",!0),l(" Action Buttons "),t("div",bt,[m(c,{icon:"i-heroicons-pencil",color:"neutral",variant:"ghost",size:"xs",onClick:p[1]||(p[1]=u=>s(u,a.category))}),m(c,{icon:a.category.isActive?"i-heroicons-eye-slash":"i-heroicons-eye",color:a.category.isActive?"warning":"success",variant:"ghost",size:"xs",onClick:p[2]||(p[2]=u=>x(u,a.category))},null,8,["icon","color"]),m(c,{icon:"i-heroicons-trash",color:"error",variant:"ghost",size:"xs",onClick:p[3]||(p[3]=u=>b(u,a.category))})])]),l(" Children Categories (Collapsible) "),m(_e,{"enter-active-class":"transition-all duration-200 ease-out","enter-from-class":"opacity-0 max-h-0","enter-to-class":"opacity-100 max-h-[1000px]","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 max-h-[1000px]","leave-to-class":"opacity-0 max-h-0"},{default:I(()=>[a.isExpanded&&a.category.children.length>0?(h(),w("div",xt,[t("div",yt,[(h(!0),w(Z,null,me(a.category.children,u=>(h(),w("div",{key:u.id,class:"flex items-center gap-3 px-4 py-3 pl-16 hover:bg-slate-50 dark:hover:bg-slate-900/20 transition-colors"},[m(B,{name:"i-heroicons-arrow-turn-down-right",class:"w-4 h-4 text-slate-400 shrink-0"}),l(" Child Icon "),t("div",kt,[N(r)(u.image)?(h(),w("img",{key:0,src:N(o)(u.image),alt:u.name,class:"w-full h-full object-cover"},null,8,wt)):(h(),q(B,{key:1,name:"i-heroicons-tag",class:"w-4 h-4 text-slate-400"}))]),l(" Child Info "),t("div",_t,[t("div",Ct,[t("p",$t,S(u.name),1),u.isActive?l("v-if",!0):(h(),q(y,{key:0,color:"neutral",variant:"subtle",size:"xs"},{default:I(()=>[...p[5]||(p[5]=[A(" Nonaktif ",-1)])]),_:1}))]),u.description?(h(),w("p",St,S(u.description),1)):l("v-if",!0)]),l(" Child Action Buttons "),t("div",It,[m(c,{icon:"i-heroicons-pencil",color:"neutral",variant:"ghost",size:"xs",onClick:$=>s($,u)},null,8,["onClick"]),m(c,{icon:u.isActive?"i-heroicons-eye-slash":"i-heroicons-eye",color:u.isActive?"warning":"success",variant:"ghost",size:"xs",onClick:$=>x($,u)},null,8,["icon","color","onClick"]),m(c,{icon:"i-heroicons-trash",color:"error",variant:"ghost",size:"xs",onClick:$=>b($,u)},null,8,["onClick"])])]))),128))])])):l("v-if",!0)]),_:1})])}}}),Ut={class:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden"},At={class:"p-4 border-b border-slate-200 dark:border-slate-700"},Bt={class:"flex flex-col sm:flex-row gap-4"},jt={class:"flex-1"},Ft={key:0,class:"flex gap-2"},Kt={class:"p-4"},Tt={key:0,class:"text-center py-12"},Nt={class:"w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center mx-auto mb-4"},Dt={class:"text-center py-12"},Vt={class:"w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center mx-auto mb-4"},Pt={class:"text-sm text-slate-500 dark:text-slate-400 mt-1"},Mt={class:"space-y-3"},qt=O({__name:"CategoryList",props:{categories:{}},emits:["edit","delete","toggle-active"],setup(a,{emit:g}){const n=a,o=g,r=U(""),s=U(new Set),b=y=>{s.value.has(y)?s.value.delete(y):s.value.add(y)},x=()=>{n.categories.forEach(y=>{y.children.length>0&&s.value.add(y.id)})},_=()=>{s.value.clear()},p=F(()=>{if(!r.value.trim())return n.categories;const y=r.value.toLowerCase();return n.categories.filter(c=>c.name.toLowerCase().includes(y)?!0:c.children.some(u=>u.name.toLowerCase().includes(y)))}),B=F(()=>n.categories.some(y=>y.children.length>0));return(y,c)=>{const u=fe,$=J,k=W;return h(),w("div",Ut,[l(" Header with Search "),t("div",At,[t("div",Bt,[t("div",jt,[m(u,{modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=v=>r.value=v),placeholder:"Cari kategori...",icon:"i-heroicons-magnifying-glass"},null,8,["modelValue"])]),B.value?(h(),w("div",Ft,[m(k,{color:"neutral",variant:"outline",size:"sm",onClick:x},{default:I(()=>[m($,{name:"i-heroicons-arrows-pointing-out",class:"w-4 h-4 mr-1"}),c[5]||(c[5]=A(" Buka Semua ",-1))]),_:1}),m(k,{color:"neutral",variant:"outline",size:"sm",onClick:_},{default:I(()=>[m($,{name:"i-heroicons-arrows-pointing-in",class:"w-4 h-4 mr-1"}),c[6]||(c[6]=A(" Tutup Semua ",-1))]),_:1})])):l("v-if",!0)])]),l(" Categories List "),t("div",Kt,[l(" Empty State "),a.categories.length===0?(h(),w("div",Tt,[t("div",Nt,[m($,{name:"i-heroicons-folder",class:"w-8 h-8 text-slate-400"})]),c[7]||(c[7]=t("p",{class:"text-slate-900 dark:text-white font-medium"},"Belum ada kategori",-1)),c[8]||(c[8]=t("p",{class:"text-sm text-slate-500 dark:text-slate-400 mt-1"},' Klik tombol "Tambah Kategori" untuk menambahkan kategori baru ',-1))])):p.value.length===0?(h(),w(Z,{key:1},[l(" No Search Results "),t("div",Dt,[t("div",Vt,[m($,{name:"i-heroicons-magnifying-glass",class:"w-8 h-8 text-slate-400"})]),c[10]||(c[10]=t("p",{class:"text-slate-900 dark:text-white font-medium"},"Tidak ditemukan",-1)),t("p",Pt,' Tidak ada kategori yang cocok dengan pencarian "'+S(r.value)+'" ',1),m(k,{color:"neutral",variant:"outline",size:"sm",class:"mt-4",onClick:c[1]||(c[1]=v=>r.value="")},{default:I(()=>[...c[9]||(c[9]=[A(" Reset Pencarian ",-1)])]),_:1})])],2112)):(h(),w(Z,{key:2},[l(" Category Items "),t("div",Mt,[(h(!0),w(Z,null,me(p.value,v=>(h(),q(Et,{key:v.id,category:v,"is-expanded":s.value.has(v.id),onToggle:d=>b(v.id),onEdit:c[2]||(c[2]=d=>o("edit",d)),onDelete:c[3]||(c[3]=d=>o("delete",d)),onToggleActive:c[4]||(c[4]=d=>o("toggle-active",d))},null,8,["category","is-expanded","onToggle"]))),128))])],2112))])])}}});function zt(a){return"schema"in a&&typeof a.coercer=="function"&&typeof a.validator=="function"&&typeof a.refiner=="function"}function Rt(a){return"~standard"in a}async function Ot(a,g){const n=await g["~standard"].validate(a);return n.issues?{errors:n.issues?.map(o=>({name:o.path?.map(r=>typeof r=="object"?r.key:r).join(".")||"",message:o.message}))||[],result:null}:{errors:null,result:n.value}}async function Ht(a,g){const[n,o]=g.validate(a);return n?{errors:n.failures().map(s=>({message:s.message,name:s.path.join(".")})),result:null}:{errors:null,result:o}}function Lt(a,g){if(Rt(g))return Ot(a,g);if(zt(g))return Ht(a,g);throw new Error("Form validation failed: Unsupported form schema")}function Gt(a,g){return g?g.split(".").reduce((o,r)=>o?.[r],a):a}function Wt(a,g,n){if(!g)return Object.assign(a,n);if(!a)return a;const o=g.split(".");let r=a;for(let b=0;b<o.length-1;b++){const x=o[b];(r[x]===void 0||r[x]===null)&&(b+1<o.length&&!Number.isNaN(Number(o[b+1]))?r[x]=[]:r[x]={}),r=r[x]}const s=o[o.length-1];return r[s]=n,a}class G extends Error{formId;errors;constructor(g,n){super("Form validation exception"),this.formId=g,this.errors=n,Object.setPrototypeOf(this,G.prototype)}}const Jt={base:""},Qt={__name:"Form",props:{id:{type:[String,Number],required:!1},schema:{type:null,required:!1},state:{type:null,required:!1},validate:{type:Function,required:!1},validateOn:{type:Array,required:!1,default(){return["input","blur","change"]}},disabled:{type:Boolean,required:!1},name:{type:null,required:!1},validateOnInputDelay:{type:Number,required:!1,default:300},transform:{type:null,required:!1,default:()=>!0},nested:{type:Boolean,required:!1},loadingAuto:{type:Boolean,required:!1,default:!0},class:{type:null,required:!1},onSubmit:{type:Function,required:!1}},emits:["submit","error"],setup(a,{expose:g,emit:n}){const o=a,r=n,s=Ce(),b=F(()=>de({extend:de(Jt),...s.ui?.form||{}})),x=o.id??$e(),_=Ee(`form-${x}`),p=o.nested===!0&&re(ue,void 0),B=o.nested===!0?re(ce,void 0):void 0,y=F(()=>B?.value?o.name?Gt(B.value,o.name):B.value:o.state);L(ue,_),L(ce,y);const c=U(new Map);le(async()=>{p&&(await Se(),p.emit({type:"attach",validate:R,formId:x,name:o.name,api:ie}))}),Ie(()=>{_.reset(),p&&p.emit({type:"detach",formId:x})}),le(async()=>{_.on(async e=>{e.type==="attach"?c.value.set(e.formId,{validate:e.validate,name:e.name,api:e.api}):e.type==="detach"?c.value.delete(e.formId):o.validateOn?.includes(e.type)&&!K.value&&(e.type!=="input"?await R({name:e.name,silent:!0,nested:!1}):(e.eager||d.has(e.name))&&await R({name:e.name,silent:!0,nested:!1})),e.type==="blur"&&d.add(e.name),(e.type==="change"||e.type==="input"||e.type==="blur"||e.type==="focus")&&v.add(e.name),(e.type==="change"||e.type==="input")&&k.add(e.name)})});const u=U([]);L(Ne,u);const $=U({});L(De,$);const k=te(new Set),v=te(new Set),d=te(new Set);function j(e){return e.map(i=>({...i,id:i?.name?$.value[i.name]?.id:void 0}))}const E=U(null);async function P(){let e=o.validate?await o.validate(y.value)??[]:[];if(o.schema){const{errors:i,result:f}=await Lt(y.value,o.schema);i?e=e.concat(i):E.value=f}return j(e)}async function R(e={silent:!1,nested:!1,transform:!1}){const i=e.name&&!Array.isArray(e.name)?[e.name]:e.name;let f=[],C=[];if(!i&&e.nested){const z=Array.from(c.value.values()).map(V=>ee(V,e)),D=await Promise.all(z);C=D.filter(V=>V.error).flatMap(V=>V.error.errors.map(we=>M(we,V.name))),f=D.filter(V=>V.output!==void 0)}const H=[...await P(),...C];if(i?u.value=ye(H,i):u.value=H,u.value?.length){if(e.silent)return!1;throw new G(x,u.value)}return e.transform?(f.forEach(z=>{z.name?Wt(E.value,z.name,z.output):Object.assign(E.value,z.output)}),E.value??y.value):y.value}const K=U(!1);L(Ke,Y(K));async function Q(e){K.value=o.loadingAuto&&!0;const i=e;try{i.data=await R({nested:!0,transform:o.transform}),await o.onSubmit?.(i),k.clear()}catch(f){if(!(f instanceof G))throw f;const C={...i,errors:f.errors};r("error",C)}finally{K.value=!1}}const X=F(()=>o.disabled||K.value);L(Te,F(()=>({disabled:X.value,validateOnInputDelay:o.validateOnInputDelay})));async function ee(e,i){try{const f=await e.validate({...i,silent:!1});return{name:e.name,output:f}}catch(f){if(!(f instanceof G))throw f;return{name:e.name,error:f}}}function M(e,i){return!i||!e.name?e:{...e,name:i+"."+e.name}}function he(e,i){const f=i+".",C=e?.name?.startsWith(f)?e.name.substring(f.length):e.name;return{...e,name:C}}function be(e,i){return i?e.filter(f=>f?.name?.startsWith(i+".")).map(f=>he(f,i)):e}function se(e){return e.api.getErrors().map(i=>e.name?{...i,name:e.name+"."+i.name}:i)}function ne(e,i){return!e||!i?!0:e instanceof RegExp?e.test(i):i===e||typeof e=="string"&&e.startsWith(i+".")}function xe(e,i){if(!e||e instanceof RegExp)return e;if(i!==e)return typeof e=="string"&&e.startsWith(i+".")?e.substring(i.length+1):e}function ye(e,i){const f=new Set(i),C=i.map(D=>$.value?.[D]?.pattern).filter(Boolean),T=D=>D.name?f.has(D.name)?!0:C.some(V=>V.test(D.name)):!1,H=u.value.filter(D=>!T(D)),z=e.filter(T);return[...H,...z]}function ke(e,i){return e.filter(f=>i instanceof RegExp?!(f.name&&i.test(f.name)):!f.name||f.name!==i)}function oe(e){return!e.name||!!$.value[e.name]}const ie={validate:R,errors:u,setErrors(e,i){const f=j(e.filter(oe)),C=[];for(const T of c.value.values())if(ne(i,T.name)){const H=be(e,T.name);T.api.setErrors(H,xe(i,T.name||"")),C.push(...se(T))}if(i){const T=ke(u.value,i);u.value=[...T,...f,...C]}else u.value=[...f,...C]},async submit(){await Q(new Event("submit"))},getErrors(e){return e?u.value.filter(i=>e instanceof RegExp?i.name&&e.test(i.name):i.name===e):u.value},clear(e){const i=e?u.value.filter(C=>oe(C)&&(e instanceof RegExp?!(C.name&&e.test(C.name)):C.name!==e)):[],f=[];for(const C of c.value.values())ne(e,C.name)&&C.api.clear(),f.push(...se(C));u.value=[...i,...f]},disabled:X,loading:K,dirty:F(()=>!!k.size),dirtyFields:Y(k),blurredFields:Y(d),touchedFields:Y(v)};return g(ie),(e,i)=>(h(),q(Be(N(p)?"div":"form"),{id:N(x),class:Ae(b.value({class:o.class})),onSubmit:ge(Q,["prevent"])},{default:I(()=>[Ue(e.$slots,"default",{errors:u.value,loading:K.value})]),_:3},40,["id","class"]))}},Xt={class:"p-6"},Yt={class:"flex items-center gap-4 mb-6"},Zt={class:"w-12 h-12 rounded-full bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center"},ea={class:"text-lg font-semibold text-slate-900 dark:text-white"},ta={class:"text-sm text-slate-500 dark:text-slate-400"},aa={key:0,class:"relative w-32 h-32 mb-3"},sa=["src"],na={class:"flex items-center gap-3"},oa={class:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700"},ia=O({__name:"CategoryFormModal",props:{open:{type:Boolean},category:{},parentCategories:{},isSubmitting:{type:Boolean}},emits:["update:open","submit"],setup(a,{emit:g}){const n=a,o=g,{isValidImageUrl:r}=ve(),s=U({name:"",description:"",parentId:null,isActive:!0,image:null}),b=U(null),x=U(null),_=F(()=>!!n.category),p=F(()=>_.value?"Edit Kategori":"Tambah Kategori Baru"),B=F(()=>{const v=[{label:"Tidak ada (Kategori Utama)",value:null}];return n.parentCategories.forEach(d=>{(!n.category||d.id!==n.category.id)&&v.push({label:d.name,value:d.id})}),v});je(()=>[n.open,n.category],()=>{n.open&&(n.category?(s.value={name:n.category.name,description:n.category.description||"",parentId:n.category.parentId,isActive:n.category.isActive,image:null},b.value=r(n.category.image)?n.category.image:null):(s.value={name:"",description:"",parentId:null,isActive:!0,image:null},b.value=null))},{immediate:!0});const y=v=>{const j=v.target.files?.[0];if(j){s.value.image=j;const E=new FileReader;E.onload=P=>{b.value=P.target?.result},E.readAsDataURL(j)}},c=()=>{x.value?.click()},u=()=>{s.value.image=null,b.value=null,x.value&&(x.value.value="")},$=()=>{if(!s.value.name.trim())return;const v=new FormData;v.append("name",s.value.name.trim()),v.append("description",s.value.description.trim()),v.append("parentId",s.value.parentId?.toString()||""),v.append("isActive",s.value.isActive?"true":"false"),s.value.image&&v.append("image",s.value.image),o("submit",v)},k=()=>{o("update:open",!1)};return(v,d)=>{const j=J,E=fe,P=qe,R=Me,K=W,Q=Pe,X=Qt,ee=pe;return h(),q(ee,{open:a.open,"onUpdate:open":k,title:p.value,description:"Isi informasi kategori produk"},{content:I(()=>[t("div",Xt,[l(" Header "),t("div",Yt,[t("div",Zt,[m(j,{name:_.value?"i-heroicons-pencil-square":"i-heroicons-folder-plus",class:"w-6 h-6 text-violet-500"},null,8,["name"])]),t("div",null,[t("h3",ea,S(p.value),1),t("p",ta,S(_.value?"Perbarui informasi kategori":"Tambahkan kategori baru untuk produk"),1)])]),l(" Form "),m(X,{onSubmit:ge($,["prevent"]),class:"space-y-4"},{default:I(()=>[l(" Name "),t("div",null,[d[4]||(d[4]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"},[A(" Nama Kategori "),t("span",{class:"text-red-500"},"*")],-1)),m(E,{modelValue:s.value.name,"onUpdate:modelValue":d[0]||(d[0]=M=>s.value.name=M),placeholder:"Masukkan nama kategori",disabled:a.isSubmitting,class:"w-full"},null,8,["modelValue","disabled"])]),l(" Parent Category "),t("div",null,[d[5]||(d[5]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"}," Kategori Induk ",-1)),m(P,{modelValue:s.value.parentId,"onUpdate:modelValue":d[1]||(d[1]=M=>s.value.parentId=M),items:B.value,"value-key":"value",placeholder:"Pilih kategori induk",disabled:a.isSubmitting,class:"w-full"},null,8,["modelValue","items","disabled"]),d[6]||(d[6]=t("p",{class:"text-xs text-slate-500 dark:text-slate-400 mt-1"}," Kosongkan untuk membuat kategori utama ",-1))]),l(" Description "),t("div",null,[d[7]||(d[7]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"}," Deskripsi ",-1)),m(R,{modelValue:s.value.description,"onUpdate:modelValue":d[2]||(d[2]=M=>s.value.description=M),placeholder:"Deskripsi singkat kategori (opsional)",rows:3,disabled:a.isSubmitting,class:"w-full"},null,8,["modelValue","disabled"])]),l(" Image Upload "),t("div",null,[d[8]||(d[8]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1"}," Gambar Kategori ",-1)),t("input",{ref_key:"fileInputRef",ref:x,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",class:"hidden",onChange:y},null,544),l(" Preview "),b.value?(h(),w("div",aa,[t("img",{src:b.value,alt:"Preview",class:"w-full h-full object-cover rounded-lg border border-slate-200 dark:border-slate-700"},null,8,sa),t("button",{type:"button",class:"absolute -top-2 -right-2 w-6 h-6 rounded-full bg-red-500 text-white flex items-center justify-center hover:bg-red-600 transition-colors",onClick:u},[m(j,{name:"i-heroicons-x-mark",class:"w-4 h-4"})])])):l("v-if",!0),l(" Upload Button "),m(K,{type:"button",color:"neutral",variant:"outline",onClick:c,disabled:a.isSubmitting},{default:I(()=>[m(j,{name:"i-heroicons-photo",class:"w-4 h-4 mr-2"}),A(" "+S(b.value?"Ganti Gambar":"Pilih Gambar"),1)]),_:1},8,["disabled"]),d[9]||(d[9]=t("p",{class:"text-xs text-slate-500 dark:text-slate-400 mt-1"}," Format: JPG, PNG, WebP, GIF. Maks. 2MB ",-1))]),l(" Active Status "),t("div",na,[m(Q,{modelValue:s.value.isActive,"onUpdate:modelValue":d[3]||(d[3]=M=>s.value.isActive=M),disabled:a.isSubmitting},null,8,["modelValue","disabled"]),d[10]||(d[10]=t("label",{class:"text-sm text-slate-700 dark:text-slate-300"}," Kategori aktif ",-1))]),l(" Actions "),t("div",oa,[m(K,{type:"button",color:"neutral",variant:"outline",onClick:k,disabled:a.isSubmitting},{default:I(()=>[...d[11]||(d[11]=[A(" Batal ",-1)])]),_:1},8,["disabled"]),m(K,{type:"submit",color:"primary",loading:a.isSubmitting,disabled:!s.value.name.trim()},{default:I(()=>[A(S(_.value?"Simpan Perubahan":"Tambah Kategori"),1)]),_:1},8,["loading","disabled"])])]),_:1})])]),_:1},8,["open","title"])}}}),ra={class:"p-6"},la={class:"flex items-center gap-4 mb-4"},da={class:"w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center"},ua={key:0,class:"mb-6"},ca={class:"text-slate-600 dark:text-slate-400"},ma={class:"text-slate-900 dark:text-white"},ga={key:0,class:"mt-3 p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg border border-amber-200 dark:border-amber-800"},fa={class:"flex items-start gap-2"},pa={class:"text-sm font-medium text-amber-800 dark:text-amber-200"},va={class:"flex justify-end gap-3"},ha=O({__name:"CategoryDeleteModal",props:{open:{type:Boolean},category:{},isDeleting:{type:Boolean}},emits:["update:open","confirm"],setup(a,{emit:g}){const n=g,o=()=>{n("update:open",!1)};return(r,s)=>{const b=J,x=W,_=pe;return h(),q(_,{open:a.open,"onUpdate:open":o,title:"Hapus Kategori",description:"Konfirmasi penghapusan kategori"},{content:I(()=>[t("div",ra,[l(" Header "),t("div",la,[t("div",da,[m(b,{name:"i-heroicons-trash",class:"w-6 h-6 text-red-500"})]),s[1]||(s[1]=t("div",null,[t("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white"},"Hapus Kategori"),t("p",{class:"text-sm text-slate-500 dark:text-slate-400"}," Tindakan ini tidak dapat dibatalkan ")],-1))]),l(" Content "),a.category?(h(),w("div",ua,[t("p",ca,[s[2]||(s[2]=A(" Apakah Anda yakin ingin menghapus kategori ",-1)),t("strong",ma,'"'+S(a.category.name)+'"',1),s[3]||(s[3]=A("? ",-1))]),a.category.children&&a.category.children.length>0?(h(),w("div",ga,[t("div",fa,[m(b,{name:"i-heroicons-exclamation-triangle",class:"w-5 h-5 text-amber-500 shrink-0 mt-0.5"}),t("div",null,[t("p",pa," Kategori ini memiliki "+S(a.category.children.length)+" sub-kategori ",1),s[4]||(s[4]=t("p",{class:"text-xs text-amber-600 dark:text-amber-400 mt-1"}," Hapus semua sub-kategori terlebih dahulu sebelum menghapus kategori ini ",-1))])])])):l("v-if",!0)])):l("v-if",!0),l(" Actions "),t("div",va,[m(x,{color:"neutral",variant:"outline",onClick:o,disabled:a.isDeleting},{default:I(()=>[...s[5]||(s[5]=[A(" Batal ",-1)])]),_:1},8,["disabled"]),m(x,{color:"error",onClick:s[0]||(s[0]=p=>n("confirm")),loading:a.isDeleting,disabled:a.category?.children&&a.category.children.length>0},{default:I(()=>[...s[6]||(s[6]=[A(" Hapus Kategori ",-1)])]),_:1},8,["loading","disabled"])])])]),_:1},8,["open"])}}}),ba={class:"space-y-6"},ja=O({layout:Fe,__name:"categories",props:{categories:{default:()=>[]},admin:{default:()=>({id:0,storeName:"",slug:"",status:""})}},setup(a){const g=a,n=U(!1),o=U(!1),r=U(null),s=U(!1),b=U(!1),x=F(()=>{const k=g.categories.length,v=g.categories.reduce((E,P)=>E+P.children.length,0),d=k+v;let j=g.categories.filter(E=>E.isActive).length;return g.categories.forEach(E=>{j+=E.children.filter(P=>P.isActive).length}),{totalCategories:d,mainCategories:k,subCategories:v,activeCategories:j}}),_=F(()=>g.categories.map(k=>({id:k.id,name:k.name}))),p=()=>{r.value=null,n.value=!0},B=k=>{r.value=k,n.value=!0},y=k=>{r.value=k,o.value=!0},c=k=>{s.value=!0;const v=r.value?`/admin/products/categories/${r.value.id}`:"/admin/products/categories";ae.post(v,k,{preserveScroll:!0,onSuccess:()=>{n.value=!1,r.value=null},onFinish:()=>{s.value=!1}})},u=()=>{r.value&&(b.value=!0,ae.delete(`/admin/products/categories/${r.value.id}`,{preserveScroll:!0,onSuccess:()=>{o.value=!1,r.value=null},onFinish:()=>{b.value=!1}}))},$=k=>{ae.patch(`/admin/products/categories/${k.id}/toggle`,{},{preserveScroll:!0})};return(k,v)=>(h(),w("div",ba,[l(" Page Header "),m(N(Oe),{"store-name":a.admin.storeName,onAdd:p},null,8,["store-name"]),l(" Stats Cards "),m(N(lt),{stats:x.value},null,8,["stats"]),l(" Categories List "),m(N(qt),{categories:a.categories,onEdit:B,onDelete:y,onToggleActive:$},null,8,["categories"]),l(" Form Modal (Create/Edit) "),m(N(ia),{open:n.value,"onUpdate:open":v[0]||(v[0]=d=>n.value=d),category:r.value,"parent-categories":_.value,"is-submitting":s.value,onSubmit:c},null,8,["open","category","parent-categories","is-submitting"]),l(" Delete Modal "),m(N(ha),{open:o.value,"onUpdate:open":v[1]||(v[1]=d=>o.value=d),category:r.value,"is-deleting":b.value,onConfirm:u},null,8,["open","category","is-deleting"])]))}});export{ja as default};
