import{h as V,c as k,x as ae,d as P,a as c,n as R,j as l,b as t,I as w,f as r,t as $,F,r as D,o as d,D as G,w as C,k as p,q as se,e as z,u as y,T as oe}from"./app-CyjtdGoI.js";import{_ as le}from"./default.vue_vue_type_script_setup_true_lang-CxtMHnvj.js";import{g as ne,_ as X}from"./ColorModeButton-Bf7Nr8w3.js";import{_ as U,a as q}from"./Button-CI_-soaG.js";import{_ as re}from"./Checkbox-9qpvU9Db.js";import"./Modal-Bgd8PL5Y.js";import"./Badge-DfumusWV.js";import"./DropdownMenu-DxuVXSbh.js";import"./useFormControl-D_pV87FU.js";import"./VisuallyHiddenInput-BGOu5NlX.js";import"./Label-yeknIWsP.js";function ie(e){const{basePath:b,defaultRedirect:s,otpExpiryTime:n=300}=e,i=ne(),g=V("credentials"),x=V(!1),v=V(!1),h=V(""),f=V({email:"",password:"",remember:!1}),m=V(""),a=V(n),o=V(null),S=V(!1),_=k(()=>g.value==="credentials"),L=k(()=>g.value==="otp"),A=k(()=>!!f.value.email&&!!f.value.password),O=k(()=>m.value.length===6),K=u=>{const T=Math.floor(u/60),I=u%60;return`${T}:${I.toString().padStart(2,"0")}`},N=k(()=>K(a.value)),J=()=>{const u=document.cookie.match(/XSRF-TOKEN=([^;]+)/);return u?decodeURIComponent(u[1]):""},j=async(u,T)=>{try{const B=await(await fetch(`${b}${u}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-XSRF-TOKEN":J()},body:JSON.stringify(T)})).json();return{success:B.success??!1,data:B,message:B.message,redirect:B.redirect}}catch(I){return console.error(`API request error (${u}):`,I),{success:!1,message:"Terjadi kesalahan, silakan coba lagi"}}},E=()=>{a.value=n,S.value=!1,o.value&&clearInterval(o.value),o.value=setInterval(()=>{a.value--,a.value<=0&&(S.value=!0,o.value&&clearInterval(o.value))},1e3)},M=()=>{o.value&&(clearInterval(o.value),o.value=null)},Q=async()=>{if(v.value||!A.value)return!1;h.value="",v.value=!0;try{const u=await j("/send-otp",{email:f.value.email,password:f.value.password});return u.success?(g.value="otp",E(),i.success(u.message||"Kode OTP telah dikirim ke email Anda"),!0):(h.value=u.message||"Gagal mengirim OTP",i.error(u.message||"Gagal mengirim OTP"),!1)}finally{v.value=!1}},W=async u=>{if(x.value||!O.value)return!1;h.value="",x.value=!0;try{const T=await j("/verify-otp",{email:f.value.email,otp:m.value,remember:f.value.remember,redirect:u});return T.success?(i.success(T.message||"Login berhasil!"),setTimeout(()=>{globalThis.window?.location?.assign(T.redirect||s)},500),!0):(h.value=T.message||"Verifikasi OTP gagal",i.error(T.message||"Verifikasi OTP gagal"),!1)}finally{x.value=!1}},Y=async()=>{if(!S.value||v.value)return!1;v.value=!0,h.value="";try{const u=await j("/resend-otp",{email:f.value.email,type:"login"});return u.success?(i.success("Kode OTP baru telah dikirim"),E(),m.value="",!0):(i.error(u.message||"Gagal mengirim ulang OTP"),!1)}finally{v.value=!1}},Z=()=>{g.value="credentials",m.value="",h.value="",M()},ee=()=>{g.value="credentials",f.value={email:"",password:"",remember:!1},m.value="",h.value="",x.value=!1,v.value=!1,M()},te=u=>{f.value={...f.value,...u}};return ae(()=>{M()}),{step:g,form:f,otpCode:m,otpExpiry:a,canResend:S,isLoading:x,isSendingOtp:v,errorMessage:h,isCredentialsStep:_,isOtpStep:L,isFormValid:A,isOtpValid:O,formattedOtpExpiry:N,sendOtp:Q,verifyOtp:W,resendOtp:Y,goBack:Z,reset:ee,setForm:te,formatTime:K}}const de={class:"relative z-10 flex flex-col justify-center items-center text-white p-12 w-full"},ue={class:"w-24 h-24 bg-white/20 backdrop-blur-sm rounded-3xl flex items-center justify-center mb-8 shadow-2xl"},me={class:"text-4xl font-bold mb-4 text-center"},ce={class:"text-xl text-white/80 mb-12 text-center"},ge={key:0,class:"space-y-6 w-full max-w-sm"},fe={class:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center shrink-0"},ve={class:"font-semibold"},he={class:"text-sm text-white/70"},pe=P({__name:"AuthLoginSidebar",props:{logoIcon:{default:"i-heroicons-building-storefront"},title:{default:"Admin Center"},subtitle:{default:"Kelola toko dan produk Anda"},features:{default:()=>[]},gradientFrom:{default:"emerald-600"},gradientVia:{default:"teal-600"},gradientTo:{default:"cyan-500"}},setup(e){return(b,s)=>{const n=U;return d(),c("div",{class:R(["hidden lg:flex lg:w-1/2 relative overflow-hidden",`bg-linear-to-br from-${e.gradientFrom} via-${e.gradientVia} to-${e.gradientTo}`])},[l(" Background Pattern "),s[0]||(s[0]=t("div",{class:"absolute inset-0 opacity-10"},[t("div",{class:"absolute top-20 left-20 w-72 h-72 bg-white rounded-full blur-3xl"}),t("div",{class:"absolute bottom-20 right-20 w-96 h-96 bg-white rounded-full blur-3xl"}),t("div",{class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-white rounded-full blur-2xl"})],-1)),l(" Content "),t("div",de,[l(" Logo "),t("div",ue,[r(n,{name:e.logoIcon,class:"w-14 h-14 text-white"},null,8,["name"])]),t("h1",me,$(e.title),1),t("p",ce,$(e.subtitle),1),l(" Features "),e.features.length>0?(d(),c("div",ge,[(d(!0),c(F,null,D(e.features,(i,g)=>(d(),c("div",{key:g,class:"flex items-center gap-4 bg-white/10 backdrop-blur-sm rounded-2xl p-4"},[t("div",fe,[r(n,{name:i.icon,class:"w-6 h-6"},null,8,["name"])]),t("div",null,[t("div",ve,$(i.title),1),t("div",he,$(i.description),1)])]))),128))])):l("v-if",!0),l(" Custom Slot for additional content "),w(b.$slots,"default")])],2)}}}),be={class:"w-16 h-16 bg-linear-to-br from-emerald-500 to-teal-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg shadow-emerald-500/30"},xe={class:"text-2xl font-bold text-gray-900 dark:text-white"},ye=P({__name:"AuthMobileLogo",props:{logoIcon:{default:"i-heroicons-building-storefront"},title:{default:"Admin Center"},mobileOnly:{type:Boolean,default:!0}},setup(e){return(b,s)=>{const n=U;return d(),c("div",{class:R([e.mobileOnly?"lg:hidden":"","text-center mb-8"])},[t("div",be,[r(n,{name:e.logoIcon,class:"w-9 h-9 text-white"},null,8,["name"])]),t("h1",xe,$(e.title),1),w(b.$slots,"default")],2)}}}),ke={class:"flex items-center justify-center gap-3 mb-8"},we={key:0,class:"w-12 h-1 rounded-full bg-gray-200 dark:bg-gray-700 overflow-hidden"},$e=P({__name:"AuthStepIndicator",props:{currentStep:{},totalSteps:{default:2},activeColor:{default:"emerald"}},setup(e){return(b,s)=>(d(),c("div",ke,[(d(!0),c(F,null,D(e.totalSteps,n=>(d(),c(F,{key:n},[l(" Step Circle "),t("div",{class:R(["w-10 h-10 rounded-full flex items-center justify-center font-semibold transition-all",n<=e.currentStep?`bg-${e.activeColor}-500 text-white shadow-lg shadow-${e.activeColor}-500/30`:n===e.currentStep+1?"bg-gray-200 text-gray-400 dark:bg-gray-700":`bg-${e.activeColor}-100 text-${e.activeColor}-600 dark:bg-${e.activeColor}-900/30`])},$(n),3),l(" Connector Line (not after last step) "),n<e.totalSteps?(d(),c("div",we,[t("div",{class:R(["h-full rounded-full transition-all",`bg-${e.activeColor}-500`,n<e.currentStep?"w-full":"w-0"])},null,2)])):l("v-if",!0)],64))),128))]))}}),Ve={key:0,class:"p-4 rounded-xl bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"},Se={class:"flex items-center gap-3"},Te={class:"w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/30 flex items-center justify-center shrink-0"},Oe={class:"text-sm text-red-700 dark:text-red-400"},H=P({__name:"AuthErrorAlert",props:{message:{}},setup(e){return(b,s)=>{const n=U;return e.message?(d(),c("div",Ve,[t("div",Se,[t("div",Te,[r(n,{name:"i-heroicons-exclamation-circle",class:"w-5 h-5 text-red-500"})]),t("span",Oe,$(e.message),1)])])):l("v-if",!0)}}}),_e={class:"text-center mb-8"},Ce={class:"text-2xl font-bold text-gray-900 dark:text-white"},Pe={class:"mt-2 text-gray-600 dark:text-gray-400"},Le={class:"space-y-2"},Ae={class:"space-y-2"},Ue={class:"flex items-center justify-between"},Ie=["href"],Be={key:0,class:"mt-8 p-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-xl border border-emerald-200 dark:border-emerald-800"},Re={class:"text-sm text-emerald-800 dark:text-emerald-200 text-center"},je=["href"],Me={key:1,class:"mt-4 text-center text-sm text-gray-600 dark:text-gray-400"},Fe=["href"],Ke=P({__name:"AuthCredentialsForm",props:{modelValue:{},errorMessage:{default:""},isLoading:{type:Boolean,default:!1},submitText:{default:"Kirim Kode OTP"},submitIcon:{default:"i-heroicons-paper-airplane"},showRegisterLink:{type:Boolean,default:!0},registerUrl:{default:"/admin/register"},showCustomerLink:{type:Boolean,default:!0},customerLoginUrl:{default:"/login"},forgotPasswordUrl:{default:"/forgot-password"}},emits:["update:modelValue","submit"],setup(e,{emit:b}){const s=e,n=b,i=V(!1),g=k({get:()=>s.modelValue.email,set:a=>n("update:modelValue",{...s.modelValue,email:a})}),x=k({get:()=>s.modelValue.password,set:a=>n("update:modelValue",{...s.modelValue,password:a})}),v=k({get:()=>s.modelValue.remember,set:a=>n("update:modelValue",{...s.modelValue,remember:a})}),h=k(()=>!!g.value&&!!x.value),f=()=>{!h.value||s.isLoading||n("submit")},m=()=>{i.value=!i.value};return(a,o)=>{const S=X,_=q,L=re,A=U;return d(),c("div",null,[l(" Header "),t("div",_e,[t("h2",Ce,[w(a.$slots,"title",{},()=>[o[3]||(o[3]=p("Login Admin",-1))])]),t("p",Pe,[w(a.$slots,"subtitle",{},()=>[o[4]||(o[4]=p("Masuk ke Admin Center",-1))])])]),l(" Form "),t("form",{onSubmit:G(f,["prevent"]),class:"space-y-5"},[l(" Error Alert "),r(H,{message:e.errorMessage},null,8,["message"]),l(" Email "),t("div",Le,[o[5]||(o[5]=t("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Email",-1)),r(S,{modelValue:g.value,"onUpdate:modelValue":o[0]||(o[0]=O=>g.value=O),type:"email",placeholder:"email@example.com",icon:"i-heroicons-envelope",size:"lg",class:"w-full",autocomplete:"email",ui:{rounded:"rounded-xl"}},null,8,["modelValue"])]),l(" Password "),t("div",Ae,[o[6]||(o[6]=t("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Password",-1)),r(S,{modelValue:x.value,"onUpdate:modelValue":o[1]||(o[1]=O=>x.value=O),type:i.value?"text":"password",placeholder:"••••••••",icon:"i-heroicons-lock-closed",size:"lg",class:"w-full",autocomplete:"current-password",ui:{rounded:"rounded-xl"}},{trailing:C(()=>[r(_,{icon:i.value?"i-heroicons-eye-slash":"i-heroicons-eye",color:"neutral",variant:"ghost",size:"xs",onClick:m},null,8,["icon"])]),_:1},8,["modelValue","type"])]),l(" Remember Me & Forgot Password "),t("div",Ue,[r(L,{modelValue:v.value,"onUpdate:modelValue":o[2]||(o[2]=O=>v.value=O),label:"Ingat saya"},null,8,["modelValue"]),t("a",{href:e.forgotPasswordUrl,class:"text-sm font-medium text-emerald-600 hover:text-emerald-500"}," Lupa password? ",8,Ie)]),l(" Submit Button "),r(_,{type:"submit",color:"primary",size:"lg",block:"",loading:e.isLoading,disabled:e.isLoading||!h.value,class:"rounded-xl h-12 bg-linear-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700"},{default:C(()=>[r(A,{name:e.submitIcon,class:"w-5 h-5 mr-2"},null,8,["name"]),p(" "+$(e.submitText),1)]),_:1},8,["loading","disabled"])],32),l(" Register Link "),e.showRegisterLink?(d(),c("div",Be,[t("p",Re,[w(a.$slots,"register-text",{},()=>[o[7]||(o[7]=p("Belum menjadi admin?",-1))]),t("a",{href:e.registerUrl,class:"font-semibold hover:underline ml-1"},[w(a.$slots,"register-link-text",{},()=>[o[8]||(o[8]=p("Daftar Sekarang",-1))])],8,je)])])):l("v-if",!0),l(" Back to Customer "),e.showCustomerLink?(d(),c("p",Me,[t("a",{href:e.customerLoginUrl,class:"font-medium text-gray-500 hover:text-gray-700"},[r(A,{name:"i-heroicons-arrow-left",class:"w-4 h-4 inline mr-1"}),w(a.$slots,"customer-link-text",{},()=>[o[9]||(o[9]=p("Login sebagai Customer",-1))])],8,Fe)])):l("v-if",!0)])}}}),Ee={class:"text-center mb-8"},ze={class:"w-20 h-20 bg-linear-to-br from-emerald-100 to-teal-100 dark:from-emerald-900/30 dark:to-teal-900/30 rounded-2xl flex items-center justify-center mx-auto mb-4"},De={class:"text-2xl font-bold text-gray-900 dark:text-white"},Ge={class:"mt-2 text-gray-600 dark:text-gray-400"},Xe={class:"font-semibold text-emerald-600 dark:text-emerald-400"},qe={class:"space-y-2"},He={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Ne={class:"text-center"},Je={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Qe={class:"font-semibold text-emerald-600"},We=["disabled"],Ye={key:0},Ze={key:1},et={class:"mt-8 p-4 bg-gray-100 dark:bg-gray-800 rounded-xl"},tt={class:"flex items-start gap-3"},at={class:"text-xs text-gray-500 dark:text-gray-400"},st=P({__name:"AuthOtpForm",props:{modelValue:{},email:{},errorMessage:{default:""},isVerifying:{type:Boolean,default:!1},isResending:{type:Boolean,default:!1},remainingTime:{},canResend:{type:Boolean},otpLength:{default:6}},emits:["update:modelValue","submit","resend","back"],setup(e,{emit:b}){const s=e,n=b,i=k({get:()=>s.modelValue,set:m=>n("update:modelValue",m)}),g=k(()=>i.value.length===s.otpLength),x=m=>{const a=Math.floor(m/60),o=m%60;return`${a}:${o.toString().padStart(2,"0")}`},v=()=>{!g.value||s.isVerifying||n("submit")},h=()=>{!s.canResend||s.isResending||n("resend")},f=()=>{n("back")};return(m,a)=>{const o=U,S=X,_=q;return d(),c("div",null,[l(" Header "),t("div",Ee,[t("div",ze,[r(o,{name:"i-heroicons-shield-check",class:"w-10 h-10 text-emerald-600 dark:text-emerald-400"})]),t("h2",De,[w(m.$slots,"title",{},()=>[a[1]||(a[1]=p("Verifikasi OTP",-1))])]),t("p",Ge,[w(m.$slots,"subtitle",{},()=>[a[2]||(a[2]=p("Masukkan kode OTP yang dikirim ke",-1))])]),t("p",Xe,$(e.email),1)]),l(" OTP Form "),t("form",{onSubmit:G(v,["prevent"]),class:"space-y-6"},[l(" Error Alert "),r(H,{message:e.errorMessage},null,8,["message"]),l(" OTP Input "),t("div",qe,[t("label",He," Kode OTP ("+$(e.otpLength)+" digit) ",1),r(S,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=L=>i.value=L),type:"text",placeholder:"000000",icon:"i-heroicons-key",size:"lg",class:"w-full",maxlength:e.otpLength,pattern:"[0-9]*",inputmode:"numeric",autocomplete:"one-time-code",ui:{rounded:"rounded-xl",base:"text-center tracking-[0.5em] font-mono text-2xl"}},null,8,["modelValue","maxlength"])]),l(" Timer / Resend "),t("div",Ne,[e.canResend?(d(),c("button",{key:1,type:"button",onClick:h,disabled:e.isResending,class:"text-sm font-semibold text-emerald-600 hover:text-emerald-500 disabled:opacity-50"},[e.isResending?(d(),c("span",Ye,"Mengirim...")):(d(),c("span",Ze,"Kirim Ulang Kode OTP"))],8,We)):(d(),c("p",Je,[a[3]||(a[3]=p(" Kode berlaku selama ",-1)),t("span",Qe,$(x(e.remainingTime)),1)]))]),l(" Verify Button "),r(_,{type:"submit",color:"primary",size:"lg",block:"",loading:e.isVerifying,disabled:e.isVerifying||!g.value,class:"rounded-xl h-12 bg-linear-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700"},{default:C(()=>[r(o,{name:"i-heroicons-check-circle",class:"w-5 h-5 mr-2"}),w(m.$slots,"submit-text",{},()=>[a[4]||(a[4]=p("Verifikasi & Login",-1))])]),_:3},8,["loading","disabled"]),l(" Back Button "),r(_,{type:"button",color:"neutral",variant:"ghost",block:"",onClick:f,class:"rounded-xl"},{default:C(()=>[r(o,{name:"i-heroicons-arrow-left",class:"w-5 h-5 mr-2"}),a[5]||(a[5]=p(" Kembali ",-1))]),_:1})],32),l(" Info "),t("div",et,[t("div",tt,[r(o,{name:"i-heroicons-information-circle",class:"w-5 h-5 text-gray-500 shrink-0 mt-0.5"}),t("p",at,[w(m.$slots,"info-text",{},()=>[a[6]||(a[6]=p(" Kode OTP berlaku selama 5 menit. Periksa folder spam jika email tidak ditemukan di inbox. ",-1))])])])])])}}}),ot={class:"min-h-screen flex"},lt={class:"flex-1 flex items-center justify-center bg-gray-50 dark:bg-gray-950 p-4 sm:p-8"},nt={class:"w-full max-w-md"},bt=P({layout:le,__name:"login",props:{redirect:{}},setup(e){const b=e,s=ie({basePath:"/admin/auth",defaultRedirect:"/admin/dashboard"}),n=k(()=>b.redirect||"/admin/dashboard"),i=k(()=>s.isOtpStep.value?2:1),g=[{icon:"i-heroicons-chart-bar",title:"Dashboard Analytics",description:"Pantau performa penjualan Anda"},{icon:"i-heroicons-cube",title:"Manajemen Produk",description:"Upload dan atur produk dengan mudah"},{icon:"i-heroicons-truck",title:"Kelola Pesanan",description:"Proses pesanan pelanggan Anda"}],x=()=>s.sendOtp(),v=()=>s.verifyOtp(n.value),h=()=>s.resendOtp(),f=()=>s.goBack();return se(()=>{}),(m,a)=>(d(),c("div",ot,[l(" Left Side - Decorative Sidebar "),r(pe,{title:"Admin Center",subtitle:"Kelola toko dan produk Anda",features:g}),l(" Right Side - Form "),t("div",lt,[t("div",nt,[l(" Mobile Logo "),r(ye,{title:"Admin Center"}),l(" Step Indicator "),r($e,{"current-step":i.value,"total-steps":2},null,8,["current-step"]),l(" Form Steps with Transition "),r(oe,{"enter-active-class":"transition-all duration-300","enter-from-class":"opacity-0 translate-x-4","enter-to-class":"opacity-100 translate-x-0","leave-active-class":"transition-all duration-300","leave-from-class":"opacity-100 translate-x-0","leave-to-class":"opacity-0 -translate-x-4",mode:"out-in"},{default:C(()=>[y(s).isCredentialsStep.value?(d(),z(Ke,{key:"credentials",modelValue:y(s).form.value,"onUpdate:modelValue":a[0]||(a[0]=o=>y(s).form.value=o),"error-message":y(s).errorMessage.value,"is-loading":y(s).isSendingOtp.value,onSubmit:x},{title:C(()=>[...a[2]||(a[2]=[p("Login Admin",-1)])]),subtitle:C(()=>[...a[3]||(a[3]=[p("Masuk ke Admin Center OGITU",-1)])]),_:1},8,["modelValue","error-message","is-loading"])):(d(),z(st,{key:"otp",modelValue:y(s).otpCode.value,"onUpdate:modelValue":a[1]||(a[1]=o=>y(s).otpCode.value=o),email:y(s).form.value.email,"error-message":y(s).errorMessage.value,"is-verifying":y(s).isLoading.value,"is-resending":y(s).isSendingOtp.value,"remaining-time":y(s).otpExpiry.value,"can-resend":y(s).canResend.value,onSubmit:v,onResend:h,onBack:f},null,8,["modelValue","email","error-message","is-verifying","is-resending","remaining-time","can-resend"]))]),_:1})])])]))}});export{bt as default};
