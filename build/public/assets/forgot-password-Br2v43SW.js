import{_ as E,a as N}from"./Button-CI_-soaG.js";import{_ as R,g as U}from"./ColorModeButton-Bf7Nr8w3.js";import{d as L,h as c,c as S,a as p,j as a,b as t,P as X,f as s,n as _,w as b,o as v,D as V,t as k,k as g,T as F}from"./app-CyjtdGoI.js";import{_ as M}from"./default.vue_vue_type_script_setup_true_lang-CxtMHnvj.js";import"./Modal-Bgd8PL5Y.js";import"./Badge-DfumusWV.js";import"./DropdownMenu-DxuVXSbh.js";import"./Checkbox-9qpvU9Db.js";import"./useFormControl-D_pV87FU.js";import"./VisuallyHiddenInput-BGOu5NlX.js";import"./Label-yeknIWsP.js";const z={class:"min-h-screen flex"},$={class:"hidden lg:flex lg:w-1/2 bg-linear-to-br from-purple-600 via-pink-600 to-orange-500 relative overflow-hidden"},J={class:"relative z-10 flex flex-col justify-center items-center text-white p-12"},D={class:"w-24 h-24 bg-white/20 backdrop-blur-sm rounded-3xl flex items-center justify-center mb-8 shadow-2xl"},G={class:"flex-1 flex items-center justify-center bg-gray-50 dark:bg-gray-950 p-4 sm:p-8"},H={class:"w-full max-w-md"},q={class:"lg:hidden text-center mb-8"},Q={class:"w-16 h-16 bg-linear-to-br from-purple-500 to-pink-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg shadow-purple-500/30"},W={class:"flex items-center justify-center gap-3 mb-8"},Y={class:"w-12 h-1 rounded-full bg-gray-200 dark:bg-gray-700"},Z={key:"email"},ee={class:"text-center mb-8"},te={class:"w-20 h-20 bg-linear-to-br from-purple-100 to-pink-100 dark:from-purple-900/30 dark:to-pink-900/30 rounded-2xl flex items-center justify-center mx-auto mb-4"},ae={key:0,class:"p-4 rounded-xl bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"},se={class:"flex items-center gap-3"},oe={class:"w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/30 flex items-center justify-center"},le={class:"text-sm text-red-700 dark:text-red-400"},re={class:"space-y-2"},ie={key:"otp"},ne={class:"text-center mb-8"},de={class:"w-20 h-20 bg-linear-to-br from-purple-100 to-pink-100 dark:from-purple-900/30 dark:to-pink-900/30 rounded-2xl flex items-center justify-center mx-auto mb-4"},ue={class:"font-semibold text-purple-600 dark:text-purple-400"},ce={key:0,class:"p-4 rounded-xl bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"},me={class:"flex items-center gap-3"},pe={class:"w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/30 flex items-center justify-center"},ve={class:"text-sm text-red-700 dark:text-red-400"},fe={class:"space-y-2"},xe={class:"text-center"},ge={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},be={class:"font-semibold text-purple-600"},ke=["disabled"],he={class:"mt-8 p-4 bg-gray-100 dark:bg-gray-800 rounded-xl"},ye={class:"flex items-start gap-3"},Ae=L({layout:M,__name:"forgot-password",setup(we){const u=c("email"),n=U(),o=c(!1),r=c(""),f=c(""),x=c(0),m=c(null),K=c(""),d=c(""),T=S(()=>d.value.trim()!==""&&d.value.includes("@")),O=S(()=>f.value.length===6),h=()=>{const l=document.cookie.match(/XSRF-TOKEN=([^;]+)/);return l?decodeURIComponent(l[1]):""},j=()=>{x.value=60,m.value&&clearInterval(m.value),m.value=setInterval(()=>{x.value>0?x.value--:m.value&&clearInterval(m.value)},1e3)},C=async()=>{if(!(!T.value||o.value)){r.value="",o.value=!0;try{const e=await(await fetch("/auth/forgot-password/send-otp",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-XSRF-TOKEN":h()},body:JSON.stringify({email:d.value})})).json();e.success?(n.success("Kode OTP telah dikirim ke email Anda"),u.value="otp",j()):(r.value=e.message||"Gagal mengirim OTP",n.error(e.message||"Gagal mengirim OTP"))}catch(l){console.error("Send OTP error:",l),r.value="Terjadi kesalahan, silakan coba lagi",n.error("Terjadi kesalahan, silakan coba lagi")}finally{o.value=!1}}},I=async()=>{if(!(!O.value||o.value)){r.value="",o.value=!0;try{const e=await(await fetch("/auth/forgot-password/verify-otp",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-XSRF-TOKEN":h()},body:JSON.stringify({email:d.value,otp:f.value})})).json();e.success?(n.success("Verifikasi berhasil!"),K.value=e.token,window.location.href=`/reset-password?email=${encodeURIComponent(d.value)}&token=${encodeURIComponent(e.token)}`):(r.value=e.message||"Kode OTP tidak valid",n.error(e.message||"Kode OTP tidak valid"))}catch(l){console.error("Verify OTP error:",l),r.value="Terjadi kesalahan, silakan coba lagi",n.error("Terjadi kesalahan, silakan coba lagi")}finally{o.value=!1}}},B=async()=>{if(!(x.value>0||o.value)){o.value=!0,r.value="";try{const e=await(await fetch("/auth/resend-otp",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-XSRF-TOKEN":h()},body:JSON.stringify({email:d.value,type:"forgot_password"})})).json();e.success?(n.success("Kode OTP baru telah dikirim"),j(),f.value=""):n.error(e.message||"Gagal mengirim ulang OTP")}catch(l){console.error("Resend OTP error:",l),n.error("Terjadi kesalahan, silakan coba lagi")}finally{o.value=!1}}},A=()=>{u.value==="otp"&&(u.value="email",f.value="",m.value&&clearInterval(m.value))};return(l,e)=>{const i=E,P=R,y=N;return v(),p("div",z,[a(" Left Side - Decorative "),t("div",$,[a(" Background Pattern "),e[5]||(e[5]=t("div",{class:"absolute inset-0 opacity-10"},[t("div",{class:"absolute top-20 left-20 w-72 h-72 bg-white rounded-full blur-3xl"}),t("div",{class:"absolute bottom-20 right-20 w-96 h-96 bg-white rounded-full blur-3xl"}),t("div",{class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-white rounded-full blur-2xl"})],-1)),a(" Content "),t("div",J,[a(" Logo "),t("div",D,[s(i,{name:"i-heroicons-bolt",class:"w-14 h-14 text-white"})]),e[2]||(e[2]=t("h1",{class:"text-4xl font-bold mb-4 text-center"},"Lupa Password?",-1)),e[3]||(e[3]=t("p",{class:"text-xl text-white/80 mb-12 text-center"},"Jangan khawatir, kami akan bantu Anda",-1)),a(" Steps Info "),e[4]||(e[4]=X('<div class="space-y-6 w-full max-w-sm"><div class="flex items-center gap-4 bg-white/10 backdrop-blur-sm rounded-2xl p-4"><div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center font-bold text-lg"> 1 </div><div><div class="font-semibold">Masukkan Email</div><div class="text-sm text-white/70">Email yang terdaftar di akun Anda</div></div></div><div class="flex items-center gap-4 bg-white/10 backdrop-blur-sm rounded-2xl p-4"><div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center font-bold text-lg"> 2 </div><div><div class="font-semibold">Verifikasi OTP</div><div class="text-sm text-white/70">Masukkan kode yang dikirim ke email</div></div></div><div class="flex items-center gap-4 bg-white/10 backdrop-blur-sm rounded-2xl p-4"><div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center font-bold text-lg"> 3 </div><div><div class="font-semibold">Buat Password Baru</div><div class="text-sm text-white/70">Atur password baru untuk akun Anda</div></div></div></div>',1))])]),a(" Right Side - Form "),t("div",G,[t("div",H,[a(" Mobile Logo "),t("div",q,[t("div",Q,[s(i,{name:"i-heroicons-bolt",class:"w-9 h-9 text-white"})]),e[6]||(e[6]=t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Lupa Password",-1))]),a(" Step Indicator "),t("div",W,[t("div",{class:_(["w-10 h-10 rounded-full flex items-center justify-center font-semibold transition-all",u.value==="email"?"bg-purple-500 text-white shadow-lg shadow-purple-500/30":"bg-purple-100 text-purple-600 dark:bg-purple-900/30"])}," 1 ",2),t("div",Y,[t("div",{class:_(["h-full rounded-full bg-purple-500 transition-all",u.value==="otp"?"w-full":"w-0"])},null,2)]),t("div",{class:_(["w-10 h-10 rounded-full flex items-center justify-center font-semibold transition-all",u.value==="otp"?"bg-purple-500 text-white shadow-lg shadow-purple-500/30":"bg-gray-200 text-gray-400 dark:bg-gray-700"])}," 2 ",2)]),s(F,{"enter-active-class":"transition-all duration-300","enter-from-class":"opacity-0 translate-x-4","enter-to-class":"opacity-100 translate-x-0","leave-active-class":"transition-all duration-300","leave-from-class":"opacity-100 translate-x-0","leave-to-class":"opacity-0 -translate-x-4",mode:"out-in"},{default:b(()=>[u.value==="email"?(v(),p("div",Z,[a(" Header "),t("div",ee,[t("div",te,[s(i,{name:"i-heroicons-key",class:"w-10 h-10 text-purple-600 dark:text-purple-400"})]),e[7]||(e[7]=t("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Reset Password ",-1)),e[8]||(e[8]=t("p",{class:"mt-2 text-gray-600 dark:text-gray-400"}," Masukkan email Anda untuk menerima kode verifikasi ",-1))]),a(" Form "),t("form",{onSubmit:V(C,["prevent"]),class:"space-y-6"},[a(" Error Alert "),r.value?(v(),p("div",ae,[t("div",se,[t("div",oe,[s(i,{name:"i-heroicons-exclamation-circle",class:"w-5 h-5 text-red-500"})]),t("span",le,k(r.value),1)])])):a("v-if",!0),a(" Email Input "),t("div",re,[e[9]||(e[9]=t("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Email",-1)),s(P,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=w=>d.value=w),type:"email",placeholder:"email@example.com",icon:"i-heroicons-envelope",size:"lg",class:"w-full",autocomplete:"email",ui:{rounded:"rounded-xl"}},null,8,["modelValue"])]),a(" Submit Button "),s(y,{type:"submit",color:"primary",size:"lg",block:"",loading:o.value,disabled:!T.value||o.value,class:"rounded-xl h-12 bg-linear-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700"},{default:b(()=>[s(i,{name:"i-heroicons-paper-airplane",class:"w-5 h-5 mr-2"}),e[10]||(e[10]=g(" Kirim Kode OTP ",-1))]),_:1},8,["loading","disabled"])],32),a(" Back to Login "),e[11]||(e[11]=t("p",{class:"mt-8 text-center text-sm text-gray-600 dark:text-gray-400"},[g(" Ingat password Anda? "),t("a",{href:"/login",class:"font-semibold text-primary-600 hover:text-primary-500 ml-1"}," Kembali ke Login ")],-1))])):u.value==="otp"?(v(),p("div",ie,[a(" Header "),t("div",ne,[t("div",de,[s(i,{name:"i-heroicons-envelope-open",class:"w-10 h-10 text-purple-600 dark:text-purple-400"})]),e[12]||(e[12]=t("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Verifikasi Email ",-1)),e[13]||(e[13]=t("p",{class:"mt-2 text-gray-600 dark:text-gray-400"}," Masukkan kode OTP yang dikirim ke ",-1)),t("p",ue,k(d.value),1)]),a(" OTP Form "),t("form",{onSubmit:V(I,["prevent"]),class:"space-y-6"},[a(" Error Alert "),r.value?(v(),p("div",ce,[t("div",me,[t("div",pe,[s(i,{name:"i-heroicons-exclamation-circle",class:"w-5 h-5 text-red-500"})]),t("span",ve,k(r.value),1)])])):a("v-if",!0),a(" OTP Input "),t("div",fe,[e[14]||(e[14]=t("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Kode OTP (6 digit)",-1)),s(P,{modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=w=>f.value=w),type:"text",placeholder:"000000",icon:"i-heroicons-key",size:"lg",class:"w-full",maxlength:"6",pattern:"[0-9]*",inputmode:"numeric",autocomplete:"one-time-code",ui:{rounded:"rounded-xl",base:"text-center tracking-[0.5em] font-mono text-2xl"}},null,8,["modelValue"])]),a(" Timer & Resend "),t("div",xe,[x.value>0?(v(),p("p",ge,[e[15]||(e[15]=g(" Kirim ulang kode dalam ",-1)),t("span",be,k(x.value),1),e[16]||(e[16]=g(" detik ",-1))])):(v(),p("button",{key:1,type:"button",onClick:B,disabled:o.value,class:"text-sm font-semibold text-purple-600 hover:text-purple-500 disabled:opacity-50"}," Kirim Ulang Kode OTP ",8,ke))]),a(" Verify Button "),s(y,{type:"submit",color:"primary",size:"lg",block:"",loading:o.value,disabled:!O.value||o.value,class:"rounded-xl h-12 bg-linear-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700"},{default:b(()=>[s(i,{name:"i-heroicons-check-circle",class:"w-5 h-5 mr-2"}),e[17]||(e[17]=g(" Verifikasi OTP ",-1))]),_:1},8,["loading","disabled"]),a(" Back Button "),s(y,{type:"button",color:"neutral",variant:"ghost",block:"",onClick:A,class:"rounded-xl"},{default:b(()=>[s(i,{name:"i-heroicons-arrow-left",class:"w-5 h-5 mr-2"}),e[18]||(e[18]=g(" Kembali ",-1))]),_:1})],32),a(" Info "),t("div",he,[t("div",ye,[s(i,{name:"i-heroicons-information-circle",class:"w-5 h-5 text-gray-500 shrink-0 mt-0.5"}),e[19]||(e[19]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," Kode OTP berlaku selama 5 menit. Periksa folder spam jika email tidak ditemukan di inbox. ",-1))])])])):a("v-if",!0)]),_:1})])])])}}});export{Ae as default};
