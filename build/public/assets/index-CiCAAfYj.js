import{_ as Q,a as K}from"./Button-CI_-soaG.js";import{h as $,y as Me,l as Re,d as X,a as r,b as e,f as d,t as i,o as a,j as c,F as j,r as P,n as _e,e as A,w as y,k as S,D as Ce,J as $e,u as n,S as I}from"./app-CyjtdGoI.js";import{g as Le,_ as Se}from"./ColorModeButton-Bf7Nr8w3.js";import{g as W,A as je}from"./admin-BzR6vrex.js";import{_ as le}from"./Badge-DfumusWV.js";import{_ as Ae}from"./Checkbox-9qpvU9Db.js";import{_ as oe}from"./Modal-Bgd8PL5Y.js";import{_ as Ue}from"./Select-D6kv-Jzs.js";import"./Tooltip-BrTR-Vq7.js";import"./useFormControl-D_pV87FU.js";import"./VisuallyHiddenInput-BGOu5NlX.js";import"./Label-yeknIWsP.js";function Ne(){const t=Le(),f=$(null),u=$(null),w=$(null),M=$(null),v=$(!1),l=$(!1),C=$(!1),o=$(!1),T=$(!1),p=$([]),s=$(1),L=$(!1),h=$(!1),N=$(!1),k=$(""),D=$([]),E=$(null),x=$(!1),B=$(null),re=$([]),Y=$(!1),z=$(!1),U=$([]),Z=$(""),ee=$(!1),G=$(""),J=$([]),O=$(null),F=$(1),V=$(!1),q=$(!1),H=async m=>{f.value=m,v.value=!0,p.value=[];try{const g=await fetch(`/admin/network/${m.id}/referred-customers`),R=await g.json();g.ok?u.value=R:t.error(R.error||"Gagal memuat data referral")}catch{t.error("Gagal memuat data referral")}finally{v.value=!1}},ie=async m=>{f.value=m,l.value=!0,N.value=!0;try{const g=await fetch(`/admin/network/${m.id}/tree`),R=await g.json();g.ok?(w.value=R.tree??null,M.value=R.stats??null):t.error(R.error||"Gagal memuat tree network")}catch{t.error("Gagal memuat tree network")}finally{l.value=!1}},de=async(m,g=1)=>{if(f.value){C.value=!0;try{const R=await fetch("/admin/network/place",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-XSRF-TOKEN":W()},body:JSON.stringify({affiliateId:f.value.id,customerId:m,level:g})}),ae=await R.json();R.ok?(t.success(ae.message||"Customer berhasil ditempatkan"),await H(f.value)):t.error(ae.error||"Gagal menempatkan customer")}catch{t.error("Gagal menempatkan customer")}finally{C.value=!1}}},ce=async()=>{if(!(!f.value||p.value.length===0)){C.value=!0;try{const m=await fetch("/admin/network/bulk-place",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-XSRF-TOKEN":W()},body:JSON.stringify({affiliateId:f.value.id,customerIds:p.value,level:s.value})}),g=await m.json();m.ok?(t.success(g.message||"Customers berhasil ditempatkan"),p.value=[],L.value=!1,await H(f.value)):t.error(g.error||"Gagal menempatkan customers")}catch{t.error("Gagal menempatkan customers")}finally{C.value=!1}}},ue=async m=>{if(globalThis.confirm("Apakah Anda yakin ingin menghapus member ini dari tree?"))try{const g=await fetch(`/admin/network/referral/${m}`,{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","X-XSRF-TOKEN":W()}}),R=await g.json();g.ok?(t.success(R.message||"Member berhasil dihapus dari tree"),f.value&&await H(f.value)):t.error(R.error||"Gagal menghapus member")}catch{t.error("Gagal menghapus member")}},me=async()=>{if(k.value.length<2){D.value=[];return}o.value=!0;try{const m=await fetch(`/admin/network/customers-without-affiliate?search=${encodeURIComponent(k.value)}`),g=await m.json();m.ok&&(D.value=g.customers??[])}catch(m){console.error("Failed to search customers",m)}finally{o.value=!1}},fe=async()=>{if(!E.value){t.error("Pilih customer terlebih dahulu");return}T.value=!0;try{const m=await fetch("/admin/network/create-affiliate",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-XSRF-TOKEN":W()},body:JSON.stringify({customerId:E.value})}),g=await m.json();m.ok?(t.success(g.message||"Akun affiliate berhasil dibuat"),ne(),Re.reload()):t.error(g.error||"Gagal membuat akun affiliate")}catch{t.error("Gagal membuat akun affiliate")}finally{T.value=!1}},ve=m=>{const g=p.value.indexOf(m);g===-1?p.value.push(m):p.value.splice(g,1)},xe=()=>{u.value&&(p.value.length===u.value.unplacedCustomers.length?p.value=[]:p.value=u.value.unplacedCustomers.map(m=>m.id))},ne=()=>{h.value=!1,k.value="",D.value=[],E.value=null},te=async m=>{f.value=m,Y.value=!0,x.value=!0,U.value=[];try{const g=await fetch(`/admin/network/${m.id}/affiliated-customers`),R=await g.json();g.ok?B.value=R:t.error(R.error||"Gagal memuat data customers terafiliasi")}catch{t.error("Gagal memuat data customers terafiliasi")}finally{Y.value=!1}},he=async(m,g)=>{if(f.value){z.value=!0;try{const R=await fetch("/admin/network/setup-referral-code",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-XSRF-TOKEN":W()},body:JSON.stringify({customerId:m,customReferralCode:g||void 0})}),ae=await R.json();R.ok?(t.success(ae.message||"Kode referral berhasil dibuat"),await te(f.value),Z.value=""):t.error(ae.error||"Gagal membuat kode referral")}catch{t.error("Gagal membuat kode referral")}finally{z.value=!1}}},ge=async()=>{if(!(!f.value||U.value.length===0)){z.value=!0;try{const m=await fetch("/admin/network/bulk-setup-referral-codes",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-XSRF-TOKEN":W()},body:JSON.stringify({customerIds:U.value})}),g=await m.json();m.ok?(t.success(g.message||"Kode referral berhasil dibuat"),U.value=[],await te(f.value)):t.error(g.error||"Gagal membuat kode referral batch")}catch{t.error("Gagal membuat kode referral batch")}finally{z.value=!1}}},pe=m=>{const g=U.value.indexOf(m);g===-1?U.value.push(m):U.value.splice(g,1)},ke=()=>{B.value&&(U.value.length===B.value.withoutReferralCode.length?U.value=[]:U.value=B.value.withoutReferralCode.map(m=>m.id))},be=()=>{x.value=!1,B.value=null,U.value=[],Z.value=""},ye=async()=>{if(G.value.length<2||!f.value){J.value=[];return}V.value=!0;try{const m=await fetch(`/admin/network/${f.value.id}/search-customers?search=${encodeURIComponent(G.value)}`),g=await m.json();m.ok&&(J.value=g.customers??[])}catch(m){console.error("Failed to search customers",m)}finally{V.value=!1}},we=async()=>{if(!(!f.value||!O.value)){q.value=!0;try{const m=await fetch("/admin/network/add-member",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","X-XSRF-TOKEN":W()},body:JSON.stringify({affiliateId:f.value.id,customerId:O.value,level:F.value})}),g=await m.json();m.ok?(t.success(g.message||"Member berhasil ditambahkan ke tree"),b(),await H(f.value),Re.reload()):t.error(g.error||"Gagal menambahkan member ke tree")}catch{t.error("Gagal menambahkan member ke tree")}finally{q.value=!1}}},Te=m=>{f.value=m,ee.value=!0},b=()=>{ee.value=!1,G.value="",J.value=[],O.value=null,F.value=1};let se=null;Me(k,()=>{se&&clearTimeout(se),se=setTimeout(()=>{me()},300)});let _=null;return Me(G,()=>{_&&clearTimeout(_),_=setTimeout(()=>{ye()},300)}),{selectedAffiliate:f,referredCustomers:u,networkTree:w,networkStats:M,selectedCustomers:p,placementLevel:s,newAffiliateSearch:k,newAffiliateCustomers:D,selectedNewCustomer:E,affiliatedCustomersData:B,affiliatedCustomersWithoutCode:re,selectedCustomersForReferral:U,customReferralCode:Z,showAddMemberModal:ee,addMemberSearch:G,addMemberCustomers:J,selectedAddMemberCustomer:O,selectedAddMemberLevel:F,isSearchingAddMember:V,isAddingMember:q,isLoading:v,isLoadingTree:l,isPlacing:C,isSearchingCustomers:o,isCreatingAffiliate:T,isLoadingAffiliatedCustomers:Y,isSettingUpReferralCode:z,showPlacementModal:L,showCreateAffiliateModal:h,showTreeModal:N,showSetupReferralModal:x,loadReferredCustomers:H,loadNetworkTree:ie,placeCustomer:de,bulkPlaceCustomers:ce,removeFromTree:ue,createAffiliate:fe,toggleCustomerSelection:ve,selectAllUnplaced:xe,closeCreateAffiliateModal:ne,loadAffiliatedCustomers:te,setupReferralCode:he,bulkSetupReferralCodes:ge,toggleReferralCustomerSelection:pe,selectAllWithoutReferralCode:ke,closeSetupReferralModal:be,openAddMemberModal:Te,addMemberToTree:we,closeAddMemberModal:b}}const Be={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Ie={class:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-4"},Pe={class:"flex items-center gap-3"},Ee={class:"w-10 h-10 rounded-lg bg-violet-500/10 flex items-center justify-center"},De={class:"text-xl font-bold text-slate-900 dark:text-white"},Oe={class:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-4"},Xe={class:"flex items-center gap-3"},Fe={class:"w-10 h-10 rounded-lg bg-cyan-500/10 flex items-center justify-center"},Ke={class:"text-xl font-bold text-slate-900 dark:text-white"},ze=X({__name:"NetworkStatsCards",props:{stats:{}},setup(t){return(f,u)=>{const w=Q;return a(),r("div",Be,[e("div",Ie,[e("div",Pe,[e("div",Ee,[d(w,{name:"i-heroicons-user-group",class:"w-5 h-5 text-violet-500"})]),e("div",null,[u[0]||(u[0]=e("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"Total Affiliate",-1)),e("p",De,i(t.stats.totalAffiliates),1)])])]),e("div",Oe,[e("div",Xe,[e("div",Fe,[d(w,{name:"i-heroicons-users",class:"w-5 h-5 text-cyan-500"})]),e("div",null,[u[1]||(u[1]=e("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"Customer dengan Referral",-1)),e("p",Ke,i(t.stats.totalCustomersWithReferral),1)])])])])}}}),Ge={class:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 overflow-hidden"},Ve={class:"divide-y divide-slate-200 dark:divide-slate-800 max-h-125 overflow-y-auto"},qe=["onClick"],He={class:"flex items-center justify-between"},We={class:"flex items-center gap-3"},Qe={class:"w-10 h-10 rounded-full bg-violet-500/10 flex items-center justify-center overflow-hidden"},Je=["src","alt"],Ye={class:"font-medium text-slate-900 dark:text-white"},Ze={class:"text-sm text-slate-500 dark:text-slate-400"},et={class:"flex items-center gap-2"},tt={key:0,class:"p-8 text-center"},st=X({__name:"AffiliateList",props:{affiliates:{},selectedAffiliateId:{}},emits:["select","viewTree","setupReferralCodes","addMember"],setup(t){return(f,u)=>{const w=Q,M=le,v=K;return a(),r("div",Ge,[u[1]||(u[1]=e("div",{class:"px-4 py-3 border-b border-slate-200 dark:border-slate-800"},[e("h2",{class:"text-lg font-semibold text-slate-900 dark:text-white"},"Daftar Affiliate"),e("p",{class:"text-sm text-slate-500 dark:text-slate-400"}," Pilih affiliate untuk mengelola tree network ")],-1)),e("div",Ve,[(a(!0),r(j,null,P(t.affiliates,l=>(a(),r("div",{key:l.id,class:_e(["p-4 hover:bg-slate-50 dark:hover:bg-slate-800/50 cursor-pointer transition-colors",{"bg-violet-50 dark:bg-violet-500/10":t.selectedAffiliateId===l.id}]),onClick:C=>f.$emit("select",l)},[e("div",He,[e("div",We,[e("div",Qe,[l.customerAvatar?(a(),r("img",{key:0,src:l.customerAvatar,alt:l.customerName,class:"w-full h-full object-cover"},null,8,Je)):(a(),A(w,{key:1,name:"i-heroicons-user",class:"w-5 h-5 text-violet-500"}))]),e("div",null,[e("p",Ye,i(l.customerName),1),e("p",Ze,i(l.referralCode),1)])]),e("div",et,[d(M,{color:"primary",variant:"subtle",size:"xs"},{default:y(()=>[S(i(l.totalReferrals)+" referral ",1)]),_:2},1024),d(v,{icon:"i-heroicons-user-plus",color:"primary",variant:"ghost",size:"xs",title:"Tambah Member ke Tree",onClick:Ce(C=>f.$emit("addMember",l),["stop"])},null,8,["onClick"]),d(v,{icon:"i-heroicons-sparkles",color:"violet",variant:"ghost",size:"xs",title:"Setup Kode Referral",onClick:Ce(C=>f.$emit("setupReferralCodes",l),["stop"])},null,8,["onClick"]),d(v,{icon:"i-heroicons-eye",color:"neutral",variant:"ghost",size:"xs",title:"Lihat Tree",onClick:Ce(C=>f.$emit("viewTree",l),["stop"])},null,8,["onClick"])])])],10,qe))),128)),t.affiliates.length===0?(a(),r("div",tt,[d(w,{name:"i-heroicons-user-group",class:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-4"}),u[0]||(u[0]=e("p",{class:"text-slate-500 dark:text-slate-400"},"Belum ada affiliate",-1))])):c("v-if",!0)])])}}}),at={class:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 overflow-hidden"},lt={class:"px-4 py-3 border-b border-slate-200 dark:border-slate-800"},ot={class:"flex items-center justify-between"},nt={class:"text-lg font-semibold text-slate-900 dark:text-white"},rt={class:"text-sm text-slate-500 dark:text-slate-400"},it={key:0,class:"flex items-center gap-2"},dt={key:0,class:"p-8 flex items-center justify-center"},ct={class:"p-8 text-center"},ut={class:"divide-y divide-slate-200 dark:divide-slate-800"},mt={key:0,class:"p-4"},ft={class:"flex items-center justify-between mb-3"},vt={class:"flex items-center gap-2"},xt={class:"space-y-2 max-h-62 overflow-y-auto"},ht={class:"flex items-center gap-3"},gt={class:"w-8 h-8 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center overflow-hidden"},pt=["src","alt"],kt={class:"font-medium text-slate-900 dark:text-white text-sm"},bt={class:"text-xs text-slate-500 dark:text-slate-400"},yt={class:"flex items-center gap-2"},wt={class:"text-xs text-slate-500"},Ct={key:1,class:"p-4"},$t={class:"mb-3"},_t={class:"space-y-2 max-h-50 overflow-y-auto"},St={class:"flex items-center gap-3"},Tt={class:"w-8 h-8 rounded-full bg-emerald-200 dark:bg-emerald-700 flex items-center justify-center overflow-hidden"},Mt=["src","alt"],Rt={class:"font-medium text-slate-900 dark:text-white text-sm"},At={class:"flex items-center gap-2"},Lt={class:"text-xs text-slate-500 dark:text-slate-400"},jt={class:"text-xs text-emerald-600 dark:text-emerald-400"},Ut={class:"flex items-center gap-2"},Nt={key:2,class:"p-8 text-center"},Bt=X({__name:"ReferredCustomersList",props:{affiliate:{},referredCustomers:{},isLoading:{type:Boolean},isPlacing:{type:Boolean},selectedCustomers:{}},emits:["placeCustomer","removeFromTree","toggleSelection","selectAll","openPlacementModal"],setup(t,{emit:f}){const u=t,w=f,M=C=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(C),v=C=>new Date(C).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),l=()=>u.referredCustomers?u.selectedCustomers.length===u.referredCustomers.unplacedCustomers.length:!1;return(C,o)=>{const T=le,p=K,s=Q,L=Ae;return a(),r("div",at,[e("div",lt,[e("div",ot,[e("div",null,[e("h2",nt,i(t.affiliate?`Referral ${t.affiliate.customerName}`:"Pilih Affiliate"),1),e("p",rt,i(t.affiliate?`Customers yang menggunakan kode ${t.affiliate.referralCode}`:"Klik affiliate untuk melihat referral"),1)]),t.selectedCustomers.length>0?(a(),r("div",it,[d(T,{color:"primary"},{default:y(()=>[S(i(t.selectedCustomers.length)+" dipilih ",1)]),_:1}),d(p,{icon:"i-heroicons-check-circle",color:"primary",size:"sm",onClick:o[0]||(o[0]=h=>w("openPlacementModal"))},{default:y(()=>[...o[2]||(o[2]=[S(" Tempatkan ",-1)])]),_:1})])):c("v-if",!0)])]),c(" Loading "),t.isLoading?(a(),r("div",dt,[d(s,{name:"i-heroicons-arrow-path",class:"w-8 h-8 text-violet-500 animate-spin"})])):t.affiliate?t.referredCustomers?(a(),r(j,{key:2},[c(" Customer list "),e("div",ut,[c(" Unplaced section "),t.referredCustomers.unplacedCustomers.length>0?(a(),r("div",mt,[e("div",ft,[e("div",vt,[d(T,{color:"warning",variant:"subtle"},{default:y(()=>[S(i(t.referredCustomers.totalUnplaced)+" Belum Ditempatkan ",1)]),_:1})]),d(p,{variant:"ghost",size:"xs",onClick:o[1]||(o[1]=h=>w("selectAll"))},{default:y(()=>[S(i(l()?"Batal Pilih Semua":"Pilih Semua"),1)]),_:1})]),e("div",xt,[(a(!0),r(j,null,P(t.referredCustomers.unplacedCustomers,h=>(a(),r("div",{key:h.id,class:"flex items-center justify-between p-3 bg-amber-50 dark:bg-amber-500/10 rounded-lg"},[e("div",ht,[d(L,{"model-value":t.selectedCustomers.includes(h.id),"onUpdate:modelValue":N=>w("toggleSelection",h.id)},null,8,["model-value","onUpdate:modelValue"]),e("div",gt,[h.avatar?(a(),r("img",{key:0,src:h.avatar,alt:h.fullName,class:"w-full h-full object-cover"},null,8,pt)):(a(),A(s,{key:1,name:"i-heroicons-user",class:"w-4 h-4 text-slate-500"}))]),e("div",null,[e("p",kt,i(h.fullName),1),e("p",bt,i(h.email),1)])]),e("div",yt,[e("p",wt,i(v(h.createdAt)),1),d(p,{icon:"i-heroicons-plus",color:"primary",size:"xs",loading:t.isPlacing,onClick:N=>w("placeCustomer",h.id,1)},{default:y(()=>[...o[4]||(o[4]=[S(" Level 1 ",-1)])]),_:1},8,["loading","onClick"])])]))),128))])])):c("v-if",!0),c(" Placed section "),t.referredCustomers.placedCustomers.length>0?(a(),r("div",Ct,[e("div",$t,[d(T,{color:"success",variant:"subtle"},{default:y(()=>[S(i(t.referredCustomers.totalPlaced)+" Sudah Ditempatkan ",1)]),_:1})]),e("div",_t,[(a(!0),r(j,null,P(t.referredCustomers.placedCustomers,h=>(a(),r("div",{key:h.id,class:"flex items-center justify-between p-3 bg-emerald-50 dark:bg-emerald-500/10 rounded-lg"},[e("div",St,[e("div",Tt,[h.avatar?(a(),r("img",{key:0,src:h.avatar,alt:h.fullName,class:"w-full h-full object-cover"},null,8,Mt)):(a(),A(s,{key:1,name:"i-heroicons-user",class:"w-4 h-4 text-emerald-700 dark:text-emerald-300"}))]),e("div",null,[e("p",Rt,i(h.fullName),1),e("div",At,[d(T,{color:"primary",variant:"subtle",size:"xs"},{default:y(()=>[S("Level "+i(h.level),1)]),_:2},1024),e("p",Lt,i(h.totalOrdersCount)+" order ",1),e("p",jt,i(M(h.totalSpent)),1)])])]),e("div",Ut,[d(s,{name:"i-heroicons-check-circle",class:"w-5 h-5 text-emerald-500"}),h.referralId?(a(),A(p,{key:0,icon:"i-heroicons-trash",color:"error",variant:"ghost",size:"xs",onClick:N=>w("removeFromTree",h.referralId)},null,8,["onClick"])):c("v-if",!0)])]))),128))])])):c("v-if",!0),c(" Empty state "),t.referredCustomers.totalReferred===0?(a(),r("div",Nt,[d(s,{name:"i-heroicons-user-plus",class:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-4"}),o[5]||(o[5]=e("p",{class:"text-slate-500 dark:text-slate-400"}," Belum ada customer yang menggunakan kode referral ini ",-1))])):c("v-if",!0)])],2112)):c("v-if",!0):(a(),r(j,{key:1},[c(" No affiliate selected "),e("div",ct,[d(s,{name:"i-heroicons-cursor-arrow-rays",class:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-4"}),o[3]||(o[3]=e("p",{class:"text-slate-500 dark:text-slate-400"},"Pilih affiliate dari daftar di samping",-1))])],2112))])}}}),It={class:"p-6"},Pt={class:"text-lg font-semibold text-slate-900 dark:text-white mb-4"},Et={class:"space-y-4"},Dt={class:"flex gap-2"},Ot={class:"bg-slate-50 dark:bg-slate-800 rounded-lg p-4"},Xt={class:"text-sm text-slate-600 dark:text-slate-400"},Ft={class:"flex justify-end gap-3 mt-6"},Kt=X({__name:"PlacementModal",props:{open:{type:Boolean},affiliate:{},selectedCount:{},placementLevel:{},isPlacing:{type:Boolean}},emits:["update:open","update:placementLevel","confirm"],setup(t,{emit:f}){const u=f,w=M=>{M||setTimeout(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()},0),u("update:open",M)};return(M,v)=>{const l=K,C=oe;return a(),A(C,{open:t.open,title:"Tempatkan Customer",description:"Pilih level untuk menempatkan customer ke tree network","onUpdate:open":w},{content:y(()=>[e("div",It,[e("h3",Pt," Tempatkan "+i(t.selectedCount)+" Customer ",1),e("div",Et,[e("div",null,[v[2]||(v[2]=e("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"}," Pilih Level ",-1)),e("div",Dt,[(a(),r(j,null,P([1,2,3],o=>d(l,{key:o,color:t.placementLevel===o?"primary":"neutral",variant:t.placementLevel===o?"solid":"outline",onClick:T=>u("update:placementLevel",o)},{default:y(()=>[S(" Level "+i(o),1)]),_:2},1032,["color","variant","onClick"])),64))]),v[3]||(v[3]=e("p",{class:"mt-2 text-xs text-slate-500 dark:text-slate-400"}," Level 1: 5% komisi | Level 2: 2% komisi | Level 3: 1% komisi ",-1))]),e("div",Ot,[e("p",Xt,[e("strong",null,i(t.selectedCount),1),v[4]||(v[4]=S(" customer akan ditempatkan di ",-1)),e("strong",null,"Level "+i(t.placementLevel),1),v[5]||(v[5]=S(" pada tree network ",-1)),e("strong",null,i(t.affiliate?.customerName),1)])])]),e("div",Ft,[d(l,{color:"neutral",variant:"outline",onClick:v[0]||(v[0]=o=>w(!1))},{default:y(()=>[...v[6]||(v[6]=[S(" Batal ",-1)])]),_:1}),d(l,{color:"primary",loading:t.isPlacing,onClick:v[1]||(v[1]=o=>u("confirm"))},{default:y(()=>[...v[7]||(v[7]=[S(" Tempatkan Sekarang ",-1)])]),_:1},8,["loading"])])])]),_:1},8,["open"])}}}),zt={class:"p-6"},Gt={class:"space-y-4"},Vt={key:0,class:"flex justify-center py-4"},qt={key:1,class:"space-y-2 max-h-50 overflow-y-auto"},Ht=["onClick"],Wt={class:"flex items-center gap-3"},Qt={class:"w-8 h-8 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center overflow-hidden"},Jt=["src","alt"],Yt={class:"font-medium text-slate-900 dark:text-white text-sm"},Zt={class:"text-xs text-slate-500 dark:text-slate-400"},es={key:2,class:"py-4 text-center text-slate-500 dark:text-slate-400"},ts={class:"flex justify-end gap-3 mt-6"},ss=X({__name:"CreateAffiliateModal",props:{open:{type:Boolean},searchQuery:{},customers:{},selectedCustomerId:{},isSearching:{type:Boolean},isCreating:{type:Boolean}},emits:["update:open","update:searchQuery","update:selectedCustomerId","confirm","close"],setup(t,{emit:f}){const u=f,w=()=>{setTimeout(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()},0),u("close")},M=v=>{v||setTimeout(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()},0),u("update:open",v)};return(v,l)=>{const C=Se,o=Q,T=K,p=oe;return a(),A(p,{open:t.open,title:"Buat Akun Affiliate",description:"Cari dan pilih customer untuk membuat akun affiliate baru","onUpdate:open":M},{content:y(()=>[e("div",zt,[l[5]||(l[5]=e("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white mb-4"}," Buat Akun Affiliate Baru ",-1)),e("div",Gt,[e("div",null,[l[2]||(l[2]=e("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"}," Cari Customer ",-1)),d(C,{"model-value":t.searchQuery,placeholder:"Ketik nama atau email customer...",icon:"i-heroicons-magnifying-glass",class:"w-full","onUpdate:modelValue":l[0]||(l[0]=s=>u("update:searchQuery",s))},null,8,["model-value"])]),t.isSearching?(a(),r("div",Vt,[d(o,{name:"i-heroicons-arrow-path",class:"w-6 h-6 text-violet-500 animate-spin"})])):t.customers.length>0?(a(),r("div",qt,[(a(!0),r(j,null,P(t.customers,s=>(a(),r("div",{key:s.id,class:_e(["flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors",t.selectedCustomerId===s.id?"bg-violet-100 dark:bg-violet-500/20":"bg-slate-50 dark:bg-slate-800 hover:bg-slate-100 dark:hover:bg-slate-700"]),onClick:L=>u("update:selectedCustomerId",s.id)},[e("div",Wt,[e("div",Qt,[s.avatar?(a(),r("img",{key:0,src:s.avatar,alt:s.fullName,class:"w-full h-full object-cover"},null,8,Jt)):(a(),A(o,{key:1,name:"i-heroicons-user",class:"w-4 h-4 text-slate-500"}))]),e("div",null,[e("p",Yt,i(s.fullName),1),e("p",Zt,i(s.email),1)])]),t.selectedCustomerId===s.id?(a(),A(o,{key:0,name:"i-heroicons-check-circle",class:"w-5 h-5 text-violet-500"})):c("v-if",!0)],10,Ht))),128))])):t.searchQuery.length>=2?(a(),r("div",es," Tidak ada customer ditemukan ")):c("v-if",!0)]),e("div",ts,[d(T,{color:"neutral",variant:"outline",onClick:w},{default:y(()=>[...l[3]||(l[3]=[S(" Batal ",-1)])]),_:1}),d(T,{color:"primary",loading:t.isCreating,disabled:!t.selectedCustomerId,onClick:l[1]||(l[1]=s=>u("confirm"))},{default:y(()=>[...l[4]||(l[4]=[S(" Buat Affiliate ",-1)])]),_:1},8,["loading","disabled"])])])]),_:1},8,["open"])}}}),as={class:"p-6"},ls={class:"flex items-center justify-between mb-4"},os={class:"text-lg font-semibold text-slate-900 dark:text-white"},ns={class:"text-sm text-slate-500 dark:text-slate-400"},rs={key:0,class:"flex justify-center py-12"},is={key:1,class:"space-y-4"},ds={class:"grid grid-cols-3 gap-4"},cs={class:"bg-cyan-50 dark:bg-cyan-500/10 rounded-lg p-3 text-center"},us={class:"text-2xl font-bold text-cyan-600 dark:text-cyan-400"},ms={class:"bg-purple-50 dark:bg-purple-500/10 rounded-lg p-3 text-center"},fs={class:"text-2xl font-bold text-purple-600 dark:text-purple-400"},vs={class:"bg-amber-50 dark:bg-amber-500/10 rounded-lg p-3 text-center"},xs={class:"text-2xl font-bold text-amber-600 dark:text-amber-400"},hs={key:0,class:"bg-slate-50 dark:bg-slate-800 rounded-lg p-4"},gs={class:"space-y-4"},ps={class:"flex justify-center"},ks={class:"flex flex-col items-center"},bs={class:"w-16 h-16 rounded-full bg-linear-to-br from-violet-500 to-purple-600 flex items-center justify-center text-white font-bold text-xl shadow-lg"},ys={class:"mt-2 text-sm font-medium text-slate-900 dark:text-white"},ws={key:0},Cs={class:"flex justify-center gap-4 flex-wrap"},$s={class:"mt-1 text-xs font-medium text-slate-900 dark:text-white"},_s={key:1},Ss={class:"flex justify-center gap-3 flex-wrap"},Ts={class:"mt-1 text-xs text-slate-700 dark:text-slate-300"},Ms={key:2},Rs={class:"flex justify-center gap-2 flex-wrap"},As={class:"mt-1 text-xs text-slate-600 dark:text-slate-400"},Ls={key:1,class:"bg-slate-50 dark:bg-slate-800 rounded-lg p-8 text-center"},js={class:"flex items-center justify-between bg-emerald-50 dark:bg-emerald-500/10 rounded-lg p-4"},Us={class:"text-lg font-bold text-emerald-600 dark:text-emerald-400"},Ns=X({__name:"NetworkTreeModal",props:{open:{type:Boolean},affiliate:{},networkTree:{},networkStats:{},isLoading:{type:Boolean}},emits:["update:open"],setup(t,{emit:f}){const u=f,w=v=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(v),M=v=>{v||setTimeout(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()},0),u("update:open",v)};return(v,l)=>{const C=K,o=Q,T=le,p=oe;return a(),A(p,{open:t.open,ui:{width:"max-w-4xl"},title:"Network Tree",description:"Visualisasi struktur tree network MLM","onUpdate:open":M},{content:y(()=>[e("div",as,[e("div",ls,[e("div",null,[e("h3",os," Network Tree: "+i(t.affiliate?.customerName),1),e("p",ns," Kode: "+i(t.affiliate?.referralCode),1)]),d(C,{icon:"i-heroicons-x-mark",color:"neutral",variant:"ghost",onClick:l[0]||(l[0]=s=>M(!1))})]),t.isLoading?(a(),r("div",rs,[d(o,{name:"i-heroicons-arrow-path",class:"w-8 h-8 text-violet-500 animate-spin"})])):t.networkStats?(a(),r("div",is,[c(" Stats "),e("div",ds,[e("div",cs,[e("p",us,i(t.networkStats.level1Count),1),l[1]||(l[1]=e("p",{class:"text-xs text-slate-600 dark:text-slate-400"},"Level 1",-1))]),e("div",ms,[e("p",fs,i(t.networkStats.level2Count),1),l[2]||(l[2]=e("p",{class:"text-xs text-slate-600 dark:text-slate-400"},"Level 2",-1))]),e("div",vs,[e("p",xs,i(t.networkStats.level3Count),1),l[3]||(l[3]=e("p",{class:"text-xs text-slate-600 dark:text-slate-400"},"Level 3",-1))])]),c(" Tree visualization "),t.networkTree&&t.networkTree.nodes.length>0?(a(),r("div",hs,[e("div",gs,[c(" Root node "),e("div",ps,[e("div",ks,[e("div",bs,i(t.affiliate?.customerName?.charAt(0)||"Y"),1),e("p",ys,i(t.affiliate?.customerName),1),l[4]||(l[4]=e("p",{class:"text-xs text-slate-500"},"Root",-1))])]),c(" Level 1 "),t.networkTree.nodes.filter(s=>s.level===1).length>0?(a(),r("div",ws,[l[5]||(l[5]=e("div",{class:"h-8 flex justify-center"},[e("div",{class:"w-px bg-slate-300 dark:bg-slate-600"})],-1)),e("div",Cs,[(a(!0),r(j,null,P(t.networkTree.nodes.filter(s=>s.level===1),s=>(a(),r("div",{key:s.key,class:"flex flex-col items-center"},[e("div",{class:"w-12 h-12 rounded-full flex items-center justify-center text-white font-bold shadow-md",style:$e({background:`linear-gradient(135deg, ${s.gradientStart}, ${s.gradientEnd})`})},i(s.text),5),e("p",$s,i(s.customerName),1),d(T,{color:s.status==="active"?"success":"neutral",variant:"subtle",size:"xs"},{default:y(()=>[S(i(s.status),1)]),_:2},1032,["color"])]))),128))])])):c("v-if",!0),c(" Level 2 "),t.networkTree.nodes.filter(s=>s.level===2).length>0?(a(),r("div",_s,[l[6]||(l[6]=e("div",{class:"h-8 flex justify-center"},[e("div",{class:"w-px bg-slate-300 dark:bg-slate-600"})],-1)),e("div",Ss,[(a(!0),r(j,null,P(t.networkTree.nodes.filter(s=>s.level===2),s=>(a(),r("div",{key:s.key,class:"flex flex-col items-center"},[e("div",{class:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-sm shadow-md",style:$e({background:`linear-gradient(135deg, ${s.gradientStart}, ${s.gradientEnd})`})},i(s.text),5),e("p",Ts,i(s.customerName),1)]))),128))])])):c("v-if",!0),c(" Level 3 "),t.networkTree.nodes.filter(s=>s.level===3).length>0?(a(),r("div",Ms,[l[7]||(l[7]=e("div",{class:"h-8 flex justify-center"},[e("div",{class:"w-px bg-slate-300 dark:bg-slate-600"})],-1)),e("div",Rs,[(a(!0),r(j,null,P(t.networkTree.nodes.filter(s=>s.level===3),s=>(a(),r("div",{key:s.key,class:"flex flex-col items-center"},[e("div",{class:"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold text-xs shadow-md",style:$e({background:`linear-gradient(135deg, ${s.gradientStart}, ${s.gradientEnd})`})},i(s.text),5),e("p",As,i(s.customerName),1)]))),128))])])):c("v-if",!0)])])):(a(),r("div",Ls,[d(o,{name:"i-heroicons-user-group",class:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-4"}),l[8]||(l[8]=e("p",{class:"text-slate-500 dark:text-slate-400"},"Belum ada member di tree ini",-1))])),c(" Total value "),e("div",js,[l[9]||(l[9]=e("span",{class:"text-sm text-slate-600 dark:text-slate-400"},"Total Nilai Network",-1)),e("span",Us,i(w(t.networkStats.totalNetworkValue)),1)])])):c("v-if",!0)])]),_:1},8,["open"])}}}),Bs={key:0,class:"py-12 flex items-center justify-center"},Is={key:1,class:"space-y-6"},Ps={class:"grid grid-cols-3 gap-4"},Es={class:"bg-slate-100 dark:bg-slate-800 rounded-lg p-4 text-center"},Ds={class:"text-2xl font-bold text-slate-900 dark:text-white"},Os={class:"bg-emerald-100 dark:bg-emerald-500/20 rounded-lg p-4 text-center"},Xs={class:"text-2xl font-bold text-emerald-600 dark:text-emerald-400"},Fs={class:"bg-amber-100 dark:bg-amber-500/20 rounded-lg p-4 text-center"},Ks={class:"text-2xl font-bold text-amber-600 dark:text-amber-400"},zs={key:0},Gs={class:"flex items-center justify-between mb-3"},Vs={class:"flex items-center gap-2"},qs={class:"space-y-2 max-h-64 overflow-y-auto"},Hs={class:"flex items-center gap-3"},Ws={class:"w-10 h-10 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center overflow-hidden"},Qs=["src","alt"],Js={class:"font-medium text-slate-900 dark:text-white"},Ys={class:"text-sm text-slate-500 dark:text-slate-400"},Zs={class:"flex items-center gap-2 text-xs text-slate-500 dark:text-slate-400"},ea={key:0},ta={key:1},sa={class:"flex items-center gap-2"},aa={key:1},la={class:"space-y-2 max-h-64 overflow-y-auto"},oa={class:"flex items-center gap-3"},na={class:"w-10 h-10 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center overflow-hidden"},ra=["src","alt"],ia={class:"font-medium text-slate-900 dark:text-white"},da={class:"text-sm text-slate-500 dark:text-slate-400"},ca={class:"flex items-center gap-3"},ua={class:"text-right"},ma={class:"flex items-center gap-2"},fa={class:"text-xs text-slate-500 dark:text-slate-400 mt-1"},va={key:2,class:"py-8 text-center text-slate-500 dark:text-slate-400"},xa={class:"flex justify-end gap-3"},ha=X({__name:"SetupReferralCodeModal",props:{open:{type:Boolean},affiliate:{},affiliatedCustomersData:{},selectedCustomers:{},customReferralCode:{},isLoading:{type:Boolean},isSettingUp:{type:Boolean}},emits:["update:open","update:customReferralCode","setupReferralCode","bulkSetupReferralCodes","toggleSelection","selectAll","close"],setup(t,{emit:f}){const u=t,w=f,M=p=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(p),v=()=>u.affiliatedCustomersData?u.selectedCustomers.length===u.affiliatedCustomersData.withoutReferralCode.length&&u.selectedCustomers.length>0:!1,l=$({}),C=p=>{const s=l.value[p];w("setupReferralCode",p,s||void 0),l.value[p]=""},o=()=>{setTimeout(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()},0),w("close")},T=p=>{p||setTimeout(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()},0),w("update:open",p)};return(p,s)=>{const L=Q,h=K,N=Ae,k=le,D=Se,E=oe;return a(),A(E,{open:t.open,title:"Setup Kode Referral",description:"Buat kode referral untuk customer yang terafiliasi",ui:{width:"max-w-4xl"},"onUpdate:open":T},{body:y(()=>[t.isLoading?(a(),r("div",Bs,[d(L,{name:"i-heroicons-arrow-path",class:"w-8 h-8 text-violet-500 animate-spin"})])):t.affiliatedCustomersData?(a(),r("div",Is,[c(" Stats "),e("div",Ps,[e("div",Es,[e("div",Ds,i(t.affiliatedCustomersData.stats.total),1),s[2]||(s[2]=e("div",{class:"text-sm text-slate-500 dark:text-slate-400"},"Total Member",-1))]),e("div",Os,[e("div",Xs,i(t.affiliatedCustomersData.stats.withCode),1),s[3]||(s[3]=e("div",{class:"text-sm text-slate-500 dark:text-slate-400"},"Sudah Punya Kode",-1))]),e("div",Fs,[e("div",Ks,i(t.affiliatedCustomersData.stats.withoutCode),1),s[4]||(s[4]=e("div",{class:"text-sm text-slate-500 dark:text-slate-400"},"Belum Punya Kode",-1))])]),c(" Customers without referral code "),t.affiliatedCustomersData.withoutReferralCode.length>0?(a(),r("div",zs,[e("div",Gs,[s[5]||(s[5]=e("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white"}," Customer Belum Punya Kode Referral ",-1)),e("div",Vs,[d(h,{variant:"ghost",size:"xs",onClick:s[0]||(s[0]=x=>w("selectAll"))},{default:y(()=>[S(i(v()?"Batal Pilih Semua":"Pilih Semua"),1)]),_:1}),t.selectedCustomers.length>0?(a(),A(h,{key:0,color:"primary",size:"sm",loading:t.isSettingUp,onClick:s[1]||(s[1]=x=>w("bulkSetupReferralCodes"))},{default:y(()=>[d(L,{name:"i-heroicons-sparkles",class:"w-4 h-4 mr-1"}),S(" Generate "+i(t.selectedCustomers.length)+" Kode ",1)]),_:1},8,["loading"])):c("v-if",!0)])]),e("div",qs,[(a(!0),r(j,null,P(t.affiliatedCustomersData.withoutReferralCode,x=>(a(),r("div",{key:x.id,class:"flex items-center justify-between p-3 bg-amber-50 dark:bg-amber-500/10 rounded-lg"},[e("div",Hs,[d(N,{"model-value":t.selectedCustomers.includes(x.id),"onUpdate:modelValue":B=>w("toggleSelection",x.id)},null,8,["model-value","onUpdate:modelValue"]),e("div",Ws,[x.avatar?(a(),r("img",{key:0,src:x.avatar,alt:x.fullName,class:"w-full h-full object-cover"},null,8,Qs)):(a(),A(L,{key:1,name:"i-heroicons-user",class:"w-5 h-5 text-slate-500"}))]),e("div",null,[e("div",Js,i(x.fullName),1),e("div",Ys,i(x.email),1),e("div",Zs,[d(k,{color:"violet",variant:"subtle",size:"xs"},{default:y(()=>[S(" Level "+i(x.level||"-"),1)]),_:2},1024),x.totalOrdersCount?(a(),r("span",ea,i(x.totalOrdersCount)+" orders",1)):c("v-if",!0),x.totalSpent?(a(),r("span",ta,i(M(x.totalSpent)),1)):c("v-if",!0)])])]),e("div",sa,[d(D,{modelValue:l.value[x.id],"onUpdate:modelValue":B=>l.value[x.id]=B,placeholder:"Kode custom (opsional)",size:"sm",class:"w-40"},null,8,["modelValue","onUpdate:modelValue"]),d(h,{icon:"i-heroicons-sparkles",color:"primary",size:"sm",loading:t.isSettingUp,onClick:B=>C(x.id)},{default:y(()=>[...s[6]||(s[6]=[S(" Generate ",-1)])]),_:1},8,["loading","onClick"])])]))),128))])])):c("v-if",!0),c(" Customers with referral code "),t.affiliatedCustomersData.withReferralCode.length>0?(a(),r("div",aa,[s[7]||(s[7]=e("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white mb-3"}," Customer Sudah Punya Kode Referral ",-1)),e("div",la,[(a(!0),r(j,null,P(t.affiliatedCustomersData.withReferralCode,x=>(a(),r("div",{key:x.id,class:"flex items-center justify-between p-3 bg-emerald-50 dark:bg-emerald-500/10 rounded-lg"},[e("div",oa,[e("div",na,[x.avatar?(a(),r("img",{key:0,src:x.avatar,alt:x.fullName,class:"w-full h-full object-cover"},null,8,ra)):(a(),A(L,{key:1,name:"i-heroicons-user",class:"w-5 h-5 text-slate-500"}))]),e("div",null,[e("div",ia,i(x.fullName),1),e("div",da,i(x.email),1)])]),e("div",ca,[e("div",ua,[e("div",ma,[d(k,{color:"emerald",variant:"soft",size:"sm"},{default:y(()=>[S(i(x.referralCode),1)]),_:2},1024),d(k,{color:"violet",variant:"subtle",size:"xs"},{default:y(()=>[S(" Level "+i(x.level),1)]),_:2},1024)]),e("div",fa,i(x.totalReferrals)+" referral â€¢ "+i(M(x.totalEarnings))+" earnings ",1)]),d(k,{color:x.isActive?"emerald":"gray",variant:"subtle",size:"xs"},{default:y(()=>[S(i(x.isActive?"Aktif":"Nonaktif"),1)]),_:2},1032,["color"])])]))),128))])])):c("v-if",!0),c(" Empty state "),t.affiliatedCustomersData.customers.length===0?(a(),r("div",va,[d(L,{name:"i-heroicons-users",class:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-4"}),s[8]||(s[8]=e("p",null,"Belum ada member terafiliasi di tree ini",-1))])):c("v-if",!0)])):c("v-if",!0)]),footer:y(()=>[e("div",xa,[d(h,{color:"gray",variant:"ghost",onClick:o},{default:y(()=>[...s[9]||(s[9]=[S(" Tutup ",-1)])]),_:1})])]),_:1},8,["open"])}}}),ga={key:0,class:"py-8 text-center"},pa={key:1,class:"space-y-4"},ka={key:0,class:"flex justify-center py-8"},ba={class:"space-y-2 max-h-80 overflow-y-auto"},ya=["onClick"],wa={class:"flex items-center gap-3"},Ca={class:"w-10 h-10 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center overflow-hidden"},$a=["src","alt"],_a={class:"font-medium text-slate-900 dark:text-white"},Sa={class:"text-sm text-slate-500 dark:text-slate-400"},Ta={class:"flex items-center gap-2 mt-1"},Ma={class:"text-xs text-slate-500"},Ra={class:"text-xs text-emerald-600"},Aa={class:"flex items-center gap-2"},La={class:"py-8 text-center text-slate-500 dark:text-slate-400"},ja={class:"py-8 text-center text-slate-500 dark:text-slate-400"},Ua={class:"flex justify-end gap-3"},Na=X({__name:"AddMemberToTreeModal",props:{open:{type:Boolean},affiliate:{},searchQuery:{},customers:{},selectedCustomerId:{},selectedLevel:{},isSearching:{type:Boolean},isAdding:{type:Boolean}},emits:["update:open","update:searchQuery","update:selectedCustomerId","update:selectedLevel","confirm","close"],setup(t,{emit:f}){const u=f,w=C=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(C),M=[{label:"Level 1 (Langsung)",value:1},{label:"Level 2",value:2},{label:"Level 3",value:3}],v=()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur(),u("close")},l=C=>{C||setTimeout(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()},0),u("update:open",C)};return(C,o)=>{const T=Q,p=Se,s=Ue,L=le,h=K,N=oe;return a(),A(N,{open:t.open,title:"Tambah Member ke Tree",description:t.affiliate?`Tambahkan customer ke tree network ${t.affiliate.customerName}`:"Pilih affiliate terlebih dahulu",ui:{width:"max-w-2xl"},"onUpdate:open":l},{body:y(()=>[t.affiliate?(a(),r("div",pa,[c(" Search Input "),e("div",null,[o[4]||(o[4]=e("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"}," Cari Customer ",-1)),d(p,{"model-value":t.searchQuery,placeholder:"Ketik nama, email, atau nomor telepon...",icon:"i-heroicons-magnifying-glass",class:"w-full","onUpdate:modelValue":o[0]||(o[0]=k=>u("update:searchQuery",k))},null,8,["model-value"]),o[5]||(o[5]=e("p",{class:"text-xs text-slate-500 mt-1"},"Minimal 2 karakter untuk memulai pencarian",-1))]),c(" Level Selection "),e("div",null,[o[6]||(o[6]=e("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"}," Pilih Level ",-1)),d(s,{"model-value":t.selectedLevel,items:M,placeholder:"Pilih level",class:"w-full","onUpdate:modelValue":o[1]||(o[1]=k=>u("update:selectedLevel",k))},null,8,["model-value"])]),c(" Loading State "),t.isSearching?(a(),r("div",ka,[d(T,{name:"i-heroicons-arrow-path",class:"w-8 h-8 text-violet-500 animate-spin"})])):t.customers.length>0?(a(),r(j,{key:1},[c(" Customer Results "),e("div",ba,[(a(!0),r(j,null,P(t.customers,k=>(a(),r("div",{key:k.id,class:_e(["flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors",[t.selectedCustomerId===k.id?"bg-violet-100 dark:bg-violet-500/20 border-2 border-violet-500":k.isInTree?"bg-slate-100 dark:bg-slate-800 opacity-60 cursor-not-allowed":"bg-slate-50 dark:bg-slate-800 hover:bg-slate-100 dark:hover:bg-slate-700 border-2 border-transparent"]]),onClick:D=>!k.isInTree&&u("update:selectedCustomerId",k.id)},[e("div",wa,[e("div",Ca,[k.avatar?(a(),r("img",{key:0,src:k.avatar,alt:k.fullName,class:"w-full h-full object-cover"},null,8,$a)):(a(),A(T,{key:1,name:"i-heroicons-user",class:"w-5 h-5 text-slate-500"}))]),e("div",null,[e("p",_a,i(k.fullName),1),e("p",Sa,i(k.email),1),e("div",Ta,[e("span",Ma,i(k.totalOrdersCount)+" orders",1),e("span",Ra,i(w(k.totalSpent)),1)])])]),e("div",Aa,[k.isInTree?(a(),A(L,{key:0,color:"gray",variant:"subtle",size:"xs"},{default:y(()=>[...o[7]||(o[7]=[S(" Sudah di Tree ",-1)])]),_:1})):k.hasAffiliate?(a(),A(L,{key:1,color:"violet",variant:"subtle",size:"xs"},{default:y(()=>[...o[8]||(o[8]=[S(" Punya Kode Referral ",-1)])]),_:1})):c("v-if",!0),t.selectedCustomerId===k.id?(a(),A(T,{key:2,name:"i-heroicons-check-circle-solid",class:"w-6 h-6 text-violet-500"})):c("v-if",!0)])],10,ya))),128))])],2112)):t.searchQuery.length>=2?(a(),r(j,{key:2},[c(" Empty State "),e("div",La,[d(T,{name:"i-heroicons-user-group",class:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-4"}),o[9]||(o[9]=e("p",null,"Tidak ada customer ditemukan",-1))])],2112)):(a(),r(j,{key:3},[c(" Initial State "),e("div",ja,[d(T,{name:"i-heroicons-magnifying-glass",class:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-4"}),o[10]||(o[10]=e("p",null,"Ketik untuk mencari customer",-1))])],2112))])):(a(),r("div",ga,[d(T,{name:"i-heroicons-exclamation-triangle",class:"w-12 h-12 text-amber-500 mx-auto mb-4"}),o[3]||(o[3]=e("p",{class:"text-slate-500 dark:text-slate-400"},"Pilih affiliate terlebih dahulu dari daftar",-1))]))]),footer:y(()=>[e("div",Ua,[d(h,{color:"neutral",variant:"ghost",onClick:v},{default:y(()=>[...o[11]||(o[11]=[S(" Batal ",-1)])]),_:1}),d(h,{color:"primary",loading:t.isAdding,disabled:!t.selectedCustomerId||!t.affiliate,onClick:o[2]||(o[2]=k=>u("confirm"))},{default:y(()=>[d(T,{name:"i-heroicons-user-plus",class:"w-4 h-4 mr-1"}),o[12]||(o[12]=S(" Tambah ke Tree ",-1))]),_:1},8,["loading","disabled"])])]),_:1},8,["open","description"])}}}),Ba={class:"space-y-6"},Ia={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Pa={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Qa=X({layout:je,__name:"index",props:{affiliates:{default:()=>[]},stats:{default:()=>({totalAffiliates:0,totalCustomersWithReferral:0})}},setup(t){const f=t,{selectedAffiliate:u,referredCustomers:w,networkTree:M,networkStats:v,selectedCustomers:l,placementLevel:C,newAffiliateSearch:o,newAffiliateCustomers:T,selectedNewCustomer:p,affiliatedCustomersData:s,selectedCustomersForReferral:L,customReferralCode:h,showAddMemberModal:N,addMemberSearch:k,addMemberCustomers:D,selectedAddMemberCustomer:E,selectedAddMemberLevel:x,isSearchingAddMember:B,isAddingMember:re,isLoading:Y,isLoadingTree:z,isPlacing:U,isSearchingCustomers:Z,isCreatingAffiliate:ee,isLoadingAffiliatedCustomers:G,isSettingUpReferralCode:J,showPlacementModal:O,showCreateAffiliateModal:F,showTreeModal:V,showSetupReferralModal:q,loadReferredCustomers:H,loadNetworkTree:ie,placeCustomer:de,bulkPlaceCustomers:ce,removeFromTree:ue,createAffiliate:me,toggleCustomerSelection:fe,selectAllUnplaced:ve,closeCreateAffiliateModal:xe,loadAffiliatedCustomers:ne,setupReferralCode:te,bulkSetupReferralCodes:he,toggleReferralCustomerSelection:ge,selectAllWithoutReferralCode:pe,closeSetupReferralModal:ke,openAddMemberModal:be,addMemberToTree:ye,closeAddMemberModal:we}=Ne();return(Te,b)=>{const se=K;return a(),r("div",Ba,[c(" Page Header "),e("div",Ia,[b[15]||(b[15]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Setup Tree Network MLM"),e("p",{class:"text-gray-500 dark:text-gray-400"}," Kelola dan tempatkan member ke dalam tree network MLM ")],-1)),d(se,{icon:"i-heroicons-plus",color:"primary",onClick:b[0]||(b[0]=_=>F.value=!0)},{default:y(()=>[...b[14]||(b[14]=[S(" Buat Akun Affiliate Baru ",-1)])]),_:1})]),c(" Stats "),d(n(ze),{stats:f.stats},null,8,["stats"]),c(" Main Content Grid "),e("div",Pa,[c(" Affiliate List "),d(n(st),{affiliates:f.affiliates,"selected-affiliate-id":n(u)?.id,onSelect:n(H),onViewTree:n(ie),onSetupReferralCodes:n(ne),onAddMember:n(be)},null,8,["affiliates","selected-affiliate-id","onSelect","onViewTree","onSetupReferralCodes","onAddMember"]),c(" Referred Customers "),d(n(Bt),{affiliate:n(u),"referred-customers":n(w),"is-loading":n(Y),"is-placing":n(U),"selected-customers":n(l),onPlaceCustomer:n(de),onRemoveFromTree:n(ue),onToggleSelection:n(fe),onSelectAll:n(ve),onOpenPlacementModal:b[1]||(b[1]=_=>O.value=!0)},null,8,["affiliate","referred-customers","is-loading","is-placing","selected-customers","onPlaceCustomer","onRemoveFromTree","onToggleSelection","onSelectAll"])]),c(" Bulk Placement Modal "),d(n(Kt),{open:n(O),"onUpdate:open":b[2]||(b[2]=_=>I(O)?O.value=_:null),"placement-level":n(C),"onUpdate:placementLevel":b[3]||(b[3]=_=>I(C)?C.value=_:null),affiliate:n(u),"selected-count":n(l).length,"is-placing":n(U),onConfirm:n(ce)},null,8,["open","placement-level","affiliate","selected-count","is-placing","onConfirm"]),c(" Create Affiliate Modal "),d(n(ss),{open:n(F),"onUpdate:open":b[4]||(b[4]=_=>I(F)?F.value=_:null),"search-query":n(o),"onUpdate:searchQuery":b[5]||(b[5]=_=>I(o)?o.value=_:null),"selected-customer-id":n(p),"onUpdate:selectedCustomerId":b[6]||(b[6]=_=>I(p)?p.value=_:null),customers:n(T),"is-searching":n(Z),"is-creating":n(ee),onConfirm:n(me),onClose:n(xe)},null,8,["open","search-query","selected-customer-id","customers","is-searching","is-creating","onConfirm","onClose"]),c(" Network Tree Modal "),d(n(Ns),{open:n(V),"onUpdate:open":b[7]||(b[7]=_=>I(V)?V.value=_:null),affiliate:n(u),"network-tree":n(M),"network-stats":n(v),"is-loading":n(z)},null,8,["open","affiliate","network-tree","network-stats","is-loading"]),c(" Setup Referral Code Modal "),d(n(ha),{open:n(q),"onUpdate:open":b[8]||(b[8]=_=>I(q)?q.value=_:null),"custom-referral-code":n(h),"onUpdate:customReferralCode":b[9]||(b[9]=_=>I(h)?h.value=_:null),affiliate:n(u),"affiliated-customers-data":n(s),"selected-customers":n(L),"is-loading":n(G),"is-setting-up":n(J),onSetupReferralCode:n(te),onBulkSetupReferralCodes:n(he),onToggleSelection:n(ge),onSelectAll:n(pe),onClose:n(ke)},null,8,["open","custom-referral-code","affiliate","affiliated-customers-data","selected-customers","is-loading","is-setting-up","onSetupReferralCode","onBulkSetupReferralCodes","onToggleSelection","onSelectAll","onClose"]),c(" Add Member to Tree Modal "),d(n(Na),{open:n(N),"onUpdate:open":b[10]||(b[10]=_=>I(N)?N.value=_:null),"search-query":n(k),"onUpdate:searchQuery":b[11]||(b[11]=_=>I(k)?k.value=_:null),"selected-customer-id":n(E),"onUpdate:selectedCustomerId":b[12]||(b[12]=_=>I(E)?E.value=_:null),"selected-level":n(x),"onUpdate:selectedLevel":b[13]||(b[13]=_=>I(x)?x.value=_:null),affiliate:n(u),customers:n(D),"is-searching":n(B),"is-adding":n(re),onConfirm:n(ye),onClose:n(we)},null,8,["open","search-query","selected-customer-id","selected-level","affiliate","customers","is-searching","is-adding","onConfirm","onClose"])])}}});export{Qa as default};
