import{_ as B}from"./Card-BjL1m_sW.js";import{_ as Q}from"./Textarea-CZyY9J1c.js";import{_ as M,a as E}from"./Button-CI_-soaG.js";import{d as F,e as V,w as u,a as b,o as y,f as n,b as e,k as X,F as A,r as H,n as J,j as _,t as f,h as w,y as q,q as te,aB as ae,c as j,u as se,i as ne,l as L}from"./app-CyjtdGoI.js";import{_ as ie}from"./default.vue_vue_type_script_setup_true_lang-CxtMHnvj.js";import{_ as oe,g as re}from"./ColorModeButton-Bf7Nr8w3.js";import{u as le}from"./use_midtrans-DxXkbUBo.js";import{_ as de}from"./Badge-DfumusWV.js";import{_ as ce}from"./Separator-CLms6trA.js";import{_ as ue}from"./Modal-Bgd8PL5Y.js";import{_ as me}from"./Checkbox-9qpvU9Db.js";import{_ as pe}from"./SelectMenu-DKAhKU-v.js";import{_ as fe}from"./FormField-qFQ_28ZO.js";import{_ as ye}from"./Alert-CrKiQ9oh.js";import"./DropdownMenu-DxuVXSbh.js";import"./useFormControl-D_pV87FU.js";import"./VisuallyHiddenInput-BGOu5NlX.js";import"./Label-yeknIWsP.js";import"./index-v4g8wp86.js";const ge={class:"flex items-center justify-between"},ve={class:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2"},he={key:0,class:"text-center py-8"},xe={key:1,class:"space-y-3"},ke=["onClick"],be={class:"flex items-start gap-3"},_e={class:"mt-1"},we={key:0,class:"w-2 h-2 rounded-full bg-white"},$e={class:"flex-1"},Se={class:"flex items-center gap-2 mb-1"},Ie={class:"font-medium text-gray-900 dark:text-white"},Ce={class:"font-semibold text-gray-800 dark:text-gray-200"},Ne={class:"text-sm text-gray-600 dark:text-gray-400"},Te={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},Ue={key:0},Re={class:"text-sm text-gray-600 dark:text-gray-400"},Pe=F({__name:"CheckoutAddressCard",props:{addresses:{},selectedAddressId:{}},emits:["update:selectedAddressId","add-address"],setup(i,{emit:N}){const r=N,T=t=>{r("update:selectedAddressId",t)};return(t,o)=>{const g=M,d=E,I=de,$=B;return y(),V($,null,{header:u(()=>[e("div",ge,[e("h3",ve,[n(g,{name:"i-heroicons-map-pin",class:"text-primary"}),o[2]||(o[2]=X(" Alamat Pengiriman ",-1))]),n(d,{size:"sm",variant:"ghost",onClick:o[0]||(o[0]=c=>r("add-address"))},{default:u(()=>[n(g,{name:"i-heroicons-plus",class:"mr-1"}),o[3]||(o[3]=X(" Tambah Alamat ",-1))]),_:1})])]),default:u(()=>[i.addresses.length===0?(y(),b("div",he,[n(g,{name:"i-heroicons-map-pin",class:"w-12 h-12 mx-auto text-gray-300 dark:text-gray-600"}),o[5]||(o[5]=e("p",{class:"mt-2 text-gray-500 dark:text-gray-400"},"Belum ada alamat tersimpan",-1)),n(d,{class:"mt-4",onClick:o[1]||(o[1]=c=>r("add-address"))},{default:u(()=>[...o[4]||(o[4]=[X(" Tambah Alamat Baru ",-1)])]),_:1})])):(y(),b("div",xe,[(y(!0),b(A,null,H(i.addresses,c=>(y(),b("div",{key:c.id,class:J(["relative border rounded-lg p-4 cursor-pointer transition-all",i.selectedAddressId===c.id?"border-primary bg-primary/5 dark:bg-primary/10":"border-gray-200 dark:border-gray-700 hover:border-primary/50"]),onClick:l=>T(c.id)},[e("div",be,[e("div",_e,[e("div",{class:J(["w-5 h-5 rounded-full border-2 flex items-center justify-center transition-colors",i.selectedAddressId===c.id?"border-primary bg-primary":"border-gray-300 dark:border-gray-600"])},[i.selectedAddressId===c.id?(y(),b("div",we)):_("v-if",!0)],2)]),e("div",$e,[e("div",Se,[e("span",Ie,f(c.label),1),c.isDefault?(y(),V(I,{key:0,size:"xs",color:"primary",variant:"soft"},{default:u(()=>[...o[6]||(o[6]=[X("Default",-1)])]),_:1})):_("v-if",!0)]),e("p",Ce,f(c.recipientName),1),e("p",Ne,f(c.phone),1),e("p",Te,[X(f(c.addressLine1)+" ",1),c.addressLine2?(y(),b("span",Ue,", "+f(c.addressLine2),1)):_("v-if",!0)]),e("p",Re,f(c.cityName)+", "+f(c.provinceName)+" "+f(c.postalCode),1)])])],10,ke))),128))]))]),_:1})}}}),Xe={class:"flex items-center justify-between"},Ae={class:"text-sm text-gray-500 dark:text-gray-400"},je={class:"divide-y divide-gray-100 dark:divide-gray-800"},Ve=["src","alt"],De={class:"flex-1 min-w-0"},Oe={class:"font-medium text-gray-900 dark:text-white truncate"},Le={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},qe={class:"flex items-center justify-between mt-1"},Fe={class:"text-sm text-gray-500 dark:text-gray-400"},Ke={class:"font-medium text-gray-900 dark:text-white"},Be={class:"mt-4 pt-4 border-t border-gray-100 dark:border-gray-800"},Me={class:"flex justify-between text-sm"},Ee={class:"font-semibold text-gray-900 dark:text-white"},We={class:"flex justify-between text-sm mt-1"},ze={class:"text-gray-900 dark:text-white"},He={class:"mt-6 pt-4 border-t border-gray-100 dark:border-gray-800"},Je={key:0,class:"flex items-center justify-center py-4"},Ge={class:"text-center py-4"},Qe={class:"text-center py-4"},Ye={class:"space-y-2"},Ze=["onClick"],et={class:"flex-1"},tt={class:"flex items-center justify-between"},at={class:"font-medium text-gray-900 dark:text-white"},st={class:"font-semibold text-primary-600 dark:text-primary-400"},nt={class:"flex items-center justify-between mt-1"},it={class:"text-sm text-gray-500 dark:text-gray-400"},ot={class:"text-xs text-gray-400 dark:text-gray-500"},rt=F({__name:"CheckoutItemsCard",props:{items:{},totalWeight:{},subtotal:{},destinationDistrictId:{},selectedShipping:{}},emits:["update:selectedShipping"],setup(i,{emit:N}){const r=i,T=N,t=w([]),o=w(!1),g=w(null),d=l=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),I=()=>{if(typeof document>"u")return null;const l=document.cookie.match(/XSRF-TOKEN=([^;]+)/);return l?decodeURIComponent(l[1]):null},$=async()=>{if(!r.destinationDistrictId){t.value=[];return}o.value=!0;try{const l=I(),S=await(await fetch("/api/shipping/rates",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",...l&&{"X-XSRF-TOKEN":l}},credentials:"include",body:JSON.stringify({destinationDistrictId:r.destinationDistrictId,weight:r.totalWeight})})).json();S.success&&(t.value=S.data||[])}catch(l){console.error("Failed to fetch shipping rates:",l),t.value=[]}finally{o.value=!1}},c=l=>{g.value=`${l.courierCode}-${l.courierService}`,T("update:selectedShipping",{courierCode:l.courierCode,courierService:l.courierService,courierName:l.courierName,serviceDescription:l.serviceDescription,cost:l.cost,etd:l.etd})};return q(()=>r.destinationDistrictId,$),te(()=>{r.destinationDistrictId&&$()}),(l,m)=>{const S=M,D=ae("URadio"),O=B;return y(),V(O,null,{header:u(()=>[e("div",Xe,[m[0]||(m[0]=e("h3",{class:"font-semibold text-gray-900 dark:text-white"},"Detail Pesanan",-1)),e("span",Ae,f(i.items.length)+" item",1)])]),default:u(()=>[e("div",je,[(y(!0),b(A,null,H(i.items,p=>(y(),b("div",{key:p.id,class:"flex gap-4 py-4 first:pt-0 last:pb-0"},[e("img",{src:p.image||"/images/placeholder.png",alt:p.productName,class:"w-16 h-16 rounded-lg object-cover bg-gray-100 dark:bg-gray-800"},null,8,Ve),e("div",De,[e("p",Oe,f(p.productName),1),p.variantName?(y(),b("p",Le,f(p.variantName),1)):_("v-if",!0),e("div",qe,[e("span",Fe,"x"+f(p.quantity),1),e("span",Ke,f(d(p.price*p.quantity)),1)])])]))),128))]),e("div",Be,[e("div",Me,[m[1]||(m[1]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Subtotal",-1)),e("span",Ee,f(d(i.subtotal)),1)]),e("div",We,[m[2]||(m[2]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Berat Total",-1)),e("span",ze,f(i.totalWeight)+" gram",1)])]),e("div",He,[m[6]||(m[6]=e("h4",{class:"font-medium text-gray-900 dark:text-white mb-3"},"Pilih Pengiriman",-1)),_(" Loading "),o.value?(y(),b("div",Je,[n(S,{name:"i-heroicons-arrow-path",class:"w-5 h-5 animate-spin text-primary-500"}),m[3]||(m[3]=e("span",{class:"ml-2 text-sm text-gray-500 dark:text-gray-400"},"Memuat opsi pengiriman...",-1))])):i.destinationDistrictId?t.value.length===0?(y(),b(A,{key:2},[_(" No Options Available "),e("div",Qe,[n(S,{name:"i-heroicons-truck",class:"w-8 h-8 mx-auto text-gray-300 dark:text-gray-600"}),m[5]||(m[5]=e("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},"Tidak ada opsi pengiriman tersedia",-1))])],2112)):(y(),b(A,{key:3},[_(" Shipping Options List "),e("div",Ye,[(y(!0),b(A,null,H(t.value,p=>(y(),b("div",{key:`${p.courierCode}-${p.courierService}`,class:J(["flex items-center p-3 rounded-lg border cursor-pointer transition-colors",g.value===`${p.courierCode}-${p.courierService}`?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-primary-300 dark:hover:border-primary-600"]),onClick:K=>c(p)},[n(D,{"model-value":g.value===`${p.courierCode}-${p.courierService}`,class:"mr-3"},null,8,["model-value"]),e("div",et,[e("div",tt,[e("span",at,f(p.courierName),1),e("span",st,f(d(p.cost)),1)]),e("div",nt,[e("span",it,f(p.serviceDescription),1),e("span",ot,f(p.etd),1)])])],10,Ze))),128))])],2112)):(y(),b(A,{key:1},[_(" No Address Selected "),e("div",Ge,[n(S,{name:"i-heroicons-map-pin",class:"w-8 h-8 mx-auto text-gray-300 dark:text-gray-600"}),m[4]||(m[4]=e("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},"Pilih alamat pengiriman terlebih dahulu",-1))])],2112))])]),_:1})}}}),lt={class:"sticky top-4"},dt={class:"space-y-3"},ct={class:"flex justify-between"},ut={class:"text-gray-600 dark:text-gray-400"},mt={class:"font-medium text-gray-900 dark:text-white"},pt={class:"flex justify-between"},ft={class:"font-medium text-gray-900 dark:text-white"},yt={class:"flex justify-between text-lg"},gt={class:"font-bold text-primary"},vt=F({__name:"CheckoutSummaryCard",props:{subtotal:{},totalItems:{},totalShipping:{},canCheckout:{type:Boolean},isProcessing:{type:Boolean}},emits:["checkout"],setup(i,{emit:N}){const r=i,T=N,t=j(()=>r.subtotal+r.totalShipping),o=g=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(g);return(g,d)=>{const I=ce,$=M,c=E,l=B;return y(),b("div",lt,[n(l,null,{header:u(()=>[...d[1]||(d[1]=[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Ringkasan Pesanan",-1)])]),footer:u(()=>[n(c,{block:"",size:"lg",disabled:!i.canCheckout||i.isProcessing,loading:i.isProcessing,onClick:d[0]||(d[0]=m=>T("checkout"))},{default:u(()=>[i.isProcessing?_("v-if",!0):(y(),V($,{key:0,name:"i-heroicons-credit-card",class:"mr-2"})),X(" "+f(i.isProcessing?"Memproses...":"Bayar Sekarang"),1)]),_:1},8,["disabled","loading"]),d[4]||(d[4]=e("p",{class:"text-xs text-center text-gray-500 dark:text-gray-400 mt-3"}," Dengan melanjutkan, Anda menyetujui syarat dan ketentuan yang berlaku ",-1))]),default:u(()=>[e("div",dt,[e("div",ct,[e("span",ut,"Subtotal ("+f(i.totalItems)+" item)",1),e("span",mt,f(o(i.subtotal)),1)]),e("div",pt,[d[2]||(d[2]=e("span",{class:"text-gray-600 dark:text-gray-400"},"Total Ongkos Kirim",-1)),e("span",ft,f(o(i.totalShipping)),1)]),n(I),e("div",yt,[d[3]||(d[3]=e("span",{class:"font-semibold text-gray-900 dark:text-white"},"Total",-1)),e("span",gt,f(o(t.value)),1)])])]),_:1})])}}}),ht={class:"space-y-4 max-h-[60vh] overflow-y-auto overflow-x-visible p-4"},xt={class:"flex justify-end gap-3 p-4"},kt=F({__name:"CheckoutAddressModal",props:{open:{type:Boolean},defaultName:{},defaultPhone:{},isFirstAddress:{type:Boolean}},emits:["update:open","saved"],setup(i,{emit:N}){const r=i,T=N,t=w({label:"",recipientName:r.defaultName||"",phone:r.defaultPhone||"",addressLine1:"",addressLine2:"",provinceId:"",provinceName:"",cityId:"",cityName:"",districtId:"",districtName:"",postalCode:"",isDefault:r.isFirstAddress||!1}),o=w([]),g=w([]),d=w([]),I=w(!1),$=w(!1),c=w(!1),l=w(!1),m=w(null),S=()=>{if(typeof document>"u")return null;const s=document.cookie.match(/XSRF-TOKEN=([^;]+)/);return s?decodeURIComponent(s[1]):null},D=async()=>{I.value=!0;try{const s=S(),x=await(await fetch("/api/location/provinces",{headers:{"X-Requested-With":"XMLHttpRequest",...s&&{"X-XSRF-TOKEN":s}},credentials:"include"})).json();x.success&&(o.value=x.data||[])}catch(s){console.error("Error fetching provinces:",s)}finally{I.value=!1}},O=async s=>{$.value=!0,g.value=[],d.value=[],t.value.cityId="",t.value.cityName="",t.value.districtId="",t.value.districtName="";try{const a=S(),R=await(await fetch(`/api/location/cities?provinceId=${s}`,{headers:{"X-Requested-With":"XMLHttpRequest",...a&&{"X-XSRF-TOKEN":a}},credentials:"include"})).json();R.success&&(g.value=R.data||[])}catch(a){console.error("Error fetching cities:",a)}finally{$.value=!1}},p=async s=>{c.value=!0,d.value=[],t.value.districtId="",t.value.districtName="";try{const a=S(),R=await(await fetch(`/api/location/districts?cityId=${s}`,{headers:{"X-Requested-With":"XMLHttpRequest",...a&&{"X-XSRF-TOKEN":a}},credentials:"include"})).json();R.success&&(d.value=R.data||[])}catch(a){console.error("Error fetching districts:",a)}finally{c.value=!1}},K=async()=>{if(m.value=null,!t.value.recipientName||!t.value.phone||!t.value.addressLine1||!t.value.provinceId||!t.value.cityId||!t.value.postalCode){m.value="Mohon lengkapi semua field yang diperlukan";return}l.value=!0;try{const s=S(),x=await(await fetch("/api/address",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",...s&&{"X-XSRF-TOKEN":s}},credentials:"include",body:JSON.stringify(t.value)})).json();x.success?(T("saved"),T("update:open",!1)):m.value=x.message||"Gagal menyimpan alamat"}catch(s){console.error("Error saving address:",s),m.value="Gagal menyimpan alamat"}finally{l.value=!1}},W=()=>{T("update:open",!1)},v=()=>{t.value={label:"",recipientName:r.defaultName||"",phone:r.defaultPhone||"",addressLine1:"",addressLine2:"",provinceId:"",provinceName:"",cityId:"",cityName:"",districtId:"",districtName:"",postalCode:"",isDefault:r.isFirstAddress||!1},m.value=null},k=j(()=>o.value.map(s=>({label:s.name,value:String(s.id)}))),C=j(()=>g.value.map(s=>({label:s.type?`${s.type} ${s.name}`:s.name,value:String(s.id)}))),U=j(()=>d.value.map(s=>({label:s.name,value:String(s.id)})));return q(()=>t.value.provinceId,s=>{if(s){const a=o.value.find(x=>String(x.id)===s);t.value.provinceName=a?.name||"",O(s)}}),q(()=>t.value.cityId,s=>{if(s){const a=g.value.find(x=>String(x.id)===s);t.value.cityName=a?a.type?`${a.type} ${a.name}`:a.name:"",p(s)}}),q(()=>t.value.districtId,s=>{if(s){const a=d.value.find(x=>String(x.id)===s);t.value.districtName=a?.name||""}}),q(()=>r.open,s=>{s&&(v(),o.value.length===0&&D())}),(s,a)=>{const x=ye,R=oe,P=fe,z=pe,Y=Q,Z=me,G=E,ee=ue;return y(),V(ee,{open:i.open,"onUpdate:open":a[10]||(a[10]=h=>T("update:open",h)),title:"Tambah Alamat Baru",description:"Isi form berikut untuk menambahkan alamat pengiriman baru",ui:{overlay:"z-[100]",content:"z-[100]"}},{body:u(()=>[e("div",ht,[m.value?(y(),V(x,{key:0,color:"error",title:m.value,icon:"i-heroicons-exclamation-circle"},null,8,["title"])):_("v-if",!0),n(P,{label:"Label Alamat"},{default:u(()=>[n(R,{modelValue:t.value.label,"onUpdate:modelValue":a[0]||(a[0]=h=>t.value.label=h),placeholder:"Contoh: Rumah, Kantor",class:"w-full"},null,8,["modelValue"])]),_:1}),n(P,{label:"Nama Penerima",required:""},{default:u(()=>[n(R,{modelValue:t.value.recipientName,"onUpdate:modelValue":a[1]||(a[1]=h=>t.value.recipientName=h),placeholder:"Nama lengkap penerima",class:"w-full"},null,8,["modelValue"])]),_:1}),n(P,{label:"No. Telepon",required:""},{default:u(()=>[n(R,{modelValue:t.value.phone,"onUpdate:modelValue":a[2]||(a[2]=h=>t.value.phone=h),placeholder:"08xxxxxxxxxx",type:"tel",class:"w-full"},null,8,["modelValue"])]),_:1}),n(P,{label:"Provinsi",required:""},{default:u(()=>[n(z,{modelValue:t.value.provinceId,"onUpdate:modelValue":a[3]||(a[3]=h=>t.value.provinceId=h),items:k.value,placeholder:"Pilih Provinsi",loading:I.value,"value-key":"value",ui:{content:"z-[200] bg-white dark:bg-gray-900"},class:"w-full"},null,8,["modelValue","items","loading"])]),_:1}),n(P,{label:"Kota/Kabupaten",required:""},{default:u(()=>[n(z,{modelValue:t.value.cityId,"onUpdate:modelValue":a[4]||(a[4]=h=>t.value.cityId=h),items:C.value,placeholder:"Pilih Kota/Kabupaten",loading:$.value,disabled:!t.value.provinceId,"value-key":"value",ui:{content:"z-[200] bg-white dark:bg-gray-900"},class:"w-full"},null,8,["modelValue","items","loading","disabled"])]),_:1}),n(P,{label:"Kecamatan",required:""},{default:u(()=>[n(z,{modelValue:t.value.districtId,"onUpdate:modelValue":a[5]||(a[5]=h=>t.value.districtId=h),items:U.value,placeholder:"Pilih Kecamatan",loading:c.value,disabled:!t.value.cityId,"value-key":"value",ui:{content:"z-[200] bg-white dark:bg-gray-900"},class:"w-full"},null,8,["modelValue","items","loading","disabled"])]),_:1}),n(P,{label:"Alamat Lengkap",required:""},{default:u(()=>[n(Y,{modelValue:t.value.addressLine1,"onUpdate:modelValue":a[6]||(a[6]=h=>t.value.addressLine1=h),placeholder:"Nama jalan, nomor rumah, RT/RW",rows:2,class:"w-full"},null,8,["modelValue"])]),_:1}),n(P,{label:"Detail Tambahan"},{default:u(()=>[n(R,{modelValue:t.value.addressLine2,"onUpdate:modelValue":a[7]||(a[7]=h=>t.value.addressLine2=h),placeholder:"Patokan, nama gedung, dll (opsional)",class:"w-full"},null,8,["modelValue"])]),_:1}),n(P,{label:"Kode Pos",required:""},{default:u(()=>[n(R,{modelValue:t.value.postalCode,"onUpdate:modelValue":a[8]||(a[8]=h=>t.value.postalCode=h),placeholder:"12345",class:"w-full"},null,8,["modelValue"])]),_:1}),n(Z,{modelValue:t.value.isDefault,"onUpdate:modelValue":a[9]||(a[9]=h=>t.value.isDefault=h),label:"Jadikan alamat utama",class:"w-full"},null,8,["modelValue"])])]),footer:u(()=>[e("div",xt,[n(G,{variant:"ghost",onClick:W},{default:u(()=>[...a[11]||(a[11]=[X("Batal",-1)])]),_:1}),n(G,{loading:l.value,onClick:K},{default:u(()=>[...a[12]||(a[12]=[X("Simpan Alamat",-1)])]),_:1},8,["loading"])])]),_:1},8,["open"])}}}),bt={class:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8"},_t={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},wt={class:"mb-8"},$t={class:"text-gray-500 dark:text-gray-400 mt-1"},St={key:0,class:"text-center py-16"},It={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},Ct={class:"lg:col-span-2 space-y-6"},Nt={class:"lg:col-span-1"},Ht=F({layout:ie,__name:"index",props:{addresses:{},items:{},summary:{},customer:{}},setup(i){const N=i,r=re(),{openSnapPopup:T,isSnapLoaded:t}=le(),o=w(N.addresses.find(v=>v.isDefault)?.id||N.addresses[0]?.id||null),g=w(null),d=w(""),I=w(!1),$=w(!1),c=j(()=>N.addresses.find(v=>v.id===o.value)),l=j(()=>c.value?.districtId||null),m=j(()=>g.value?.cost||0),S=j(()=>!(!o.value||N.items.length===0||!g.value)),D=()=>{if(typeof document>"u")return null;const v=document.cookie.match(/XSRF-TOKEN=([^;]+)/);return v?decodeURIComponent(v[1]):null},O=v=>{g.value=v},p=v=>{o.value=v,g.value=null},K=()=>{r.success("Alamat berhasil ditambahkan"),L.reload({only:["addresses"]})},W=async()=>{if(!S.value){r.error("Mohon pilih alamat dan metode pengiriman");return}I.value=!0;try{const v=D(),C=await(await fetch("/api/checkout",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",...v&&{"X-XSRF-TOKEN":v}},credentials:"include",body:JSON.stringify({addressId:o.value,shipping:g.value,notes:d.value})})).json();C.success&&C.data?.payment?.snapToken?t()?await T(C.data.payment.snapToken,{onSuccess:async U=>{C.data.order?.id&&await fetch(`/api/orders/${C.data.order.id}/verify-payment`,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",...v&&{"X-XSRF-TOKEN":v}},credentials:"include",body:JSON.stringify({transactionStatus:U?.transaction_status||"settlement",transactionId:U?.transaction_id})}),r.success("Pembayaran berhasil!"),L.visit("/orders")},onPending:async U=>{C.data.order?.id&&await fetch(`/api/orders/${C.data.order.id}/verify-payment`,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",...v&&{"X-XSRF-TOKEN":v}},credentials:"include",body:JSON.stringify({transactionStatus:U?.transaction_status||"pending",transactionId:U?.transaction_id})}),r.info("Menunggu pembayaran..."),L.visit("/orders")},onError:U=>{r.error(U.status_message||"Pembayaran gagal"),L.visit("/orders")},onClose:()=>{r.info("Pembayaran dibatalkan. Silakan selesaikan pembayaran melalui halaman pesanan."),L.visit("/orders")}}):window.location.href=C.data.payment.snapRedirectUrl:r.error(C.message||"Gagal memproses checkout")}catch(v){console.error("Checkout error:",v),r.error("Terjadi kesalahan saat memproses checkout")}finally{I.value=!1}};return(v,k)=>{const C=M,U=E,s=Q,a=B;return y(),b(A,null,[n(se(ne),{title:"Checkout - Ogitu"}),e("div",bt,[e("div",_t,[_(" Header "),e("div",wt,[k[3]||(k[3]=e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Checkout",-1)),e("p",$t,f(i.summary.totalItems)+" item dalam pesanan",1)]),_(" Empty State "),i.items.length===0?(y(),b("div",St,[n(C,{name:"i-heroicons-shopping-cart",class:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),k[5]||(k[5]=e("h2",{class:"mt-4 text-xl font-semibold text-gray-900 dark:text-white"},"Tidak ada item untuk checkout",-1)),k[6]||(k[6]=e("p",{class:"mt-2 text-gray-500 dark:text-gray-400"},"Pilih item dari keranjang terlebih dahulu",-1)),n(U,{to:"/cart",class:"mt-4"},{default:u(()=>[...k[4]||(k[4]=[X(" Kembali ke Keranjang ",-1)])]),_:1})])):(y(),b(A,{key:1},[_(" Checkout Content "),e("div",It,[_(" Left Column - Items & Shipping "),e("div",Ct,[_(" Address Section "),n(Pe,{addresses:i.addresses,"selected-address-id":o.value,"onUpdate:selectedAddressId":p,onAddAddress:k[0]||(k[0]=x=>$.value=!0)},null,8,["addresses","selected-address-id"]),_(" Items & Shipping "),n(rt,{items:i.items,"total-weight":i.summary.totalWeight,subtotal:i.summary.subtotal,"destination-district-id":l.value,"selected-shipping":g.value,"onUpdate:selectedShipping":O},null,8,["items","total-weight","subtotal","destination-district-id","selected-shipping"]),_(" Notes "),n(a,null,{header:u(()=>[...k[7]||(k[7]=[e("h3",{class:"font-semibold text-gray-900 dark:text-white"},"Catatan (Opsional)",-1)])]),default:u(()=>[n(s,{modelValue:d.value,"onUpdate:modelValue":k[1]||(k[1]=x=>d.value=x),placeholder:"Tambahkan catatan untuk pesanan Anda...",rows:3},null,8,["modelValue"])]),_:1})]),_(" Right Column - Summary "),e("div",Nt,[n(vt,{subtotal:i.summary.subtotal,"total-items":i.summary.totalItems,"total-shipping":m.value,"can-checkout":S.value,"is-processing":I.value,onCheckout:W},null,8,["subtotal","total-items","total-shipping","can-checkout","is-processing"])])])],2112))])]),_(" Add Address Modal "),n(kt,{open:$.value,"onUpdate:open":k[2]||(k[2]=x=>$.value=x),"default-name":i.customer.fullName,"default-phone":i.customer.phone,"is-first-address":i.addresses.length===0,onSaved:K},null,8,["open","default-name","default-phone","is-first-address"])],64)}}});export{Ht as default};
