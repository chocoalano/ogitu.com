import{h as T,l as P,d as U,Q as x,R as $,c as I,y as E,e as D,w as s,f as n,b as l,j as h,t as g,u as R,k as C,o as j}from"./app-CyjtdGoI.js";import{g as N,_ as F}from"./ColorModeButton-Bf7Nr8w3.js";import{_ as B}from"./Modal-Bgd8PL5Y.js";import{_ as O}from"./Card-BjL1m_sW.js";import{_ as V}from"./FormField-qFQ_28ZO.js";import{_ as A}from"./SelectMenu-DKAhKU-v.js";import{a as M}from"./Button-CI_-soaG.js";import{_ as K}from"./Textarea-CZyY9J1c.js";import{_ as G}from"./Alert-CrKiQ9oh.js";function S(){if(typeof document>"u")return"";const e=document.cookie.match(/XSRF-TOKEN=([^;]+)/);return e?decodeURIComponent(e[1]):""}function ge(){const e=N(),i=T(!1);return{isLoading:i,processOrder:async a=>{i.value=!0;try{const o=await(await fetch(`/api/admin/orders/${a}/process`,{method:"POST",headers:{Accept:"application/json","X-XSRF-TOKEN":S()}})).json();return o.success?(e.success("Berhasil","Pesanan sedang diproses"),!0):(e.error("Gagal",o.message||"Gagal memproses"),!1)}catch{return e.error("Error","Terjadi kesalahan saat memproses pesanan"),!1}finally{i.value=!1}},submitShipping:async(a,r,o=!1)=>{if(!r.courierCode||!r.waybill)return e.error("Error","Kurir dan nomor resi wajib diisi"),!1;i.value=!0;try{const m=o?"PUT":"POST",f=`/api/admin/orders/${a}/shipping`,b=await(await fetch(f,{method:m,headers:{Accept:"application/json","Content-Type":"application/json","X-XSRF-TOKEN":S()},body:JSON.stringify(r)})).json();return b.success?(e.success("Berhasil",o?"Data pengiriman diperbarui":"Pesanan telah dikirim"),!0):(e.error("Gagal",b.message||"Gagal menyimpan"),!1)}catch{return e.error("Error","Terjadi kesalahan saat menyimpan data pengiriman"),!1}finally{i.value=!1}},refreshTracking:async a=>{i.value=!0;try{const o=await(await fetch(`/api/admin/orders/${a}/track`,{headers:{Accept:"application/json"}})).json();return o.success?(e.success("Berhasil","Data tracking diperbarui"),o.tracking):(e.warning("Info",o.message||"Data tracking belum tersedia"),null)}catch{return e.error("Error","Gagal memuat data tracking"),null}finally{i.value=!1}},cancelOrder:async(a,r="")=>{i.value=!0;try{const m=await(await fetch(`/api/admin/orders/${a}/cancel`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-XSRF-TOKEN":S()},body:JSON.stringify({reason:r})})).json();return m.success?(e.success("Berhasil","Pesanan dibatalkan"),!0):(e.error("Gagal",m.message||"Gagal membatalkan"),!1)}catch{return e.error("Error","Terjadi kesalahan saat membatalkan pesanan"),!1}finally{i.value=!1}},reloadOrders:(a=["orders","stats"])=>{P.reload({only:a})},reloadPage:()=>{P.reload()},copyToClipboard:a=>{typeof navigator<"u"&&navigator.clipboard&&(navigator.clipboard.writeText(a),e.success("Disalin","Teks berhasil disalin ke clipboard"))}}}const X=[{value:"REG",label:"Regular"},{value:"YES",label:"Yakin Esok Sampai"},{value:"OKE",label:"Ongkos Kirim Ekonomis"},{value:"JTR",label:"JTR (J&T Cargo)"},{value:"EXPRESS",label:"Express"},{value:"SAME_DAY",label:"Same Day"}],J={warning:"warning",info:"info",primary:"primary",success:"success",error:"error",neutral:"neutral"};function he(e){return J[e]||"neutral"}function L(){const e=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),i=t=>t?new Date(t).toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",c=t=>t?new Date(t).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-";return{formatCurrency:e,formatDate:i,formatShortDate:c,formatRelativeTime:t=>{const u=new Date(t),d=new Date().getTime()-u.getTime(),a=Math.floor(d/6e4),r=Math.floor(d/36e5),o=Math.floor(d/864e5);return a<1?"Baru saja":a<60?`${a} menit lalu`:r<24?`${r} jam lalu`:o<7?`${o} hari lalu`:c(t)},formatWeight:t=>t>=1e3?`${(t/1e3).toFixed(1)} kg`:`${t} gram`}}const q={class:"flex items-center justify-between"},z={class:"text-lg font-semibold text-gray-900 dark:text-white"},W={class:"space-y-4"},Y={class:"p-3 bg-gray-50 dark:bg-gray-900 rounded-lg"},H={class:"font-medium text-gray-900 dark:text-white"},Q={class:"text-sm text-gray-500 dark:text-gray-400"},Z={class:"flex justify-end gap-3"},ye=U({__name:"ShippingModal",props:x({order:{},couriers:{},loading:{type:Boolean}},{open:{type:Boolean,required:!0},openModifiers:{}}),emits:x(["submit"],["update:open"]),setup(e,{emit:i}){const c=$(e,"open"),y=e,_=i,t=T({courierCode:"",courierService:"REG",waybill:"",weight:1e3}),u=I(()=>!!y.order?.shipping?.waybill);E(()=>y.order,a=>{a&&(t.value={courierCode:a.shipping?.courierCode||"",courierService:a.shipping?.courierService||"REG",waybill:a.shipping?.waybill||"",weight:a.shipping?.weight||1e3})},{immediate:!0});const v=()=>{_("submit",{...t.value},u.value)},d=()=>{c.value=!1};return(a,r)=>{const o=M,m=A,f=V,k=F,b=O,w=B;return j(),D(w,{open:c.value,"onUpdate:open":r[4]||(r[4]=p=>c.value=p),title:u.value?"Update Pengiriman":"Input Pengiriman",description:"Masukkan informasi pengiriman pesanan",ui:{overlay:"z-[100]",content:"z-[100]"}},{content:s(()=>[n(b,{class:"max-h-[85vh] overflow-y-auto"},{header:s(()=>[l("div",q,[l("h3",z,g(u.value?"Update Pengiriman":"Input Pengiriman"),1),n(o,{color:"neutral",variant:"ghost",icon:"i-heroicons-x-mark",onClick:d})])]),footer:s(()=>[l("div",Z,[n(o,{color:"neutral",variant:"ghost",onClick:d},{default:s(()=>[...r[5]||(r[5]=[C(" Batal ",-1)])]),_:1}),n(o,{color:"primary",loading:e.loading,onClick:v},{default:s(()=>[C(g(u.value?"Perbarui":"Kirim Pesanan"),1)]),_:1},8,["loading"])])]),default:s(()=>[l("div",W,[h(" Order Info "),l("div",Y,[l("p",H,g(e.order?.orderNumber),1),l("p",Q,g(e.order?.customer?.name)+" • "+g(e.order?.itemCount)+" item ",1)]),h(" Courier Select "),n(f,{label:"Kurir",required:""},{default:s(()=>[n(m,{modelValue:t.value.courierCode,"onUpdate:modelValue":r[0]||(r[0]=p=>t.value.courierCode=p),items:e.couriers,"value-key":"code","option-attribute":"name",placeholder:"Pilih kurir",class:"w-full"},null,8,["modelValue","items"])]),_:1}),h(" Service Select "),n(f,{label:"Layanan"},{default:s(()=>[n(m,{modelValue:t.value.courierService,"onUpdate:modelValue":r[1]||(r[1]=p=>t.value.courierService=p),items:R(X),"value-key":"value","option-attribute":"label",placeholder:"Pilih layanan",class:"w-full"},null,8,["modelValue","items"])]),_:1}),h(" Waybill Input "),n(f,{label:"Nomor Resi",required:""},{default:s(()=>[n(k,{modelValue:t.value.waybill,"onUpdate:modelValue":r[2]||(r[2]=p=>t.value.waybill=p),placeholder:"Masukkan nomor resi",class:"w-full font-mono"},null,8,["modelValue"])]),_:1}),h(" Weight Input "),n(f,{label:"Berat (gram)"},{default:s(()=>[n(k,{modelValue:t.value.weight,"onUpdate:modelValue":r[3]||(r[3]=p=>t.value.weight=p),type:"number",placeholder:"Berat dalam gram",class:"w-full"},null,8,["modelValue"])]),_:1})])]),_:1})]),_:1},8,["open","title"])}}}),ee={class:"flex items-center justify-between"},ae={class:"space-y-4"},te={class:"p-3 bg-gray-50 dark:bg-gray-900 rounded-lg"},re={class:"font-medium text-gray-900 dark:text-white"},oe={class:"text-sm text-gray-500 dark:text-gray-400"},ne={class:"flex justify-end gap-3"},ve=U({__name:"CancelModal",props:x({order:{},loading:{type:Boolean}},{open:{type:Boolean,required:!0},openModifiers:{}}),emits:x(["confirm"],["update:open"]),setup(e,{emit:i}){const c=$(e,"open"),y=i,{formatCurrency:_}=L(),t=T("");E(c,d=>{d||(t.value="")});const u=()=>{y("confirm",t.value)},v=()=>{c.value=!1};return(d,a)=>{const r=M,o=G,m=K,f=V,k=O,b=B;return j(),D(b,{open:c.value,"onUpdate:open":a[1]||(a[1]=w=>c.value=w),title:"Batalkan Pesanan",description:"Konfirmasi pembatalan pesanan",ui:{overlay:"z-[100]",content:"z-[100]"}},{content:s(()=>[n(k,{class:"max-h-[85vh] overflow-y-auto"},{header:s(()=>[l("div",ee,[a[2]||(a[2]=l("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," Batalkan Pesanan ",-1)),n(r,{color:"neutral",variant:"ghost",icon:"i-heroicons-x-mark",onClick:v})])]),footer:s(()=>[l("div",ne,[n(r,{color:"neutral",variant:"ghost",onClick:v},{default:s(()=>[...a[3]||(a[3]=[C(" Kembali ",-1)])]),_:1}),n(r,{color:"error",loading:e.loading,onClick:u},{default:s(()=>[...a[4]||(a[4]=[C(" Ya, Batalkan Pesanan ",-1)])]),_:1},8,["loading"])])]),default:s(()=>[l("div",ae,[n(o,{color:"warning",variant:"soft",icon:"i-heroicons-exclamation-triangle",title:"Perhatian",description:"Pembatalan pesanan tidak dapat dibatalkan. Pastikan Anda sudah berkomunikasi dengan pembeli."}),h(" Order Info "),l("div",te,[l("p",re,g(e.order?.orderNumber),1),l("p",oe,g(e.order?.customer?.name)+" • "+g(R(_)(e.order?.total||0)),1)]),h(" Reason Input "),n(f,{label:"Alasan Pembatalan"},{default:s(()=>[n(m,{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=w=>t.value=w),placeholder:"Masukkan alasan pembatalan (opsional)",rows:3,class:"w-full"},null,8,["modelValue"])]),_:1})])]),_:1})]),_:1},8,["open"])}}});export{ye as _,ge as a,ve as b,he as g,L as u};
