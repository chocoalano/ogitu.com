import{_ as le}from"./Modal-Bgd8PL5Y.js";import{_ as oe}from"./Pagination-97jdZAo5.js";import{_ as re}from"./Select-D6kv-Jzs.js";import{_ as ie}from"./Table-C6nABs7j.js";import{_ as R,a as z}from"./Button-CI_-soaG.js";import{_ as F}from"./Badge-DfumusWV.js";import{_ as E}from"./Checkbox-9qpvU9Db.js";import{d as O,a as P,F as W,r as ne,b as s,n as q,f as r,t as w,u as B,o as _,h as v,c as J,y as H,j as d,L as ce,w as u,k as x,l as T,m as K,p as o}from"./app-CyjtdGoI.js";import{_ as ue,g as de}from"./ColorModeButton-Bf7Nr8w3.js";import{A as me}from"./admin-BzR6vrex.js";import{f as M,g as X,a as G,b as ve}from"./types-B2pfy8Mo.js";import{_ as pe}from"./SelectMenu-DKAhKU-v.js";import"./useFormControl-D_pV87FU.js";import"./index-v4g8wp86.js";import"./VisuallyHiddenInput-BGOu5NlX.js";import"./Label-yeknIWsP.js";import"./Tooltip-BrTR-Vq7.js";const fe={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},ge={class:"flex items-center gap-3"},he={class:"text-2xl font-bold text-slate-900 dark:text-white"},xe={class:"text-xs text-slate-500 dark:text-slate-400"},ke=O({__name:"ProductStatsCards",props:{stats:{}},setup(i){const m=n=>[{label:"Total Produk",value:n.total,icon:"i-heroicons-cube",color:"text-violet-500",bgColor:"bg-violet-500/10"},{label:"Produk Aktif",value:n.active,icon:"i-heroicons-check-circle",color:"text-emerald-500",bgColor:"bg-emerald-500/10"},{label:"Draft",value:n.draft,icon:"i-heroicons-document",color:"text-slate-500",bgColor:"bg-slate-500/10"},{label:"Stok Habis",value:n.outOfStock,icon:"i-heroicons-exclamation-triangle",color:"text-red-500",bgColor:"bg-red-500/10"}];return(n,k)=>{const f=R;return _(),P("div",fe,[(_(!0),P(W,null,ne(m(i.stats),t=>(_(),P("div",{key:t.label,class:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700"},[s("div",ge,[s("div",{class:q(["w-10 h-10 rounded-lg flex items-center justify-center",t.bgColor])},[r(f,{name:t.icon,class:q(["w-5 h-5",t.color])},null,8,["name","class"])],2),s("div",null,[s("p",he,w(B(M)(t.value)),1),s("p",xe,w(t.label),1)])])]))),128))])}}}),be={class:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 p-4"},ye={class:"flex flex-col lg:flex-row gap-4"},we={class:"flex-1"},Pe={class:"w-full lg:w-48"},_e={class:"w-full lg:w-48"},Se={class:"flex gap-2"},Ce=O({__name:"ProductFilters",props:{filters:{},categories:{}},emits:["update:filters","search","reset"],setup(i,{emit:m}){const n=i,k=m,f=v(n.filters.search||""),t=v(n.filters.status||"all"),g=v(n.filters.categoryId?.toString()||"all"),b=[{label:"Semua Status",value:"all"},{label:"Aktif",value:"active"},{label:"Draft",value:"draft"},{label:"Nonaktif",value:"inactive"},{label:"Stok Habis",value:"out_of_stock"}],C=J(()=>[{label:"Semua Kategori",value:"all"},...n.categories.map(j=>({label:j.name,value:j.id.toString()}))]),y=()=>{k("update:filters",{search:f.value||void 0,status:t.value!=="all"?t.value:void 0,categoryId:g.value!=="all"?Number(g.value):void 0}),k("search")},$=()=>{f.value="",t.value="all",g.value="all",k("update:filters",{}),k("reset")};let U;const h=()=>{clearTimeout(U),U=setTimeout(()=>{y()},500)};return H([t,g],()=>{y()}),(j,c)=>{const V=ue,I=pe,D=z;return _(),P("div",be,[s("div",ye,[d(" Search Input "),s("div",we,[r(V,{modelValue:f.value,"onUpdate:modelValue":c[0]||(c[0]=A=>f.value=A),placeholder:"Cari produk berdasarkan nama, SKU, atau brand...",icon:"i-heroicons-magnifying-glass",size:"md",class:"w-full",onInput:h,onKeyup:ce(y,["enter"])},null,8,["modelValue"])]),d(" Status Filter "),s("div",Pe,[r(I,{modelValue:t.value,"onUpdate:modelValue":c[1]||(c[1]=A=>t.value=A),items:b,"value-key":"value",placeholder:"Status",size:"md"},null,8,["modelValue"])]),d(" Category Filter "),s("div",_e,[r(I,{modelValue:g.value,"onUpdate:modelValue":c[2]||(c[2]=A=>g.value=A),items:C.value,"value-key":"value",placeholder:"Kategori",size:"md"},null,8,["modelValue","items"])]),d(" Actions "),s("div",Se,[r(D,{icon:"i-heroicons-magnifying-glass",color:"primary",size:"md",onClick:y},{default:u(()=>[...c[3]||(c[3]=[x(" Cari ",-1)])]),_:1}),r(D,{icon:"i-heroicons-x-mark",color:"neutral",variant:"outline",size:"md",onClick:$},{default:u(()=>[...c[4]||(c[4]=[x(" Reset ",-1)])]),_:1})])])])}}}),$e={class:"space-y-6"},Ae={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Te={class:"text-sm text-slate-500 dark:text-slate-400 mt-1"},Ue={class:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden"},je={key:0,class:"flex items-center justify-between px-4 py-3 bg-violet-50 dark:bg-violet-900/20 border-b border-violet-200 dark:border-violet-800"},Re={class:"text-sm text-violet-700 dark:text-violet-300"},ze={class:"flex items-center gap-2"},Be={key:1,class:"p-8 flex items-center justify-center"},Ve={class:"px-4 py-12 text-center"},Ie={class:"flex flex-col items-center"},De={key:3,class:"flex flex-col sm:flex-row items-center justify-between gap-4 border-t border-slate-200 dark:border-slate-700 px-4 py-3"},He={class:"text-sm text-slate-500 dark:text-slate-400"},Ne={class:"flex items-center gap-4"},Fe={class:"p-6 max-h-[85vh] overflow-y-auto"},Ke={class:"flex items-center gap-4 mb-4"},Me={class:"w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center"},Oe={class:"flex justify-end gap-3"},Le={class:"p-6 max-h-[85vh] overflow-y-auto"},Ee={class:"flex items-center gap-4 mb-4"},qe={class:"w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center"},Xe={class:"text-lg font-semibold text-slate-900 dark:text-white"},Ge={class:"flex justify-end gap-3"},mt=O({layout:me,__name:"index",props:{products:{default:()=>[]},meta:{default:()=>({total:0,perPage:10,currentPage:1,lastPage:1,firstPage:1,firstPageUrl:"",lastPageUrl:"",nextPageUrl:null,previousPageUrl:null,hasNext:!1,hasPrev:!1})},stats:{default:()=>({total:0,active:0,inactive:0,draft:0,outOfStock:0,lowStock:0})},categories:{default:()=>[]},filters:{default:()=>({search:"",category:null,status:"all",condition:"all",minPrice:null,maxPrice:null,sortBy:"createdAt",sortDirection:"desc"})},admin:{default:()=>({id:0,storeName:"Admin",slug:"",status:"active"})}},setup(i){const m=i,n=v(null),k=v("createdAt"),f=v("desc"),t=v({...m.filters}),g=v(m.meta.currentPage),b=v(!1),C=v(!1),y=v(null),$=v(!1),U=v(m.filters.search||"");H(()=>m.filters,a=>{t.value={...a},U.value=a.search||""},{deep:!0}),H(()=>m.meta.currentPage,a=>{g.value=a}),H(g,(a,e)=>{if(a!==e&&a!==m.meta.currentPage){n.value?.tableApi?.resetRowSelection(),window.scrollTo({top:0,behavior:"smooth"}),b.value=!0;const l={page:a,perPage:m.meta.perPage,sortBy:k.value,sortDirection:f.value};t.value.search&&(l.search=t.value.search),t.value.status&&t.value.status!=="all"&&(l.status=t.value.status),t.value.condition&&t.value.condition!=="all"&&(l.condition=t.value.condition),t.value.category&&(l.category=t.value.category),t.value.minPrice&&(l.minPrice=t.value.minPrice),t.value.maxPrice&&(l.maxPrice=t.value.maxPrice),T.get("/admin/products",l,{preserveState:!0,preserveScroll:!1,onFinish:()=>{b.value=!1}})}});const h=de(),j=[{id:"select",header:({table:a})=>o(E,{modelValue:a.getIsAllPageRowsSelected(),indeterminate:a.getIsSomePageRowsSelected(),"onUpdate:modelValue":e=>a.toggleAllPageRowsSelected(!!e)}),cell:({row:a})=>o(E,{modelValue:a.getIsSelected(),"onUpdate:modelValue":e=>a.toggleSelected(!!e)}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:"Produk",cell:({row:a})=>{const e=a.original;return o("div",{class:"flex items-center gap-3"},[o("div",{class:"w-12 h-12 rounded-lg bg-slate-100 dark:bg-slate-700 overflow-hidden shrink-0"},e.primaryImage?o("img",{src:e.primaryImage.url,alt:e.name,class:"w-full h-full object-cover"}):o("div",{class:"w-full h-full flex items-center justify-center"},[o(R,{name:"i-heroicons-photo",class:"w-6 h-6 text-slate-400"})])),o("div",{class:"min-w-0"},[o(K,{href:`/admin/products/${e.id}`,class:"font-medium text-slate-900 dark:text-white hover:text-violet-600 dark:hover:text-violet-400 truncate block max-w-xs"},()=>e.name),o("p",{class:"text-xs text-slate-500 dark:text-slate-400"},[`SKU: ${e.sku}`,e.category?o("span",{class:"ml-2"},`â€¢ ${e.category.name}`):null]),o("div",{class:"flex items-center gap-2 mt-1"},[o(F,{color:X(e.condition).color,variant:"subtle",size:"xs"},()=>X(e.condition).label),e.isFeatured?o(F,{color:"warning",variant:"subtle",size:"xs"},()=>[o(R,{name:"i-heroicons-star",class:"w-3 h-3 mr-0.5"}),"Featured"]):null])])])}},{accessorKey:"price",header:"Harga",cell:({row:a})=>{const e=a.original;return o("div",{},[o("p",{class:"font-medium text-slate-900 dark:text-white"},G(e.discountPrice||e.price)),e.discountPrice?o("p",{class:"text-xs text-slate-500 line-through"},G(e.price)):null])}},{accessorKey:"stock",header:"Stok",cell:({row:a})=>{const e=a.getValue("stock"),l=e===0?"text-red-500":e<=10?"text-amber-500":"text-slate-900 dark:text-white";return o("div",{class:"flex items-center gap-2"},[o("span",{class:`font-medium ${l}`},M(e)),e<=10&&e>0?o(R,{name:"i-heroicons-exclamation-triangle",class:"w-4 h-4 text-amber-500"}):null])}},{accessorKey:"totalSold",header:"Terjual",cell:({row:a})=>o("span",{class:"text-slate-900 dark:text-white"},M(a.getValue("totalSold")))},{accessorKey:"status",header:"Status",cell:({row:a})=>{const e=a.getValue("status"),l=ve(e);return o(F,{color:l.color,variant:"subtle"},()=>l.label)}},{id:"actions",header:()=>o("div",{class:"text-right"},"Aksi"),cell:({row:a})=>{const e=a.original;return o("div",{class:"flex items-center justify-end gap-1"},[o(z,{to:`/admin/products/${e.id}`,icon:"i-heroicons-eye",color:"neutral",variant:"ghost",size:"xs"}),o(z,{to:`/admin/products/${e.id}/edit`,icon:"i-heroicons-pencil",color:"neutral",variant:"ghost",size:"xs"}),o(z,{icon:"i-heroicons-trash",color:"error",variant:"ghost",size:"xs",onClick:()=>Y(e.id)})])},enableSorting:!1}],c=J(()=>(n.value?.tableApi?.getSelectedRowModel().rows||[]).map(e=>e.original.id)),V=(a={})=>{b.value=!0;const e={page:a.page||m.meta.currentPage,perPage:a.perPage||m.meta.perPage,sortBy:k.value,sortDirection:f.value};t.value.search&&(e.search=t.value.search),t.value.status&&t.value.status!=="all"&&(e.status=t.value.status),t.value.condition&&t.value.condition!=="all"&&(e.condition=t.value.condition),t.value.category&&(e.category=t.value.category),t.value.minPrice&&(e.minPrice=t.value.minPrice),t.value.maxPrice&&(e.maxPrice=t.value.maxPrice),T.get("/admin/products",e,{preserveState:!0,preserveScroll:!0,onFinish:()=>{b.value=!1}})},I=a=>{t.value=a},D=()=>{n.value?.tableApi?.resetRowSelection(),V({page:1})},A=()=>{n.value?.tableApi?.resetRowSelection(),k.value="createdAt",f.value="desc",U.value="",V({page:1})},Q=a=>{n.value?.tableApi?.resetRowSelection(),window.scrollTo({top:0,behavior:"smooth"}),b.value=!0;const e={page:1,perPage:a,sortBy:k.value,sortDirection:f.value};t.value.search&&(e.search=t.value.search),t.value.status&&t.value.status!=="all"&&(e.status=t.value.status),t.value.condition&&t.value.condition!=="all"&&(e.condition=t.value.condition),t.value.category&&(e.category=t.value.category),t.value.minPrice&&(e.minPrice=t.value.minPrice),t.value.maxPrice&&(e.maxPrice=t.value.maxPrice),T.get("/admin/products",e,{preserveState:!0,preserveScroll:!1,onFinish:()=>{b.value=!1}})},Y=a=>{y.value=a,C.value=!0},Z=async()=>{if(y.value)try{const e=await(await fetch(`/admin/products/${y.value}`,{method:"DELETE",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}})).json();e.success?(h.success("Berhasil",e.message),T.reload({only:["products","meta","stats"]})):h.error("Gagal",e.message)}catch{h.error("Error","Terjadi kesalahan saat menghapus produk")}finally{C.value=!1,y.value=null}},N=async a=>{const e=c.value;if(e.length!==0){if(a==="delete"){$.value=!0;return}try{const S=await(await fetch("/admin/products/bulk-status",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({productIds:e,status:a})})).json();S.success?(h.success("Berhasil",S.message),n.value?.tableApi?.resetRowSelection(),T.reload({only:["products","meta","stats"]})):h.error("Gagal",S.message)}catch{h.error("Error","Terjadi kesalahan")}}},ee=async()=>{const a=c.value;try{const l=await(await fetch("/admin/products/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({productIds:a})})).json();l.success?(h.success("Berhasil",l.message),n.value?.tableApi?.resetRowSelection(),T.reload({only:["products","meta","stats"]})):h.error("Gagal",l.message)}catch{h.error("Error","Terjadi kesalahan saat menghapus produk")}finally{$.value=!1}};return(a,e)=>{const l=z,S=R,te=ie,ae=re,se=oe,L=le;return _(),P("div",$e,[d(" Page Header "),s("div",Ae,[s("div",null,[e[9]||(e[9]=s("h1",{class:"text-2xl font-bold text-slate-900 dark:text-white"},"Produk",-1)),s("p",Te," Kelola semua produk toko "+w(i.admin.storeName),1)]),r(B(K),{href:"/admin/products/create"},{default:u(()=>[r(l,{icon:"i-heroicons-plus",color:"primary",size:"md"},{default:u(()=>[...e[10]||(e[10]=[x(" Tambah Produk ",-1)])]),_:1})]),_:1})]),d(" Stats Cards "),r(B(ke),{stats:i.stats},null,8,["stats"]),d(" Filters "),r(B(Ce),{filters:t.value,categories:i.categories,"onUpdate:filters":I,onSearch:D,onReset:A},null,8,["filters","categories"]),d(" Products Table Card "),s("div",Ue,[d(" Bulk Actions Bar "),c.value.length>0?(_(),P("div",je,[s("span",Re,w(c.value.length)+" produk dipilih ",1),s("div",ze,[r(l,{size:"sm",color:"success",variant:"soft",icon:"i-heroicons-check-circle",onClick:e[0]||(e[0]=p=>N("active"))},{default:u(()=>[...e[11]||(e[11]=[x(" Aktifkan ",-1)])]),_:1}),r(l,{size:"sm",color:"warning",variant:"soft",icon:"i-heroicons-pause-circle",onClick:e[1]||(e[1]=p=>N("inactive"))},{default:u(()=>[...e[12]||(e[12]=[x(" Nonaktifkan ",-1)])]),_:1}),r(l,{size:"sm",color:"error",variant:"soft",icon:"i-heroicons-trash",onClick:e[2]||(e[2]=p=>N("delete"))},{default:u(()=>[...e[13]||(e[13]=[x(" Hapus ",-1)])]),_:1})])])):d("v-if",!0),d(" Loading Overlay "),b.value?(_(),P("div",Be,[r(S,{name:"i-heroicons-arrow-path",class:"w-8 h-8 text-violet-500 animate-spin"})])):(_(),P(W,{key:2},[d(" Table "),r(te,{ref_key:"table",ref:n,data:i.products,columns:j,class:"w-full"},{empty:u(()=>[s("div",Ve,[s("div",Ie,[r(S,{name:"i-heroicons-cube",class:"w-12 h-12 text-slate-300 dark:text-slate-600 mb-4"}),e[15]||(e[15]=s("p",{class:"text-slate-500 dark:text-slate-400 mb-4"},"Belum ada produk",-1)),r(B(K),{href:"/admin/products/create"},{default:u(()=>[r(l,{icon:"i-heroicons-plus",color:"primary"},{default:u(()=>[...e[14]||(e[14]=[x(" Tambah Produk ",-1)])]),_:1})]),_:1})])])]),_:1},8,["data"])],2112)),d(" Server-Side Pagination "),i.meta.total>0?(_(),P("div",De,[s("div",He," Menampilkan "+w((i.meta.currentPage-1)*i.meta.perPage+1)+" - "+w(Math.min(i.meta.currentPage*i.meta.perPage,i.meta.total))+" dari "+w(i.meta.total)+" produk ",1),s("div",Ne,[r(ae,{"model-value":i.meta.perPage,items:[{label:"10",value:10},{label:"20",value:20},{label:"50",value:50},{label:"100",value:100}],"value-key":"value","onUpdate:modelValue":e[3]||(e[3]=p=>Q(Number(p))),size:"sm",class:"w-20"},null,8,["model-value"]),r(se,{page:g.value,"onUpdate:page":e[4]||(e[4]=p=>g.value=p),total:i.meta.total,"items-per-page":i.meta.perPage,"sibling-count":1,"show-edges":"",size:"sm"},null,8,["page","total","items-per-page"])])])):d("v-if",!0)]),d(" Delete Confirmation Modal "),r(L,{open:C.value,"onUpdate:open":e[6]||(e[6]=p=>C.value=p),title:"Hapus Produk",description:"Apakah Anda yakin ingin menghapus produk ini?",ui:{overlay:"z-[100]",content:"z-[100]"}},{content:u(()=>[s("div",Fe,[s("div",Ke,[s("div",Me,[r(S,{name:"i-heroicons-trash",class:"w-6 h-6 text-red-500"})]),e[16]||(e[16]=s("div",null,[s("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white"},"Hapus Produk"),s("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"Apakah Anda yakin ingin menghapus produk ini?")],-1))]),e[19]||(e[19]=s("p",{class:"text-sm text-slate-600 dark:text-slate-400 mb-6"}," Tindakan ini tidak dapat dibatalkan. Produk akan dihapus secara permanen. ",-1)),s("div",Oe,[r(l,{color:"neutral",variant:"outline",onClick:e[5]||(e[5]=p=>C.value=!1)},{default:u(()=>[...e[17]||(e[17]=[x(" Batal ",-1)])]),_:1}),r(l,{color:"error",onClick:Z},{default:u(()=>[...e[18]||(e[18]=[x(" Hapus ",-1)])]),_:1})])])]),_:1},8,["open"]),d(" Bulk Delete Confirmation Modal "),r(L,{open:$.value,"onUpdate:open":e[8]||(e[8]=p=>$.value=p),title:"Hapus Produk Terpilih",description:"Apakah Anda yakin ingin menghapus produk-produk terpilih?",ui:{overlay:"z-[100]",content:"z-[100]"}},{content:u(()=>[s("div",Le,[s("div",Ee,[s("div",qe,[r(S,{name:"i-heroicons-trash",class:"w-6 h-6 text-red-500"})]),s("div",null,[s("h3",Xe," Hapus "+w(c.value.length)+" Produk ",1),e[20]||(e[20]=s("p",{class:"text-sm text-slate-500 dark:text-slate-400"}," Apakah Anda yakin ingin menghapus produk-produk ini? ",-1))])]),e[22]||(e[22]=s("p",{class:"text-sm text-slate-600 dark:text-slate-400 mb-6"}," Tindakan ini tidak dapat dibatalkan. Semua produk yang dipilih akan dihapus secara permanen. ",-1)),s("div",Ge,[r(l,{color:"neutral",variant:"outline",onClick:e[7]||(e[7]=p=>$.value=!1)},{default:u(()=>[...e[21]||(e[21]=[x(" Batal ",-1)])]),_:1}),r(l,{color:"error",onClick:ee},{default:u(()=>[x(" Hapus "+w(c.value.length)+" Produk ",1)]),_:1})])])]),_:1},8,["open"])])}}});export{mt as default};
