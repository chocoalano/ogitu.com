import{h as u}from"./app-CyjtdGoI.js";function g(){const e=u(!1),s=u(null),l=u(null),c=()=>typeof globalThis.window<"u"&&globalThis.window.snap!==void 0,t=(r,n)=>new Promise(o=>{if(!c()){const a="Midtrans Snap belum dimuat. Silakan refresh halaman.";l.value=a,o({success:!1,error:a});return}e.value=!0,l.value=null,s.value=null,globalThis.window.snap.pay(r,{onSuccess:a=>{console.log("Payment success:",a),s.value=a,e.value=!1,n?.onSuccess?.(a),o({success:!0,result:a})},onPending:a=>{console.log("Payment pending:",a),s.value=a,e.value=!1,n?.onPending?.(a),o({success:!0,result:a})},onError:a=>{console.error("Payment error:",a),s.value=a,l.value=a.status_message||"Pembayaran gagal",e.value=!1,n?.onError?.(a),o({success:!1,result:a,error:l.value??void 0})},onClose:()=>{console.log("Payment popup closed"),e.value=!1,n?.onClose?.(),s.value||o({success:!1,error:"Pembayaran dibatalkan"})}})});return{isPaymentOpen:e,paymentResult:s,paymentError:l,isSnapLoaded:c,openSnapPopup:t,payWithSnap:async(r,n)=>await t(r,{onSuccess:async a=>{console.log("Midtrans success result:",a),await n?.onSuccess?.(a)},onPending:async a=>{console.log("Midtrans pending result:",a),await n?.onPending?.(a)},onError:a=>{n?.onError?.(a.status_message||"Pembayaran gagal")},onClose:()=>{n?.onClose?.()}})}}export{g as u};
