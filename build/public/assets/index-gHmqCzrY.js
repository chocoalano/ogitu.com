import{_ as A,a as D}from"./Button-CI_-soaG.js";import{h as k,l as B,d as I,a as P,b as n,f as r,t as R,o as C,Q as S,R as M,j as h,L as j,w as v,k as w,I as z,F as K,u as i,p as f,m as T,e as O,y as H,S as F}from"./app-CyjtdGoI.js";import{A as E}from"./admin-BzR6vrex.js";import{g as q,_ as G}from"./ColorModeButton-Bf7Nr8w3.js";import{_ as Q}from"./Select-D6kv-Jzs.js";import{_ as J}from"./Pagination-97jdZAo5.js";import{_ as W,g as X}from"./Table-C6nABs7j.js";import{_ as Y}from"./DropdownMenu-DxuVXSbh.js";import{_ as Z}from"./Badge-DfumusWV.js";import{_ as ee}from"./Modal-Bgd8PL5Y.js";import"./Tooltip-BrTR-Vq7.js";import"./useFormControl-D_pV87FU.js";import"./index-v4g8wp86.js";function te(t){const u=q(),d=k(!1),o=k(t.initialFilters.search||""),c=k(t.initialFilters.role||"all"),m=k(!1),p=k(null),s=k(""),a=k({pageIndex:t.initialData.meta.currentPage-1,pageSize:t.initialData.meta.perPage}),e=[{label:"Semua Role",value:"all"},{label:"Admin",value:"admin"},{label:"Super Admin",value:"superadmin"}],g=()=>{d.value=!0;const l={page:a.value.pageIndex+1,perPage:a.value.pageSize};o.value&&(l.search=o.value),c.value&&c.value!=="all"&&(l.role=c.value),B.get("/admin/users",l,{preserveState:!0,preserveScroll:!0,onFinish:()=>{d.value=!1}})};return{isLoading:d,globalFilter:o,selectedRole:c,pagination:a,deleteModalOpen:m,deleteTargetName:s,roleOptions:e,fetchData:g,handleSearch:()=>{a.value.pageIndex=0,g()},handleRoleChange:()=>{a.value.pageIndex=0,g()},handlePageChange:l=>{a.value.pageIndex=l-1,g()},clearFilters:()=>{o.value="",c.value="all",a.value.pageIndex=0,g()},openDeleteModal:l=>{p.value=l.id,s.value=l.fullName||l.email,m.value=!0},confirmDelete:()=>{p.value&&B.delete(`/admin/users/${p.value}`,{onSuccess:()=>{u.success("Pengguna berhasil dihapus"),m.value=!1,p.value=null},onError:()=>{u.error("Gagal menghapus pengguna")}})},syncPagination:l=>{a.value.pageIndex=l-1}}}const ae={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},le={class:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-4"},ne={class:"flex items-center gap-3"},oe={class:"w-10 h-10 rounded-lg bg-violet-500/10 flex items-center justify-center"},se={class:"text-xl font-bold text-slate-900 dark:text-white"},ie=I({__name:"UserStatsCard",props:{total:{}},setup(t){return(u,d)=>{const o=A;return C(),P("div",ae,[n("div",le,[n("div",ne,[n("div",oe,[r(o,{name:"i-heroicons-users",class:"w-5 h-5 text-violet-500"})]),n("div",null,[d[0]||(d[0]=n("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"Total Pengguna",-1)),n("p",se,R(t.total),1)])])])])}}}),re={class:"flex flex-col sm:flex-row gap-4 px-4 py-3.5 border-b border-slate-200 dark:border-slate-800"},de={class:"flex-1"},ce={class:"w-full sm:w-48"},ue={class:"flex gap-2"},me=I({__name:"UserFiltersBar",props:S({roleOptions:{}},{globalFilter:{default:""},globalFilterModifiers:{},selectedRole:{default:"all"},selectedRoleModifiers:{}}),emits:S(["search","roleChange","clear"],["update:globalFilter","update:selectedRole"]),setup(t,{emit:u}){const d=M(t,"globalFilter"),o=M(t,"selectedRole"),c=u,m=()=>{c("search")},p=()=>{c("roleChange")},s=()=>{c("clear")};return(a,e)=>{const g=G,x=Q,_=D;return C(),P("div",re,[h(" Search "),n("div",de,[r(g,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=y=>d.value=y),placeholder:"Cari nama atau email...",icon:"i-heroicons-magnifying-glass",class:"max-w-sm",onKeyup:j(m,["enter"])},null,8,["modelValue"])]),h(" Role Filter "),n("div",ce,[r(x,{modelValue:o.value,"onUpdate:modelValue":e[1]||(e[1]=y=>o.value=y),items:t.roleOptions,placeholder:"Filter Role",onChange:p},null,8,["modelValue","items"])]),h(" Actions "),n("div",ue,[r(_,{icon:"i-heroicons-magnifying-glass",color:"primary",onClick:m},{default:v(()=>[...e[2]||(e[2]=[w(" Cari ",-1)])]),_:1}),r(_,{icon:"i-heroicons-x-mark",color:"neutral",variant:"outline",onClick:s},{default:v(()=>[...e[3]||(e[3]=[w(" Reset ",-1)])]),_:1})])])}}}),ge={class:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 overflow-hidden"},pe={key:0,class:"p-8 flex items-center justify-center"},fe={class:"px-4 py-12 text-center"},he={class:"flex flex-col items-center"},ve={key:2,class:"flex items-center justify-between px-4 py-3 border-t border-slate-200 dark:border-slate-800"},xe={class:"text-sm text-slate-500 dark:text-slate-400"},be=I({__name:"UserTable",props:S({users:{},meta:{},isLoading:{type:Boolean}},{pagination:{default:()=>({pageIndex:0,pageSize:10})},paginationModifiers:{},globalFilter:{default:""},globalFilterModifiers:{}}),emits:S(["delete","pageChange"],["update:pagination","update:globalFilter"]),setup(t,{emit:u}){const d=M(t,"pagination"),o=M(t,"globalFilter"),c=u,m=k(null),p=[{accessorKey:"fullName",header:"Nama",cell:({row:a})=>{const e=a.original;return f("div",{class:"flex items-center gap-3"},[f("div",{class:"w-10 h-10 rounded-full bg-violet-500/10 flex items-center justify-center shrink-0"},f(A,{name:"i-heroicons-user",class:"w-5 h-5 text-violet-500"})),f("div",{class:"min-w-0"},[f(T,{href:`/admin/users/${e.id}`,class:"font-medium text-slate-900 dark:text-white hover:text-violet-600 dark:hover:text-violet-400"},()=>e.fullName||"-"),f("p",{class:"text-xs text-slate-500 dark:text-slate-400"},e.email)])])}},{accessorKey:"role",header:"Role",cell:({row:a})=>{const e=a.original.role;return f(Z,{color:e==="superadmin"?"primary":"neutral",variant:"subtle"},()=>e==="superadmin"?"Super Admin":"Admin")}},{accessorKey:"createdAt",header:"Tanggal Dibuat",cell:({row:a})=>{const e=new Date(a.original.createdAt).toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric"});return f("span",{class:"text-slate-600 dark:text-slate-400"},e)}},{id:"actions",header:()=>f("div",{class:"text-right"},"Aksi"),cell:({row:a})=>{const e=a.original,g=Y,x=D;return f("div",{class:"text-right"},f(g,{content:{align:"end"},items:[[{label:"Lihat Detail",icon:"i-heroicons-eye",onSelect:()=>B.visit(`/admin/users/${e.id}`)},{label:"Edit",icon:"i-heroicons-pencil-square",onSelect:()=>B.visit(`/admin/users/${e.id}/edit`)}],[{label:"Hapus",icon:"i-heroicons-trash",color:"error",onSelect:()=>c("delete",e)}]],"aria-label":"Actions dropdown"},()=>f(x,{icon:"i-heroicons-ellipsis-vertical",color:"neutral",variant:"ghost",size:"xs"})))},enableSorting:!1}],s=a=>{d.value.pageIndex=a-1,c("pageChange",a)};return(a,e)=>{const g=A,x=D,_=W,y=J;return C(),P("div",ge,[z(a.$slots,"filters"),h(" Loading Overlay "),t.isLoading?(C(),P("div",pe,[r(g,{name:"i-heroicons-arrow-path",class:"w-8 h-8 text-violet-500 animate-spin"})])):(C(),P(K,{key:1},[h(" Table "),r(_,{ref_key:"table",ref:m,pagination:d.value,"onUpdate:pagination":e[0]||(e[0]=$=>d.value=$),"global-filter":o.value,"onUpdate:globalFilter":e[1]||(e[1]=$=>o.value=$),data:t.users,columns:p,"pagination-options":{getPaginationRowModel:i(X)()},class:"flex-1"},{empty:v(()=>[n("div",fe,[n("div",he,[r(g,{name:"i-heroicons-users",class:"w-12 h-12 text-slate-300 dark:text-slate-600 mb-4"}),e[3]||(e[3]=n("p",{class:"text-slate-500 dark:text-slate-400 mb-4"},"Belum ada pengguna",-1)),r(i(T),{href:"/admin/users/create"},{default:v(()=>[r(x,{icon:"i-heroicons-plus",color:"primary"},{default:v(()=>[...e[2]||(e[2]=[w(" Tambah Pengguna ",-1)])]),_:1})]),_:1})])])]),_:1},8,["pagination","global-filter","data","pagination-options"])],2112)),h(" Pagination "),t.meta.lastPage>1?(C(),P("div",ve,[n("p",xe," Menampilkan "+R((t.meta.currentPage-1)*t.meta.perPage+1)+" - "+R(Math.min(t.meta.currentPage*t.meta.perPage,t.meta.total))+" dari "+R(t.meta.total)+" pengguna ",1),r(y,{page:(m.value?.tableApi?.getState().pagination.pageIndex||0)+1,"items-per-page":m.value?.tableApi?.getState().pagination.pageSize||t.meta.perPage,total:t.meta.total,"onUpdate:page":s},null,8,["page","items-per-page","total"])])):h("v-if",!0)])}}}),_e={class:"p-6 max-h-[85vh] overflow-y-auto"},ye={class:"flex items-center gap-4 mb-4"},ke={class:"w-12 h-12 rounded-full bg-red-100 dark:bg-red-500/20 flex items-center justify-center"},Ce={class:"text-slate-500 dark:text-slate-400"},we={class:"flex justify-end gap-3"},Pe=I({__name:"UserDeleteModal",props:S({userName:{}},{open:{type:Boolean,default:!1},openModifiers:{}}),emits:S(["confirm"],["update:open"]),setup(t,{emit:u}){const d=M(t,"open"),o=u,c=()=>{o("confirm")},m=()=>{d.value=!1};return(p,s)=>{const a=A,e=D,g=ee;return C(),O(g,{open:d.value,"onUpdate:open":s[0]||(s[0]=x=>d.value=x),ui:{overlay:"z-[100]",content:"z-[100]"}},{content:v(()=>[n("div",_e,[n("div",ye,[n("div",ke,[r(a,{name:"i-heroicons-exclamation-triangle",class:"w-6 h-6 text-red-500"})]),n("div",null,[s[3]||(s[3]=n("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white"},"Hapus Pengguna",-1)),n("p",Ce,[s[1]||(s[1]=w(" Apakah Anda yakin ingin menghapus ",-1)),n("strong",null,R(t.userName),1),s[2]||(s[2]=w("? ",-1))])])]),n("div",we,[r(e,{color:"neutral",variant:"outline",onClick:m},{default:v(()=>[...s[4]||(s[4]=[w(" Batal ",-1)])]),_:1}),r(e,{color:"error",onClick:c},{default:v(()=>[...s[5]||(s[5]=[w(" Hapus ",-1)])]),_:1})])])]),_:1},8,["open"])}}}),$e={class:"space-y-6"},Se={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},ze=I({layout:E,__name:"index",props:{users:{default:()=>({data:[],meta:{total:0,perPage:10,currentPage:1,lastPage:1,firstPage:1}})},filters:{default:()=>({search:"",role:""})}},setup(t){const u=t,{isLoading:d,globalFilter:o,selectedRole:c,pagination:m,deleteModalOpen:p,deleteTargetName:s,roleOptions:a,handleSearch:e,handleRoleChange:g,handlePageChange:x,clearFilters:_,openDeleteModal:y,confirmDelete:$,syncPagination:N}=te({initialData:u.users,initialFilters:u.filters});H(()=>u.users.meta.currentPage,U=>{N(U)});const V=U=>{y(U)};return(U,l)=>{const L=D;return C(),P("div",$e,[h(" Page Header "),n("div",Se,[l[6]||(l[6]=n("div",null,[n("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Kelola Pengguna"),n("p",{class:"text-gray-500 dark:text-gray-400"}," Kelola pengguna admin dan super admin ")],-1)),r(i(T),{href:"/admin/users/create"},{default:v(()=>[r(L,{icon:"i-heroicons-plus",color:"primary"},{default:v(()=>[...l[5]||(l[5]=[w(" Tambah Pengguna ",-1)])]),_:1})]),_:1})]),h(" Stats "),r(i(ie),{total:u.users.meta.total},null,8,["total"]),h(" Table Card "),r(i(be),{pagination:i(m),"onUpdate:pagination":l[2]||(l[2]=b=>F(m)?m.value=b:null),"global-filter":i(o),"onUpdate:globalFilter":l[3]||(l[3]=b=>F(o)?o.value=b:null),users:u.users.data,meta:u.users.meta,"is-loading":i(d),onDelete:V,onPageChange:i(x)},{filters:v(()=>[r(i(me),{"global-filter":i(o),"onUpdate:globalFilter":l[0]||(l[0]=b=>F(o)?o.value=b:null),"selected-role":i(c),"onUpdate:selectedRole":l[1]||(l[1]=b=>F(c)?c.value=b:null),"role-options":i(a),onSearch:i(e),onRoleChange:i(g),onClear:i(_)},null,8,["global-filter","selected-role","role-options","onSearch","onRoleChange","onClear"])]),_:1},8,["pagination","global-filter","users","meta","is-loading","onPageChange"]),h(" Delete Modal "),r(i(Pe),{open:i(p),"onUpdate:open":l[4]||(l[4]=b=>F(p)?p.value=b:null),"user-name":i(s),onConfirm:i($)},null,8,["open","user-name","onConfirm"])])}}});export{ze as default};
