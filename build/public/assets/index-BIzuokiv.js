import{_ as w}from"./Card-BjL1m_sW.js";import{_ as U,a as I}from"./Button-CI_-soaG.js";import{d as C,c as y,a as f,b as t,F as $,r as R,e as h,w as m,t as g,n as v,f as i,o as d,u as b,g as L,h as T,i as N,j as _,k as W,l as V}from"./app-CyjtdGoI.js";import{f as c,a as P}from"./analytics-Dycz2OpM.js";import{C as A,a as j,L as M,B as O,p as E,b as D,c as B,d as K,A as z,P as H,_ as Z,e as q}from"./PeriodSelector.vue_vue_type_script_setup_true_lang-K8mRvDWh.js";import{A as G}from"./admin-BzR6vrex.js";import"./ColorModeButton-Bf7Nr8w3.js";import"./FormField-qFQ_28ZO.js";import"./Label-yeknIWsP.js";import"./SelectMenu-DKAhKU-v.js";import"./useFormControl-D_pV87FU.js";import"./VisuallyHiddenInput-BGOu5NlX.js";import"./index-v4g8wp86.js";import"./Tooltip-BrTR-Vq7.js";const J={class:"space-y-4"},Q={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},X={class:"flex items-start justify-between"},Y={class:"text-sm text-gray-500 dark:text-gray-400"},ee={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},te={class:"flex items-center gap-3"},ae={class:"text-sm text-gray-500 dark:text-gray-400"},oe={class:"font-semibold"},re=C({__name:"FinanceStatsCards",props:{summary:{}},setup(s){const o=s,n=y(()=>[{title:"Total Pendapatan",value:c(o.summary.totalRevenue),icon:"i-heroicons-banknotes",color:"success"},{title:"Pendapatan Bersih",value:c(o.summary.netRevenue),icon:"i-heroicons-currency-dollar",color:"primary"},{title:"Total Diskon",value:c(o.summary.totalDiscount),icon:"i-heroicons-tag",color:"warning",negative:!0},{title:"Total Ongkir",value:c(o.summary.totalShippingCost),icon:"i-heroicons-truck",color:"info"}]),l=y(()=>[{title:"Total Pesanan",value:P(o.summary.totalOrders),icon:"i-heroicons-shopping-cart"},{title:"Rata-rata Pesanan",value:c(o.summary.averageOrderValue),icon:"i-heroicons-calculator"},{title:"Total Admin Fee",value:c(o.summary.totalAdminFee),icon:"i-heroicons-receipt-percent"}]);return(r,u)=>{const p=U,a=w;return d(),f("div",J,[t("div",Q,[(d(!0),f($,null,R(n.value,e=>(d(),h(a,{key:e.title},{default:m(()=>[t("div",X,[t("div",null,[t("p",Y,g(e.title),1),t("p",{class:v(["mt-1 text-2xl font-bold",{"text-red-500":e.negative}])},g(e.negative?"-":"")+g(e.value),3)]),t("div",{class:v(["p-3 rounded-lg",{"bg-green-100 dark:bg-green-900":e.color==="success","bg-primary-100 dark:bg-primary-900":e.color==="primary","bg-yellow-100 dark:bg-yellow-900":e.color==="warning","bg-blue-100 dark:bg-blue-900":e.color==="info"}])},[i(p,{name:e.icon,class:v(["w-6 h-6",{"text-green-500":e.color==="success","text-primary-500":e.color==="primary","text-yellow-500":e.color==="warning","text-blue-500":e.color==="info"}])},null,8,["name","class"])],2)])]),_:2},1024))),128))]),t("div",ee,[(d(!0),f($,null,R(l.value,e=>(d(),h(a,{key:e.title,class:"bg-gray-50 dark:bg-gray-800"},{default:m(()=>[t("div",te,[i(p,{name:e.icon,class:"w-5 h-5 text-gray-500"},null,8,["name"]),t("div",null,[t("p",ae,g(e.title),1),t("p",oe,g(e.value),1)])])]),_:2},1024))),128))])])}}}),se={class:"flex items-center justify-between"},ne={class:"text-right"},le={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},ie={class:"flex items-center gap-2 mb-2"},ce={class:"text-sm text-gray-500"},de={class:"text-lg font-semibold"},ue=C({__name:"WalletSummaryCard",props:{summary:{}},setup(s){const o=s,n=y(()=>[{title:"Top Up",value:c(o.summary.topupTotal),icon:"i-heroicons-arrow-down-circle",color:"text-green-500",bgColor:"bg-green-100 dark:bg-green-900"},{title:"Penarikan",value:c(o.summary.withdrawalTotal),icon:"i-heroicons-arrow-up-circle",color:"text-red-500",bgColor:"bg-red-100 dark:bg-red-900"},{title:"Komisi Affiliate",value:c(o.summary.commissionTotal),icon:"i-heroicons-users",color:"text-purple-500",bgColor:"bg-purple-100 dark:bg-purple-900"},{title:"Refund",value:c(o.summary.refundTotal),icon:"i-heroicons-arrow-uturn-left",color:"text-orange-500",bgColor:"bg-orange-100 dark:bg-orange-900"}]),l=y(()=>o.summary.netWalletFlow>0?"text-green-500":o.summary.netWalletFlow<0?"text-red-500":"text-gray-500");return(r,u)=>{const p=U,a=w;return d(),h(a,null,{header:m(()=>[t("div",se,[u[1]||(u[1]=t("h3",{class:"text-lg font-semibold"},"Ringkasan Wallet",-1)),t("div",ne,[u[0]||(u[0]=t("p",{class:"text-sm text-gray-500"},"Net Flow",-1)),t("p",{class:v(["text-xl font-bold",l.value])},g(b(c)(s.summary.netWalletFlow)),3)])])]),default:m(()=>[t("div",le,[(d(!0),f($,null,R(n.value,e=>(d(),f("div",{key:e.title,class:"p-4 rounded-lg bg-gray-50 dark:bg-gray-800"},[t("div",ie,[t("div",{class:v(["p-2 rounded-lg",e.bgColor])},[i(p,{name:e.icon,class:v(["w-5 h-5",e.color])},null,8,["name","class"])],2),t("span",ce,g(e.title),1)]),t("p",de,g(e.value),1)]))),128))])]),_:1})}}}),me={class:"h-80"},pe=C({__name:"MonthlyRevenueChart",props:{data:{}},setup(s){A.register(j,M,O,E,D,B);const o=s,n=y(()=>({labels:o.data.map(r=>r.month),datasets:[{label:"Pendapatan",data:o.data.map(r=>r.revenue),backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"rgb(59, 130, 246)",borderWidth:1,borderRadius:4}]})),l={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(r){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(r.parsed.y)}}}},scales:{y:{beginAtZero:!0,ticks:{callback:function(r){return"Rp "+new Intl.NumberFormat("id-ID").format(r)}}}}};return(r,u)=>{const p=w;return d(),h(p,null,{header:m(()=>[...u[0]||(u[0]=[t("h3",{class:"text-lg font-semibold"},"Pendapatan Bulanan",-1)])]),default:m(()=>[t("div",me,[i(b(K),{data:n.value,options:l},null,8,["data"])])]),_:1})}}}),ge={class:"flex items-center justify-between"},ye={class:"text-right text-sm text-gray-500"},fe={class:"h-64"},_e={key:1,class:"flex items-center justify-center h-full text-gray-500"},ve={class:"text-center"},be={class:"text-lg font-bold text-green-600"},he=C({__name:"PaymentMethodsChart",props:{data:{}},setup(s){A.register(z,D,B);const o=s,n=["rgb(59, 130, 246)","rgb(16, 185, 129)","rgb(251, 191, 36)","rgb(139, 92, 246)","rgb(236, 72, 153)","rgb(249, 115, 22)"],l=y(()=>({labels:o.data.map(a=>a.method||"Lainnya"),datasets:[{data:o.data.map(a=>a.total),backgroundColor:o.data.map((a,e)=>n[e%n.length]),borderWidth:0}]})),r={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"},tooltip:{callbacks:{label:function(a){const e=o.data[a.dataIndex],x=(a.parsed/a.dataset.data.reduce((F,S)=>F+S,0)*100).toFixed(1);return[`${a.label}: ${c(a.parsed)}`,`${e.count} transaksi (${x}%)`]}}}}},u=y(()=>o.data.reduce((a,e)=>a+e.count,0)),p=y(()=>o.data.reduce((a,e)=>a+e.total,0));return(a,e)=>{const x=w;return d(),h(x,null,L({header:m(()=>[t("div",ge,[e[0]||(e[0]=t("h3",{class:"text-lg font-semibold"},"Metode Pembayaran",-1)),t("div",ye,g(b(P)(u.value))+" transaksi ",1)])]),default:m(()=>[t("div",fe,[s.data.length>0?(d(),h(b(H),{key:0,data:l.value,options:r},null,8,["data"])):(d(),f("div",_e," Tidak ada data pembayaran "))])]),_:2},[s.data.length>0?{name:"footer",fn:m(()=>[t("div",ve,[e[1]||(e[1]=t("p",{class:"text-sm text-gray-500"},"Total",-1)),t("p",be,g(b(c)(p.value)),1)])]),key:"0"}:void 0]),1024)}}}),xe={class:"space-y-6"},ke={class:"flex items-center justify-between"},we={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},We=C({layout:G,__name:"index",props:{summary:{},walletSummary:{},dailyRevenue:{},monthlyData:{},paymentMethods:{},filters:{}},setup(s){const o=s,n=T(o.filters.period||"30days"),l=T(o.filters.dateFrom||""),r=T(o.filters.dateTo||""),u=()=>{const a={period:n.value};n.value==="custom"&&(l.value&&(a.dateFrom=l.value),r.value&&(a.dateTo=r.value)),V.get("/admin/analytics/finance",a,{preserveState:!0,preserveScroll:!0})},p=()=>{const a=new URLSearchParams({period:n.value,export:"csv"});n.value==="custom"&&(l.value&&a.append("dateFrom",l.value),r.value&&a.append("dateTo",r.value)),window.open(`/admin/analytics/finance?${a.toString()}`,"_blank")};return(a,e)=>{const x=U,F=I,S=w;return d(),f($,null,[i(b(N),{title:"Laporan Keuangan"}),t("div",xe,[_(" Header "),t("div",ke,[e[4]||(e[4]=t("div",null,[t("h1",{class:"text-2xl font-bold"},"Laporan Keuangan"),t("p",{class:"text-gray-500"},"Ringkasan keuangan dan pembayaran")],-1)),i(F,{color:"gray",onClick:p},{default:m(()=>[i(x,{name:"i-heroicons-arrow-down-tray",class:"mr-2"}),e[3]||(e[3]=W(" Export CSV ",-1))]),_:1})]),_(" Period Selector "),i(S,null,{default:m(()=>[i(Z,{period:n.value,"onUpdate:period":e[0]||(e[0]=k=>n.value=k),"date-from":l.value,"onUpdate:dateFrom":e[1]||(e[1]=k=>l.value=k),"date-to":r.value,"onUpdate:dateTo":e[2]||(e[2]=k=>r.value=k),onApply:u},null,8,["period","date-from","date-to"])]),_:1}),_(" Finance Stats "),i(re,{summary:s.summary},null,8,["summary"]),_(" Wallet Summary "),i(ue,{summary:s.walletSummary},null,8,["summary"]),_(" Charts Row "),t("div",we,[i(pe,{data:s.monthlyData},null,8,["data"]),i(he,{data:s.paymentMethods},null,8,["data"])]),_(" Daily Revenue Chart using Sales Chart "),i(q,{data:s.dailyRevenue},null,8,["data"])])],64)}}});export{We as default};
