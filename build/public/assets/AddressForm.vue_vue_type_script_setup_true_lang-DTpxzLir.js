import{a as B}from"./Button-CI_-soaG.js";import{_ as F}from"./SelectMenu-DKAhKU-v.js";import{_ as T}from"./Textarea-CZyY9J1c.js";import{_ as O}from"./Switch-sBWkdoVy.js";import{_ as P}from"./FormField-qFQ_28ZO.js";import{_ as S}from"./ColorModeButton-Bf7Nr8w3.js";import{d as M,h as m,q as G,c as V,y as h,a as R,D as z,j as f,b as v,f as t,w as u,o as E}from"./app-CyjtdGoI.js";const J={class:"grid gap-4 md:grid-cols-2"},W={class:"flex items-center gap-2 h-10"},H={class:"grid gap-4 md:grid-cols-2"},Q={class:"grid gap-4 md:grid-cols-3"},X={class:"grid gap-4 md:grid-cols-3"},Y={class:"flex justify-end gap-3 pt-4 border-t border-gray-200 dark:border-gray-700"},se=M({__name:"AddressForm",props:{provinces:{},initialCities:{},initialDistricts:{},initialData:{},processing:{type:Boolean},submitLabel:{}},emits:["submit","cancel"],setup(r,{expose:_,emit:x}){const o=r,D=x,e=m({name:o.initialData?.name||"",contactName:o.initialData?.contactName||"",phone:o.initialData?.phone||"",addressLine1:o.initialData?.addressLine1||"",addressLine2:o.initialData?.addressLine2||"",provinceId:o.initialData?.provinceId||"",provinceName:o.initialData?.provinceName||"",cityId:o.initialData?.cityId||"",cityName:o.initialData?.cityName||"",districtId:o.initialData?.districtId||"",districtName:o.initialData?.districtName||"",postalCode:o.initialData?.postalCode||"",isDefault:o.initialData?.isDefault||!1}),p=m(o.initialCities||[]),c=m(o.initialDistricts||[]),b=m(!1),g=m(!1),y=m(!o.initialData);G(()=>{o.initialData&&setTimeout(()=>{y.value=!0},100)});const k=V(()=>o.provinces.map(l=>({label:l.province,value:l.province_id}))),L=V(()=>p.value.map(l=>({label:`${l.type} ${l.city_name}`,value:l.city_id}))),C=V(()=>c.value.map(l=>({label:l.district_name,value:l.district_id}))),U=async l=>{try{return(await(await fetch(`/admin/api/locations/cities/${l}`)).json()).data||[]}catch(a){return console.error("Failed to load cities:",a),[]}},j=async l=>{try{return(await(await fetch(`/admin/api/locations/districts/${l}`)).json()).data||[]}catch(a){return console.error("Failed to load districts:",a),[]}};h(()=>e.value.provinceId,async(l,a)=>{if(!y.value)return;if(!l){p.value=[],e.value.cityId="",e.value.cityName="",e.value.districtId="",e.value.districtName="",c.value=[];return}const d=o.provinces.find(n=>n.province_id===l);d&&(e.value.provinceName=d.province),a!==void 0&&l!==a&&(b.value=!0,p.value=await U(l),b.value=!1,e.value.cityId="",e.value.cityName="",e.value.districtId="",e.value.districtName="",c.value=[])}),h(()=>e.value.cityId,async(l,a)=>{if(!y.value)return;if(!l){c.value=[],e.value.districtId="",e.value.districtName="";return}const d=p.value.find(n=>n.city_id===l);d&&(e.value.cityName=d.city_name,(!e.value.postalCode||a!==void 0)&&(e.value.postalCode=d.postal_code||"")),a!==void 0&&l!==a&&(g.value=!0,c.value=await j(l),g.value=!1,e.value.districtId="",e.value.districtName="")}),h(()=>e.value.districtId,l=>{if(!y.value)return;if(!l){e.value.districtName="";return}const a=c.value.find(d=>d.district_id===l);a&&(e.value.districtName=a.district_name)});const i=m({}),I=()=>(i.value={},e.value.name.trim()||(i.value.name="Nama alamat wajib diisi"),e.value.contactName.trim()||(i.value.contactName="Nama kontak wajib diisi"),e.value.phone.trim()?/^0[0-9]{9,13}$/.test(e.value.phone.replace(/\D/g,""))||(i.value.phone="Format nomor telepon tidak valid"):i.value.phone="Nomor telepon wajib diisi",e.value.addressLine1.trim()||(i.value.addressLine1="Alamat lengkap wajib diisi"),e.value.provinceId||(i.value.provinceId="Provinsi wajib dipilih"),e.value.cityId||(i.value.cityId="Kota wajib dipilih"),e.value.districtId||(i.value.districtId="Kecamatan wajib dipilih"),e.value.postalCode.trim()||(i.value.postalCode="Kode pos wajib diisi"),Object.keys(i.value).length===0),K=()=>{I()&&D("submit",{...e.value})},$=()=>{D("cancel")};return _({formData:e,validate:I,reset:()=>{e.value={name:"",contactName:"",phone:"",addressLine1:"",addressLine2:"",provinceId:"",provinceName:"",cityId:"",cityName:"",districtId:"",districtName:"",postalCode:"",isDefault:!1},p.value=[],c.value=[],i.value={}}}),(l,a)=>{const d=S,n=P,q=O,A=T,N=F,w=B;return E(),R("form",{onSubmit:z(K,["prevent"]),class:"space-y-6"},[f(" Basic Info "),v("div",J,[t(n,{label:"Nama Alamat",required:"",error:i.value.name},{default:u(()=>[t(d,{modelValue:e.value.name,"onUpdate:modelValue":a[0]||(a[0]=s=>e.value.name=s),placeholder:"Contoh: Gudang Utama, Toko Pusat",class:"w-full",disabled:r.processing,color:i.value.name?"error":void 0},null,8,["modelValue","disabled","color"])]),_:1},8,["error"]),t(n,{label:"Jadikan Default"},{default:u(()=>[v("div",W,[t(q,{modelValue:e.value.isDefault,"onUpdate:modelValue":a[1]||(a[1]=s=>e.value.isDefault=s),disabled:r.processing},null,8,["modelValue","disabled"]),a[10]||(a[10]=v("span",{class:"text-sm text-gray-500 dark:text-gray-400"}," Gunakan sebagai alamat pengiriman default ",-1))])]),_:1})]),f(" Contact Info "),v("div",H,[t(n,{label:"Nama Kontak",required:"",error:i.value.contactName},{default:u(()=>[t(d,{modelValue:e.value.contactName,"onUpdate:modelValue":a[2]||(a[2]=s=>e.value.contactName=s),placeholder:"Nama penanggung jawab",class:"w-full",disabled:r.processing,color:i.value.contactName?"error":void 0},null,8,["modelValue","disabled","color"])]),_:1},8,["error"]),t(n,{label:"Nomor Telepon",required:"",error:i.value.phone},{default:u(()=>[t(d,{modelValue:e.value.phone,"onUpdate:modelValue":a[3]||(a[3]=s=>e.value.phone=s),placeholder:"08xxxxxxxxxx",class:"w-full",disabled:r.processing,color:i.value.phone?"error":void 0},null,8,["modelValue","disabled","color"])]),_:1},8,["error"])]),f(" Address "),t(n,{label:"Alamat Lengkap",required:"",error:i.value.addressLine1},{default:u(()=>[t(A,{modelValue:e.value.addressLine1,"onUpdate:modelValue":a[4]||(a[4]=s=>e.value.addressLine1=s),placeholder:"Nama jalan, nomor rumah, RT/RW",class:"w-full",rows:2,disabled:r.processing,color:i.value.addressLine1?"error":void 0},null,8,["modelValue","disabled","color"])]),_:1},8,["error"]),t(n,{label:"Alamat Tambahan (Opsional)"},{default:u(()=>[t(d,{modelValue:e.value.addressLine2,"onUpdate:modelValue":a[5]||(a[5]=s=>e.value.addressLine2=s),placeholder:"Patokan, nama gedung, dll",class:"w-full",disabled:r.processing},null,8,["modelValue","disabled"])]),_:1}),f(" Location "),v("div",Q,[t(n,{label:"Provinsi",required:"",error:i.value.provinceId},{default:u(()=>[t(N,{modelValue:e.value.provinceId,"onUpdate:modelValue":a[6]||(a[6]=s=>e.value.provinceId=s),items:k.value,"value-key":"value",placeholder:"Pilih Provinsi",disabled:r.processing,searchable:"",class:"w-full"},null,8,["modelValue","items","disabled"])]),_:1},8,["error"]),t(n,{label:"Kota/Kabupaten",required:"",error:i.value.cityId},{default:u(()=>[t(N,{modelValue:e.value.cityId,"onUpdate:modelValue":a[7]||(a[7]=s=>e.value.cityId=s),items:L.value,"value-key":"value",placeholder:"Pilih Kota",disabled:r.processing||!e.value.provinceId||b.value,loading:b.value,searchable:"",class:"w-full"},null,8,["modelValue","items","disabled","loading"])]),_:1},8,["error"]),t(n,{label:"Kecamatan",required:"",error:i.value.districtId},{default:u(()=>[t(N,{modelValue:e.value.districtId,"onUpdate:modelValue":a[8]||(a[8]=s=>e.value.districtId=s),items:C.value,"value-key":"value",placeholder:"Pilih Kecamatan",disabled:r.processing||!e.value.cityId||g.value,loading:g.value,searchable:"",class:"w-full"},null,8,["modelValue","items","disabled","loading"])]),_:1},8,["error"])]),v("div",X,[t(n,{label:"Kode Pos",required:"",error:i.value.postalCode},{default:u(()=>[t(d,{modelValue:e.value.postalCode,"onUpdate:modelValue":a[9]||(a[9]=s=>e.value.postalCode=s),placeholder:"Kode pos",disabled:r.processing,color:i.value.postalCode?"error":void 0,class:"w-full"},null,8,["modelValue","disabled","color"])]),_:1},8,["error"])]),f(" Actions "),v("div",Y,[t(w,{type:"button",color:"neutral",variant:"outline",label:"Batal",disabled:r.processing,onClick:$},null,8,["disabled"]),t(w,{type:"submit",color:"primary",label:r.submitLabel||"Simpan",loading:r.processing},null,8,["label","loading"])])],32)}}});export{se as _};
