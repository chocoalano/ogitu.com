import{d as V,a as p,b as t,t as v,e as E,F as T,f as l,w,k as P,o as d,j as n,c as U,L as at,u as S,n as q,r as L,m as ot,h as C,y as A,T as nt,$ as lt,l as H}from"./app-CyjtdGoI.js";import{_ as O,g as it}from"./ColorModeButton-Bf7Nr8w3.js";import{A as rt}from"./admin-BzR6vrex.js";import{a as N,_ as j}from"./Button-CI_-soaG.js";import{_ as W}from"./Select-D6kv-Jzs.js";import{_ as G}from"./Badge-DfumusWV.js";import{_ as dt}from"./Pagination-97jdZAo5.js";import"./Tooltip-BrTR-Vq7.js";import"./useFormControl-D_pV87FU.js";const ct={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},ut={class:"text-sm text-slate-500 dark:text-slate-400 mt-1"},mt={class:"flex items-center gap-3"},pt=V({__name:"InventoryHeader",props:{storeName:{},editMode:{type:Boolean},isSaving:{type:Boolean},hasChanges:{type:Boolean}},emits:["toggle-edit","save","cancel"],setup(e,{emit:k}){const a=k;return(u,o)=>{const g=N,c=j;return d(),p("div",ct,[t("div",null,[o[3]||(o[3]=t("h1",{class:"text-2xl font-bold text-slate-900 dark:text-white"},"Manajemen Stok",-1)),t("p",ut," Kelola stok produk dan varian toko "+v(e.storeName),1)]),t("div",mt,[e.editMode?(d(),p(T,{key:0},[l(g,{color:"neutral",variant:"outline",onClick:o[0]||(o[0]=s=>a("cancel")),disabled:e.isSaving},{default:w(()=>[...o[4]||(o[4]=[P(" Batal ",-1)])]),_:1},8,["disabled"]),l(g,{color:"primary",onClick:o[1]||(o[1]=s=>a("save")),loading:e.isSaving,disabled:!e.hasChanges},{default:w(()=>[l(c,{name:"i-heroicons-check",class:"w-4 h-4 mr-1"}),o[5]||(o[5]=P(" Simpan Perubahan ",-1))]),_:1},8,["loading","disabled"])],64)):(d(),E(g,{key:1,color:"primary",onClick:o[2]||(o[2]=s=>a("toggle-edit"))},{default:w(()=>[l(c,{name:"i-heroicons-pencil-square",class:"w-4 h-4 mr-1"}),o[6]||(o[6]=P(" Edit Stok ",-1))]),_:1}))])])}}}),vt={class:"grid grid-cols-2 md:grid-cols-5 gap-4"},gt={class:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700"},xt={class:"flex items-center gap-3"},kt={class:"w-10 h-10 rounded-lg bg-violet-100 dark:bg-violet-900/30 flex items-center justify-center"},ft={class:"text-lg font-semibold text-slate-900 dark:text-white"},ht={class:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700"},bt={class:"flex items-center gap-3"},yt={class:"w-10 h-10 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center"},St={class:"text-lg font-semibold text-slate-900 dark:text-white"},wt={class:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700"},_t={class:"flex items-center gap-3"},$t={class:"w-10 h-10 rounded-lg bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center"},Pt={class:"text-lg font-semibold text-slate-900 dark:text-white"},Ut={class:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700"},Vt={class:"flex items-center gap-3"},Ct={class:"w-10 h-10 rounded-lg bg-red-100 dark:bg-red-900/30 flex items-center justify-center"},Tt={class:"text-lg font-semibold text-slate-900 dark:text-white"},jt={class:"bg-white dark:bg-slate-800 rounded-xl p-4 border border-slate-200 dark:border-slate-700"},Bt={class:"flex items-center gap-3"},Et={class:"w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center"},It={class:"text-lg font-semibold text-slate-900 dark:text-white"},Mt=V({__name:"InventoryStats",props:{stats:{}},setup(e){return(k,a)=>{const u=j;return d(),p("div",vt,[n(" Total Products "),t("div",gt,[t("div",xt,[t("div",kt,[l(u,{name:"i-heroicons-cube",class:"w-5 h-5 text-violet-500"})]),t("div",null,[a[0]||(a[0]=t("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Total Produk",-1)),t("p",ft,v(e.stats.totalProducts),1)])])]),n(" In Stock "),t("div",ht,[t("div",bt,[t("div",yt,[l(u,{name:"i-heroicons-check-circle",class:"w-5 h-5 text-green-500"})]),t("div",null,[a[1]||(a[1]=t("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Stok Tersedia",-1)),t("p",St,v(e.stats.inStock),1)])])]),n(" Low Stock "),t("div",wt,[t("div",_t,[t("div",$t,[l(u,{name:"i-heroicons-exclamation-triangle",class:"w-5 h-5 text-amber-500"})]),t("div",null,[a[2]||(a[2]=t("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Stok Rendah",-1)),t("p",Pt,v(e.stats.lowStock),1)])])]),n(" Out of Stock "),t("div",Ut,[t("div",Vt,[t("div",Ct,[l(u,{name:"i-heroicons-x-circle",class:"w-5 h-5 text-red-500"})]),t("div",null,[a[3]||(a[3]=t("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Stok Habis",-1)),t("p",Tt,v(e.stats.outOfStock),1)])])]),n(" Total Variants "),t("div",jt,[t("div",Bt,[t("div",Et,[l(u,{name:"i-heroicons-squares-2x2",class:"w-5 h-5 text-blue-500"})]),t("div",null,[a[4]||(a[4]=t("p",{class:"text-xs text-slate-500 dark:text-slate-400"},"Total Varian",-1)),t("p",It,v(e.stats.totalVariants),1)])])])])}}}),R=e=>e<=0?{label:"Habis",color:"error"}:e<=10?{label:"Rendah",color:"warning"}:{label:"Tersedia",color:"success"},D=e=>({active:{label:"Aktif",color:"success"},draft:{label:"Draft",color:"neutral"},inactive:{label:"Nonaktif",color:"warning"},out_of_stock:{label:"Stok Habis",color:"error"}})[e]||{label:e,color:"neutral"},X=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e),Rt=[{label:"Semua Stok",value:void 0},{label:"Stok Tersedia",value:"in_stock"},{label:"Stok Rendah",value:"low_stock"},{label:"Stok Habis",value:"out_of_stock"}],Nt=[{label:"Semua Status",value:void 0},{label:"Aktif",value:"active"},{label:"Draft",value:"draft"},{label:"Nonaktif",value:"inactive"},{label:"Stok Habis",value:"out_of_stock"}],zt={class:"p-4 border-b border-slate-200 dark:border-slate-700"},Ft={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},At={class:"flex gap-2"},Ot=V({__name:"InventoryFilters",props:{filters:{},categories:{},search:{}},emits:["update:filters","update:search","search","reset"],setup(e,{emit:k}){const a=e,u=k,o=U({get:()=>a.filters,set:s=>u("update:filters",s)}),g=U({get:()=>a.search,set:s=>u("update:search",s)}),c=U(()=>[{label:"Semua Kategori",value:void 0},...a.categories.map(s=>({label:s.name,value:s.id}))]);return(s,i)=>{const f=O,m=W,b=j,_=N;return d(),p("div",zt,[t("div",Ft,[l(f,{modelValue:g.value,"onUpdate:modelValue":i[0]||(i[0]=y=>g.value=y),placeholder:"Cari produk atau SKU...",icon:"i-heroicons-magnifying-glass",onKeyup:i[1]||(i[1]=at(y=>u("search"),["enter"]))},null,8,["modelValue"]),l(m,{modelValue:o.value.stockStatus,"onUpdate:modelValue":i[2]||(i[2]=y=>o.value.stockStatus=y),items:S(Rt),"value-key":"value",placeholder:"Filter Stok"},null,8,["modelValue","items"]),l(m,{modelValue:o.value.status,"onUpdate:modelValue":i[3]||(i[3]=y=>o.value.status=y),items:S(Nt),"value-key":"value",placeholder:"Filter Status"},null,8,["modelValue","items"]),l(m,{modelValue:o.value.categoryId,"onUpdate:modelValue":i[4]||(i[4]=y=>o.value.categoryId=y),items:c.value,"value-key":"value",placeholder:"Filter Kategori"},null,8,["modelValue","items"]),t("div",At,[l(_,{color:"primary",onClick:i[5]||(i[5]=y=>u("search")),class:"flex-1"},{default:w(()=>[l(b,{name:"i-heroicons-magnifying-glass",class:"w-4 h-4 mr-1"}),i[7]||(i[7]=P(" Cari ",-1))]),_:1}),l(_,{color:"neutral",variant:"outline",onClick:i[6]||(i[6]=y=>u("reset"))},{default:w(()=>[l(b,{name:"i-heroicons-arrow-path",class:"w-4 h-4"})]),_:1})])])])}}}),Kt={class:"hover:bg-slate-50 dark:hover:bg-slate-900/20 transition-colors"},Lt={class:"px-4 py-3"},Ht={class:"px-4 py-3"},Dt={class:"flex items-center gap-3"},Xt={class:"w-10 h-10 rounded-lg overflow-hidden bg-slate-100 dark:bg-slate-700 shrink-0"},qt=["src","alt"],Wt={key:1,class:"w-full h-full flex items-center justify-center"},Gt={class:"min-w-0"},Jt={class:"text-sm font-medium text-slate-900 dark:text-white truncate"},Qt={key:0,class:"text-xs text-blue-500"},Yt={class:"px-4 py-3"},Zt={class:"text-sm font-mono text-slate-600 dark:text-slate-300"},te={class:"px-4 py-3"},ee={class:"text-sm text-slate-600 dark:text-slate-300"},se={class:"px-4 py-3 text-center"},ae={class:"text-sm font-medium text-slate-900 dark:text-white"},oe={key:0,class:"text-xs text-slate-500 block"},ne={class:"px-4 py-3 text-center"},le={key:0,class:"text-sm text-blue-500"},ie={key:1,class:"text-slate-400"},re={class:"px-4 py-3 text-center"},de={class:"px-4 py-3 text-center"},ce=V({__name:"InventoryProductRow",props:{product:{},editMode:{type:Boolean},isExpanded:{type:Boolean},editedStock:{}},emits:["toggle-expand","update-stock"],setup(e,{emit:k}){const a=e,u=k,o=U(()=>a.editedStock?.stock??a.product.stock),g=U(()=>a.editedStock?a.editedStock.stock!==a.product.stock:!1),c=s=>{u("update-stock",a.product.id,Number(s)||0)};return(s,i)=>{const f=j,m=O,b=G;return d(),p("tr",Kt,[n(" Expand Button "),t("td",Lt,[e.product.hasVariants?(d(),p("button",{key:0,onClick:i[0]||(i[0]=_=>u("toggle-expand",e.product.id)),class:"w-6 h-6 flex items-center justify-center rounded hover:bg-slate-200 dark:hover:bg-slate-700"},[l(f,{name:e.isExpanded?"i-heroicons-chevron-down":"i-heroicons-chevron-right",class:"w-4 h-4 text-slate-500"},null,8,["name"])])):n("v-if",!0)]),n(" Product Info "),t("td",Ht,[t("div",Dt,[t("div",Xt,[e.product.primaryImage?(d(),p("img",{key:0,src:e.product.primaryImage.url,alt:e.product.name,class:"w-full h-full object-cover"},null,8,qt)):(d(),p("div",Wt,[l(f,{name:"i-heroicons-photo",class:"w-5 h-5 text-slate-400"})]))]),t("div",Gt,[t("p",Jt,v(e.product.name),1),e.product.hasVariants?(d(),p("p",Qt,v(e.product.variants.length)+" varian ",1)):n("v-if",!0)])])]),n(" SKU "),t("td",Yt,[t("span",Zt,v(e.product.sku||"-"),1)]),n(" Category "),t("td",te,[t("span",ee,v(e.product.category?.name||"-"),1)]),n(" Stock "),t("td",se,[e.editMode?(d(),E(m,{key:0,type:"number","model-value":o.value,"onUpdate:modelValue":c,min:"0",class:q(["w-24 mx-auto",{"ring-2 ring-violet-500":g.value}]),size:"sm"},null,8,["model-value","class"])):(d(),p(T,{key:1},[t("span",ae,v(e.product.stock),1),e.product.hasVariants?(d(),p("span",oe," (+"+v(e.product.totalVariantStock)+" varian) ",1)):n("v-if",!0)],64))]),n(" Variants Count "),t("td",ne,[e.product.hasVariants?(d(),p("span",le,v(e.product.variants.length)+" varian",1)):(d(),p("span",ie,"-"))]),n(" Stock Status "),t("td",re,[l(b,{color:S(R)(o.value).color,variant:"subtle",size:"sm"},{default:w(()=>[P(v(S(R)(o.value).label),1)]),_:1},8,["color"])]),n(" Product Status "),t("td",de,[l(b,{color:S(D)(e.product.status).color,variant:"subtle",size:"sm"},{default:w(()=>[P(v(S(D)(e.product.status).label),1)]),_:1},8,["color"])])])}}}),ue={class:"bg-slate-50/50 dark:bg-slate-900/20"},me={class:"px-4 py-2 pl-8",colspan:"2"},pe={class:"flex items-center gap-2"},ve={class:"text-sm text-slate-700 dark:text-slate-300"},ge={class:"text-sm text-slate-500 font-mono ml-4"},xe={class:"px-4 py-2 text-center"},ke={key:1,class:"text-sm text-slate-600 dark:text-slate-300"},fe={class:"px-4 py-2 text-center"},he={class:"px-4 py-2 text-center"},be={class:"text-xs text-slate-500"},ye=V({__name:"InventoryVariantRow",props:{variant:{},productId:{},editMode:{type:Boolean},editedStock:{}},emits:["update-stock"],setup(e,{emit:k}){const a=e,u=k,o=U(()=>a.editedStock??a.variant.stock),g=U(()=>a.editedStock!==void 0&&a.editedStock!==a.variant.stock),c=i=>{u("update-stock",a.productId,a.variant.id,Number(i)||0)},s=U(()=>a.variant.priceAdjustment>0?`+${X(a.variant.priceAdjustment)}`:a.variant.priceAdjustment<0?X(a.variant.priceAdjustment):"-");return(i,f)=>{const m=j,b=G,_=O;return d(),p("tr",ue,[n(" Empty cell for alignment "),f[1]||(f[1]=t("td",{class:"px-4 py-2"},null,-1)),n(" Variant Info "),t("td",me,[t("div",pe,[l(m,{name:"i-heroicons-arrow-turn-down-right",class:"w-4 h-4 text-slate-400"}),t("span",ve,v(e.variant.name)+": "+v(e.variant.value),1),e.variant.isActive?n("v-if",!0):(d(),E(b,{key:0,color:"neutral",variant:"subtle",size:"xs"},{default:w(()=>[...f[0]||(f[0]=[P(" Nonaktif ",-1)])]),_:1})),t("span",ge,v(e.variant.sku||"-"),1)])]),n(" Empty cell for category column "),f[2]||(f[2]=t("td",{class:"px-4 py-2"},null,-1)),n(" Variant Stock "),t("td",xe,[e.editMode?(d(),E(_,{key:0,type:"number","model-value":o.value,"onUpdate:modelValue":c,min:"0",class:q(["w-24 mx-auto",{"ring-2 ring-violet-500":g.value}]),size:"sm"},null,8,["model-value","class"])):(d(),p("span",ke,v(e.variant.stock),1))]),n(" Empty cell for variants column "),f[3]||(f[3]=t("td",{class:"px-4 py-2"},null,-1)),n(" Variant Stock Status "),t("td",fe,[l(b,{color:S(R)(o.value).color,variant:"subtle",size:"xs"},{default:w(()=>[P(v(S(R)(o.value).label),1)]),_:1},8,["color"])]),n(" Price Adjustment "),t("td",he,[t("span",be,v(s.value),1)])])}}}),Se={key:0,class:"p-8 flex items-center justify-center"},we={class:"overflow-x-auto"},_e={class:"w-full"},$e={class:"divide-y divide-slate-200 dark:divide-slate-700"},Pe={key:0},Ue={colspan:"8",class:"px-4 py-12 text-center"},Ve={class:"flex flex-col items-center gap-3"},Ce={class:"w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center"},Te=V({__name:"InventoryTable",props:{products:{},editMode:{type:Boolean},expandedRows:{},editedStocks:{},isLoading:{type:Boolean}},emits:["toggle-expand","update-product-stock","update-variant-stock"],setup(e,{emit:k}){const a=e,u=k,o=c=>a.editedStocks.get(c),g=(c,s)=>a.editedStocks.get(c)?.variantStocks.get(s);return(c,s)=>{const i=j,f=N;return d(),p(T,null,[n(" Loading Overlay "),e.isLoading?(d(),p("div",Se,[l(i,{name:"i-heroicons-arrow-path",class:"w-8 h-8 text-violet-500 animate-spin"})])):(d(),p(T,{key:1},[n(" Table with expansion for variants "),t("div",we,[t("table",_e,[s[5]||(s[5]=t("thead",{class:"bg-slate-50 dark:bg-slate-900/50"},[t("tr",null,[t("th",{class:"w-10 px-4 py-3"}),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"}," Produk "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"}," SKU "),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"}," Kategori "),t("th",{class:"px-4 py-3 text-center text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"}," Stok "),t("th",{class:"px-4 py-3 text-center text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"}," Varian "),t("th",{class:"px-4 py-3 text-center text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"}," Status Stok "),t("th",{class:"px-4 py-3 text-center text-xs font-medium text-slate-500 dark:text-slate-400 uppercase tracking-wider"}," Status ")])],-1)),t("tbody",$e,[(d(!0),p(T,null,L(e.products,m=>(d(),p(T,{key:m.id},[n(" Product Row "),l(ce,{product:m,"edit-mode":e.editMode,"is-expanded":e.expandedRows.has(m.id),"edited-stock":o(m.id),onToggleExpand:s[0]||(s[0]=b=>u("toggle-expand",b)),onUpdateStock:s[1]||(s[1]=(b,_)=>u("update-product-stock",b,_))},null,8,["product","edit-mode","is-expanded","edited-stock"]),n(" Variant Rows (Expanded) "),m.hasVariants&&e.expandedRows.has(m.id)?(d(!0),p(T,{key:0},L(m.variants,b=>(d(),E(ye,{key:`variant-${b.id}`,variant:b,"product-id":m.id,"edit-mode":e.editMode,"edited-stock":g(m.id,b.id),onUpdateStock:s[2]||(s[2]=(_,y,z)=>u("update-variant-stock",_,y,z))},null,8,["variant","product-id","edit-mode","edited-stock"]))),128)):n("v-if",!0)],64))),128)),n(" Empty State "),e.products.length===0?(d(),p("tr",Pe,[t("td",Ue,[t("div",Ve,[t("div",Ce,[l(i,{name:"i-heroicons-cube",class:"w-8 h-8 text-slate-400"})]),s[4]||(s[4]=t("div",null,[t("p",{class:"text-slate-900 dark:text-white font-medium"},"Tidak ada produk"),t("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"Tambahkan produk untuk mengelola stok")],-1)),l(S(ot),{href:"/admin/products/create"},{default:w(()=>[l(f,{color:"primary",size:"sm"},{default:w(()=>[l(i,{name:"i-heroicons-plus",class:"w-4 h-4 mr-1"}),s[3]||(s[3]=P(" Tambah Produk ",-1))]),_:1})]),_:1})])])])):n("v-if",!0)])])])],2112))],2112)}}}),je={key:0,class:"border-t border-slate-200 dark:border-slate-700 px-4 py-3 flex flex-col sm:flex-row items-center justify-between gap-4"},Be={class:"text-sm text-slate-500 dark:text-slate-400"},Ee={class:"flex items-center gap-4"},Ie=V({__name:"InventoryPagination",props:{meta:{}},emits:["page-change","per-page-change"],setup(e,{emit:k}){const a=e,u=k,o=C(a.meta.currentPage);A(()=>a.meta.currentPage,c=>{o.value=c}),A(o,(c,s)=>{c!==s&&c!==a.meta.currentPage&&u("page-change",c)});const g=[{label:"10",value:10},{label:"20",value:20},{label:"50",value:50},{label:"100",value:100}];return(c,s)=>{const i=W,f=dt;return e.meta.total>0?(d(),p("div",je,[t("div",Be," Menampilkan "+v((e.meta.currentPage-1)*e.meta.perPage+1)+" - "+v(Math.min(e.meta.currentPage*e.meta.perPage,e.meta.total))+" dari "+v(e.meta.total)+" produk ",1),t("div",Ee,[l(i,{"model-value":e.meta.perPage,items:g,"value-key":"value","onUpdate:modelValue":s[0]||(s[0]=m=>u("per-page-change",Number(m))),size:"sm",class:"w-20"},null,8,["model-value"]),l(f,{page:o.value,"onUpdate:page":s[1]||(s[1]=m=>o.value=m),total:e.meta.total,"items-per-page":e.meta.perPage,"sibling-count":1,"show-edges":"",size:"sm"},null,8,["page","total","items-per-page"])])])):n("v-if",!0)}}}),Me={key:0,class:"fixed bottom-6 left-1/2 -translate-x-1/2 z-50"},Re={class:"bg-slate-900 dark:bg-slate-700 text-white rounded-xl px-6 py-3 shadow-lg flex items-center gap-4"},Ne={class:"text-sm"},ze=V({__name:"InventoryUnsavedWarning",props:{show:{type:Boolean},changesCount:{},isSaving:{type:Boolean}},emits:["save"],setup(e,{emit:k}){const a=k;return(u,o)=>{const g=j,c=N;return d(),E(lt,{to:"body"},[l(nt,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"translate-y-4 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-4 opacity-0"},{default:w(()=>[e.show?(d(),p("div",Me,[t("div",Re,[l(g,{name:"i-heroicons-exclamation-circle",class:"w-5 h-5 text-yellow-400"}),t("span",Ne,v(e.changesCount)+" produk memiliki perubahan yang belum disimpan",1),l(c,{color:"primary",size:"sm",onClick:o[0]||(o[0]=s=>a("save")),loading:e.isSaving},{default:w(()=>[...o[1]||(o[1]=[P(" Simpan Sekarang ",-1)])]),_:1},8,["loading"])])])):n("v-if",!0)]),_:1})])}}}),Fe={class:"space-y-6"},Ae={class:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden"},Je=V({layout:rt,__name:"inventory",props:{products:{default:()=>[]},meta:{default:()=>({currentPage:1,lastPage:1,perPage:20,total:0,firstPage:1,hasNext:!1,hasPrev:!1})},stats:{default:()=>({totalProducts:0,inStock:0,lowStock:0,outOfStock:0,totalVariants:0})},categories:{default:()=>[]},filters:{default:()=>({search:"",category:"",status:"",page:1})},admin:{default:()=>({id:0,storeName:"",slug:"",status:""})}},setup(e){const k=e,a=C({...k.filters}),u=C(!1),o=C(new Set),g=C(k.filters.search||""),c=C(!1),s=C(new Map),i=C(!1),f=it(),m=U(()=>s.value.size>0),b=()=>{const r=document.cookie.split("; ").find(x=>x.startsWith("XSRF-TOKEN="))?.split("=")[1];return r?decodeURIComponent(r):""},_=r=>{o.value.has(r)?o.value.delete(r):o.value.add(r)},y=r=>k.products.find(x=>x.id===r),z=(r,x)=>{const h=y(r);if(!h)return;s.value.has(r)||s.value.set(r,{stock:h.stock,variantStocks:new Map});const $=s.value.get(r);$.stock=x,$.stock===h.stock&&$.variantStocks.size===0&&s.value.delete(r)},J=(r,x,h)=>{const $=y(r);if(!$)return;const I=$.variants.find(F=>F.id===x);if(!I)return;s.value.has(r)||s.value.set(r,{stock:$.stock,variantStocks:new Map});const B=s.value.get(r);h===I.stock?B.variantStocks.delete(x):B.variantStocks.set(x,h),B.stock===$.stock&&B.variantStocks.size===0&&s.value.delete(r)},K=async()=>{if(m.value){i.value=!0;try{const r=Array.from(s.value.entries()).map(([$,I])=>({productId:$,stock:I.stock,variantStocks:Array.from(I.variantStocks.entries()).map(([B,F])=>({variantId:B,stock:F}))})),h=await(await fetch("/admin/products/inventory/bulk-update",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-XSRF-TOKEN":b()},body:JSON.stringify({updates:r})})).json();h.success?(f.success("Berhasil",h.message),s.value.clear(),c.value=!1,H.reload({only:["products","stats"]})):f.error("Gagal",h.message)}catch{f.error("Error","Terjadi kesalahan saat menyimpan")}finally{i.value=!1}}},Q=()=>{s.value.clear(),c.value=!1},Y=()=>{c.value=!0},M=(r={})=>{u.value=!0;const x={page:r.page||k.meta.currentPage,perPage:r.perPage||k.meta.perPage,...a.value};g.value&&(x.search=g.value),Object.keys(x).forEach(h=>{(x[h]===void 0||x[h]===null||x[h]==="")&&delete x[h]}),H.get("/admin/products/inventory",x,{preserveState:!0,onFinish:()=>{u.value=!1}})},Z=()=>{a.value.search=g.value,M({page:1})},tt=()=>{a.value={},g.value="",M({page:1})},et=r=>{M({page:r})},st=r=>{M({page:1,perPage:r})};return A(c,r=>{r||s.value.clear()}),(r,x)=>(d(),p("div",Fe,[n(" Page Header "),l(S(pt),{"store-name":e.admin.storeName,"edit-mode":c.value,"is-saving":i.value,"has-changes":m.value,onToggleEdit:Y,onSave:K,onCancel:Q},null,8,["store-name","edit-mode","is-saving","has-changes"]),n(" Stats Cards "),l(S(Mt),{stats:e.stats},null,8,["stats"]),n(" Inventory Table Card "),t("div",Ae,[n(" Filters "),l(S(Ot),{filters:a.value,categories:e.categories,search:g.value,"onUpdate:filters":x[0]||(x[0]=h=>a.value=h),"onUpdate:search":x[1]||(x[1]=h=>g.value=h),onSearch:Z,onReset:tt},null,8,["filters","categories","search"]),n(" Table "),l(S(Te),{products:e.products,"edit-mode":c.value,"expanded-rows":o.value,"edited-stocks":s.value,"is-loading":u.value,onToggleExpand:_,onUpdateProductStock:z,onUpdateVariantStock:J},null,8,["products","edit-mode","expanded-rows","edited-stocks","is-loading"]),n(" Pagination "),l(S(Ie),{meta:e.meta,onPageChange:et,onPerPageChange:st},null,8,["meta"])]),n(" Unsaved Changes Warning "),l(S(ze),{show:m.value&&c.value,"changes-count":s.value.size,"is-saving":i.value,onSave:K},null,8,["show","changes-count","is-saving"])]))}});export{Je as default};
