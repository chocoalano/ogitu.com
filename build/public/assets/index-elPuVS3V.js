import{_ as N,a as U}from"./Button-CI_-soaG.js";import{h as F,l as _,d as T,c as z,a as A,j as g,b as e,P as J,t as S,f as c,J as H,o as $,Q as I,R as D,L as W,w as x,k as C,I as X,F as Y,u as d,p,m as K,e as Z,y as ee,S as M}from"./app-CyjtdGoI.js";import{A as te}from"./admin-BzR6vrex.js";import{g as ae,_ as se}from"./ColorModeButton-Bf7Nr8w3.js";import{_ as le}from"./Select-D6kv-Jzs.js";import{_ as oe}from"./Pagination-97jdZAo5.js";import{_ as ie,g as ne}from"./Table-C6nABs7j.js";import{_ as re}from"./DropdownMenu-DxuVXSbh.js";import{_ as Q}from"./Badge-DfumusWV.js";import{_ as de}from"./Modal-Bgd8PL5Y.js";import"./Tooltip-BrTR-Vq7.js";import"./useFormControl-D_pV87FU.js";import"./index-v4g8wp86.js";function ce(l){const o=ae(),f=F(!1),u=F(l.initialFilters.search||""),r=F(l.initialFilters.status||"all"),m=F({isOpen:!1,targetId:null,targetName:""}),s=F({pageIndex:l.initialData.meta.currentPage-1,pageSize:l.initialData.meta.perPage}),i=[{label:"Semua Status",value:"all"},{label:"Aktif",value:"active"},{label:"Tidak Aktif",value:"inactive"},{label:"Terverifikasi",value:"verified"},{label:"Belum Verifikasi",value:"unverified"}],y=(n,q)=>({total:q.total,active:n.filter(L=>L.isActive).length,verified:n.filter(L=>L.isVerified).length}),a=n=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(n),t=()=>{f.value=!0;const n={page:s.value.pageIndex+1,perPage:s.value.pageSize};u.value&&(n.search=u.value),r.value&&r.value!=="all"&&(n.status=r.value),_.get("/admin/customers",n,{preserveState:!0,preserveScroll:!0,onFinish:()=>{f.value=!1}})},v=()=>{s.value.pageIndex=0,t()},k=()=>{s.value.pageIndex=0,t()},b=()=>{u.value="",r.value="all",s.value.pageIndex=0,t()},V=n=>{s.value.pageIndex=n-1,t()},P=n=>{s.value.pageIndex=n-1},j=n=>{m.value={isOpen:!0,targetId:n.id,targetName:n.fullName}},B=()=>{m.value={isOpen:!1,targetId:null,targetName:""}};return{isLoading:f,searchQuery:u,selectedStatus:r,deleteState:m,pagination:s,statusOptions:i,computeStats:y,formatCurrency:a,fetchData:t,handleSearch:v,handleStatusChange:k,clearFilters:b,handlePageChange:V,syncPagination:P,openDeleteModal:j,closeDeleteModal:B,confirmDelete:()=>{m.value.targetId&&_.delete(`/admin/customers/${m.value.targetId}`,{onSuccess:()=>{o.success("Pelanggan berhasil dihapus"),B()},onError:()=>{o.error("Gagal menghapus pelanggan")}})},toggleActive:n=>{_.patch(`/admin/customers/${n.id}/active`,{},{preserveScroll:!0,onSuccess:()=>{o.success(`Pelanggan berhasil di${n.isActive?"nonaktifkan":"aktifkan"}`)},onError:()=>{o.error("Gagal mengubah status pelanggan")}})},toggleVerified:n=>{_.patch(`/admin/customers/${n.id}/verified`,{},{preserveScroll:!0,onSuccess:()=>{o.success("Status verifikasi berhasil diubah")},onError:()=>{o.error("Gagal mengubah status verifikasi")}})},impersonateCustomer:n=>{if(!n.isActive){o.error("Tidak dapat login sebagai customer yang tidak aktif");return}_.post(`/admin/customers/${n.id}/impersonate`,{},{onSuccess:()=>{o.success(`Anda sekarang login sebagai ${n.fullName}`)},onError:()=>{o.error("Gagal login sebagai customer")}})},viewCustomer:n=>{_.visit(`/admin/customers/${n.id}`)},editCustomer:n=>{_.visit(`/admin/customers/${n.id}/edit`)}}}const ue={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},me={class:"group relative overflow-hidden bg-linear-to-br from-violet-500 to-purple-600 rounded-2xl p-5 shadow-lg shadow-violet-500/20 hover:shadow-xl hover:shadow-violet-500/30 transition-all duration-300"},ge={class:"relative flex items-start justify-between"},fe={class:"space-y-3"},pe={class:"text-3xl font-bold text-white tracking-tight"},he={class:"w-12 h-12 rounded-xl bg-white/20 backdrop-blur-sm flex items-center justify-center group-hover:scale-110 transition-transform duration-300"},ve={class:"group relative overflow-hidden bg-white dark:bg-slate-900 rounded-2xl border border-slate-200/50 dark:border-slate-700/50 p-5 shadow-sm hover:shadow-lg hover:border-emerald-200 dark:hover:border-emerald-800/50 transition-all duration-300"},be={class:"flex items-start justify-between mb-4"},xe={class:"w-11 h-11 rounded-xl bg-linear-to-br from-emerald-400 to-teal-500 flex items-center justify-center shadow-lg shadow-emerald-500/30 group-hover:scale-110 transition-transform duration-300"},ke={class:"flex items-center gap-1.5 px-2 py-0.5 bg-emerald-50 dark:bg-emerald-500/10 rounded-full"},we={class:"text-xs font-semibold text-emerald-600 dark:text-emerald-400"},ye={class:"space-y-3"},_e={class:"text-2xl font-bold text-slate-900 dark:text-white"},Se={class:"relative h-1.5 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden"},Ce={class:"group relative overflow-hidden bg-white dark:bg-slate-900 rounded-2xl border border-slate-200/50 dark:border-slate-700/50 p-5 shadow-sm hover:shadow-lg hover:border-blue-200 dark:hover:border-blue-800/50 transition-all duration-300"},$e={class:"flex items-start justify-between mb-4"},Pe={class:"w-11 h-11 rounded-xl bg-linear-to-br from-blue-400 to-indigo-500 flex items-center justify-center shadow-lg shadow-blue-500/30 group-hover:scale-110 transition-transform duration-300"},Ae={class:"flex items-center gap-1.5 px-2 py-0.5 bg-blue-50 dark:bg-blue-500/10 rounded-full"},Fe={class:"text-xs font-semibold text-blue-600 dark:text-blue-400"},Ie={class:"space-y-3"},Ve={class:"text-2xl font-bold text-slate-900 dark:text-white"},Ue={class:"relative h-1.5 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden"},De=T({__name:"CustomerStatsCards",props:{stats:{}},setup(l){const o=l,f=z(()=>o.stats.total===0?0:Math.round(o.stats.active/o.stats.total*100)),u=z(()=>o.stats.total===0?0:Math.round(o.stats.verified/o.stats.total*100)),r=m=>new Intl.NumberFormat("id-ID").format(m);return(m,s)=>{const i=N;return $(),A("div",ue,[g(" Total Customers Card "),e("div",me,[g(" Background Pattern "),s[2]||(s[2]=J('<div class="absolute inset-0 opacity-10"><svg class="w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none"><defs><pattern id="grid1" width="10" height="10" patternUnits="userSpaceOnUse"><circle cx="1" cy="1" r="1" fill="white"></circle></pattern></defs><rect width="100" height="100" fill="url(#grid1)"></rect></svg></div>',1)),g(" Floating Icon "),s[3]||(s[3]=e("div",{class:"absolute -top-4 -right-4 w-24 h-24 bg-white/10 rounded-full blur-2xl group-hover:scale-150 transition-transform duration-500"},null,-1)),e("div",ge,[e("div",fe,[s[1]||(s[1]=e("div",{class:"inline-flex items-center gap-2 px-2.5 py-1 bg-white/20 backdrop-blur-sm rounded-full"},[e("span",{class:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),e("span",{class:"text-xs font-medium text-white/90"},"Total")],-1)),e("div",null,[e("p",pe,S(r(l.stats.total)),1),s[0]||(s[0]=e("p",{class:"text-sm text-white/70 mt-1"},"Pelanggan Terdaftar",-1))])]),e("div",he,[c(i,{name:"i-heroicons-users",class:"w-6 h-6 text-white"})])])]),g(" Active Customers Card "),e("div",ve,[g(" Accent Line "),s[5]||(s[5]=e("div",{class:"absolute top-0 left-0 right-0 h-1 bg-linear-to-r from-emerald-400 to-teal-500 rounded-t-2xl"},null,-1)),e("div",be,[e("div",xe,[c(i,{name:"i-heroicons-check-circle",class:"w-5 h-5 text-white"})]),e("div",ke,[c(i,{name:"i-heroicons-arrow-trending-up",class:"w-3.5 h-3.5 text-emerald-500"}),e("span",we,S(f.value)+"%",1)])]),e("div",ye,[e("div",null,[e("p",_e,S(r(l.stats.active)),1),s[4]||(s[4]=e("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"Pelanggan Aktif",-1))]),g(" Progress Bar "),e("div",Se,[e("div",{class:"absolute inset-y-0 left-0 bg-linear-to-r from-emerald-400 to-teal-500 rounded-full transition-all duration-500",style:H({width:`${f.value}%`})},null,4)])])]),g(" Verified Customers Card "),e("div",Ce,[g(" Accent Line "),s[7]||(s[7]=e("div",{class:"absolute top-0 left-0 right-0 h-1 bg-linear-to-r from-blue-400 to-indigo-500 rounded-t-2xl"},null,-1)),e("div",$e,[e("div",Pe,[c(i,{name:"i-heroicons-shield-check",class:"w-5 h-5 text-white"})]),e("div",Ae,[c(i,{name:"i-heroicons-check-badge",class:"w-3.5 h-3.5 text-blue-500"}),e("span",Fe,S(u.value)+"%",1)])]),e("div",Ie,[e("div",null,[e("p",Ve,S(r(l.stats.verified)),1),s[6]||(s[6]=e("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"Terverifikasi",-1))]),g(" Progress Bar "),e("div",Ue,[e("div",{class:"absolute inset-y-0 left-0 bg-linear-to-r from-blue-400 to-indigo-500 rounded-full transition-all duration-500",style:H({width:`${u.value}%`})},null,4)])])])])}}}),Te={class:"flex flex-col sm:flex-row gap-4 px-4 py-3.5 border-b border-slate-200 dark:border-slate-800"},Be={class:"flex-1"},Me={class:"w-full sm:w-48"},Ne={class:"flex gap-2"},je=T({__name:"CustomerFiltersBar",props:I({statusOptions:{}},{globalFilter:{default:""},globalFilterModifiers:{},selectedStatus:{default:"all"},selectedStatusModifiers:{}}),emits:I(["search","statusChange","clear"],["update:globalFilter","update:selectedStatus"]),setup(l,{emit:o}){const f=D(l,"globalFilter"),u=D(l,"selectedStatus"),r=o,m=()=>{r("search")},s=()=>{r("statusChange")},i=()=>{r("clear")};return(y,a)=>{const t=se,v=le,k=U;return $(),A("div",Te,[g(" Search "),e("div",Be,[c(t,{modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=b=>f.value=b),placeholder:"Cari nama, email, atau telepon...",icon:"i-heroicons-magnifying-glass",class:"max-w-md w-full",onKeyup:W(m,["enter"])},null,8,["modelValue"])]),g(" Status Filter "),e("div",Me,[c(v,{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=b=>u.value=b),items:l.statusOptions,placeholder:"Filter Status",class:"w-full",onChange:s},null,8,["modelValue","items"])]),g(" Actions "),e("div",Ne,[c(k,{icon:"i-heroicons-magnifying-glass",color:"primary",onClick:m},{default:x(()=>[...a[2]||(a[2]=[C(" Cari ",-1)])]),_:1}),c(k,{icon:"i-heroicons-x-mark",color:"neutral",variant:"outline",onClick:i},{default:x(()=>[...a[3]||(a[3]=[C(" Reset ",-1)])]),_:1})])])}}}),Oe={class:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 overflow-hidden"},Le={key:0,class:"p-8 flex items-center justify-center"},ze={class:"px-4 py-12 text-center"},Ke={class:"flex flex-col items-center"},Re={key:2,class:"flex items-center justify-between px-4 py-3 border-t border-slate-200 dark:border-slate-800"},Ee={class:"text-sm text-slate-500 dark:text-slate-400"},Ge=T({__name:"CustomerTable",props:I({customers:{},meta:{},isLoading:{type:Boolean}},{pagination:{default:()=>({pageIndex:0,pageSize:10})},paginationModifiers:{},globalFilter:{default:""},globalFilterModifiers:{}}),emits:I(["toggleActive","toggleVerified","impersonate","delete","pageChange"],["update:pagination","update:globalFilter"]),setup(l,{emit:o}){const f=D(l,"pagination"),u=D(l,"globalFilter"),r=o,m=F(null),s=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),i=[{accessorKey:"fullName",header:"Pelanggan",cell:({row:a})=>{const t=a.original;return p("div",{class:"flex items-center gap-3"},[p("div",{class:"w-10 h-10 rounded-full bg-violet-500/10 flex items-center justify-center overflow-hidden shrink-0"},t.avatar?p("img",{src:t.avatar,alt:t.fullName,class:"w-full h-full object-cover"}):p(N,{name:"i-heroicons-user",class:"w-5 h-5 text-violet-500"})),p("div",{class:"min-w-0"},[p(K,{href:`/admin/customers/${t.id}`,class:"font-medium text-slate-900 dark:text-white hover:text-violet-600 dark:hover:text-violet-400"},()=>t.fullName),t.gender?p("p",{class:"text-xs text-slate-500 dark:text-slate-400"},t.gender==="male"?"Laki-laki":"Perempuan"):null])])}},{accessorKey:"email",header:"Email",cell:({row:a})=>p("span",{class:"text-slate-600 dark:text-slate-400"},a.original.email)},{accessorKey:"phone",header:"Telepon",cell:({row:a})=>p("span",{class:"text-slate-600 dark:text-slate-400"},a.original.phone||"-")},{accessorKey:"status",header:"Status",cell:({row:a})=>{const t=a.original;return p("div",{class:"flex flex-col gap-1"},[p(Q,{color:t.isActive?"success":"error",variant:"subtle",size:"xs"},()=>t.isActive?"Aktif":"Tidak Aktif"),p(Q,{color:t.isVerified?"primary":"neutral",variant:"subtle",size:"xs"},()=>t.isVerified?"Terverifikasi":"Belum Verifikasi")])}},{accessorKey:"totalOrdersCount",header:"Total Pesanan",cell:({row:a})=>p("span",{class:"font-medium text-slate-900 dark:text-white"},a.original.totalOrdersCount)},{accessorKey:"totalSpent",header:()=>p("div",{class:"text-right"},"Total Belanja"),cell:({row:a})=>p("div",{class:"text-right font-medium text-emerald-600 dark:text-emerald-400"},s(a.original.totalSpent))},{id:"actions",header:()=>p("div",{class:"text-right"},"Aksi"),cell:({row:a})=>{const t=a.original,v=re,k=U,b=[[{label:"Lihat Detail",icon:"i-heroicons-eye",onSelect:()=>_.visit(`/admin/customers/${t.id}`)},{label:"Edit",icon:"i-heroicons-pencil-square",onSelect:()=>_.visit(`/admin/customers/${t.id}/edit`)}],[{label:"Login sebagai Customer",icon:"i-heroicons-user-circle",disabled:!t.isActive,onSelect:()=>r("impersonate",t)}],[{label:t.isActive?"Nonaktifkan":"Aktifkan",icon:t.isActive?"i-heroicons-x-circle":"i-heroicons-check-circle",onSelect:()=>r("toggleActive",t)},{label:t.isVerified?"Batalkan Verifikasi":"Verifikasi",icon:t.isVerified?"i-heroicons-shield-exclamation":"i-heroicons-shield-check",onSelect:()=>r("toggleVerified",t)}],[{label:"Hapus",icon:"i-heroicons-trash",color:"error",onSelect:()=>r("delete",t)}]];return p("div",{class:"text-right"},p(v,{content:{align:"end"},items:b,"aria-label":"Actions dropdown"},()=>p(k,{icon:"i-heroicons-ellipsis-vertical",color:"neutral",variant:"ghost",size:"xs"})))},enableSorting:!1}],y=a=>{f.value.pageIndex=a-1,r("pageChange",a)};return(a,t)=>{const v=N,k=U,b=ie,V=oe;return $(),A("div",Oe,[X(a.$slots,"filters"),g(" Loading Overlay "),l.isLoading?($(),A("div",Le,[c(v,{name:"i-heroicons-arrow-path",class:"w-8 h-8 text-violet-500 animate-spin"})])):($(),A(Y,{key:1},[g(" Table "),c(b,{ref_key:"table",ref:m,pagination:f.value,"onUpdate:pagination":t[0]||(t[0]=P=>f.value=P),"global-filter":u.value,"onUpdate:globalFilter":t[1]||(t[1]=P=>u.value=P),data:l.customers,columns:i,"pagination-options":{getPaginationRowModel:d(ne)()},class:"flex-1"},{empty:x(()=>[e("div",ze,[e("div",Ke,[c(v,{name:"i-heroicons-users",class:"w-12 h-12 text-slate-300 dark:text-slate-600 mb-4"}),t[3]||(t[3]=e("p",{class:"text-slate-500 dark:text-slate-400 mb-4"},"Belum ada pelanggan",-1)),c(d(K),{href:"/admin/customers/create"},{default:x(()=>[c(k,{icon:"i-heroicons-plus",color:"primary"},{default:x(()=>[...t[2]||(t[2]=[C(" Tambah Pelanggan ",-1)])]),_:1})]),_:1})])])]),_:1},8,["pagination","global-filter","data","pagination-options"])],2112)),g(" Pagination "),l.meta.lastPage>1?($(),A("div",Re,[e("p",Ee," Menampilkan "+S((l.meta.currentPage-1)*l.meta.perPage+1)+" - "+S(Math.min(l.meta.currentPage*l.meta.perPage,l.meta.total))+" dari "+S(l.meta.total)+" pelanggan ",1),c(V,{page:(m.value?.tableApi?.getState().pagination.pageIndex||0)+1,"items-per-page":m.value?.tableApi?.getState().pagination.pageSize||l.meta.perPage,total:l.meta.total,"onUpdate:page":y},null,8,["page","items-per-page","total"])])):g("v-if",!0)])}}}),He={class:"p-6 max-h-[85vh] overflow-y-auto"},Qe={class:"flex items-center gap-4 mb-4"},qe={class:"w-12 h-12 rounded-full bg-red-100 dark:bg-red-500/20 flex items-center justify-center"},Je={class:"text-slate-500 dark:text-slate-400"},We={class:"text-sm text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-500/10 p-3 rounded-lg mb-4"},Xe={class:"flex justify-end gap-3"},Ye=T({__name:"CustomerDeleteModal",props:I({customerName:{}},{open:{type:Boolean,default:!1},openModifiers:{}}),emits:I(["confirm"],["update:open"]),setup(l,{emit:o}){const f=D(l,"open"),u=o,r=()=>{u("confirm")},m=()=>{f.value=!1};return(s,i)=>{const y=N,a=U,t=de;return $(),Z(t,{open:f.value,"onUpdate:open":i[0]||(i[0]=v=>f.value=v),ui:{overlay:"z-[100]",content:"z-[100]"}},{content:x(()=>[e("div",He,[e("div",Qe,[e("div",qe,[c(y,{name:"i-heroicons-exclamation-triangle",class:"w-6 h-6 text-red-500"})]),e("div",null,[i[3]||(i[3]=e("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white"},"Hapus Pelanggan",-1)),e("p",Je,[i[1]||(i[1]=C(" Apakah Anda yakin ingin menghapus ",-1)),e("strong",null,S(l.customerName),1),i[2]||(i[2]=C("? ",-1))])])]),e("p",We,[c(y,{name:"i-heroicons-exclamation-triangle",class:"w-4 h-4 inline mr-1"}),i[4]||(i[4]=C(" Pelanggan dengan riwayat pesanan tidak dapat dihapus. ",-1))]),e("div",Xe,[c(a,{color:"neutral",variant:"outline",onClick:m},{default:x(()=>[...i[5]||(i[5]=[C(" Batal ",-1)])]),_:1}),c(a,{color:"error",onClick:r},{default:x(()=>[...i[6]||(i[6]=[C(" Hapus ",-1)])]),_:1})])])]),_:1},8,["open"])}}}),Ze={class:"space-y-6"},et={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},ft=T({layout:te,__name:"index",props:{customers:{default:()=>({data:[],meta:{total:0,perPage:10,currentPage:1,lastPage:1,firstPage:1}})},filters:{default:()=>({search:"",status:""})}},setup(l){const o=l,{isLoading:f,searchQuery:u,selectedStatus:r,deleteState:m,pagination:s,statusOptions:i,computeStats:y,handleSearch:a,handleStatusChange:t,clearFilters:v,handlePageChange:k,syncPagination:b,openDeleteModal:V,confirmDelete:P,toggleActive:j,toggleVerified:B,impersonateCustomer:R}=ce({initialData:o.customers,initialFilters:o.filters}),E=z(()=>y(o.customers.data,o.customers.meta));return ee(()=>o.customers.meta.currentPage,O=>b(O)),(O,h)=>{const G=U;return $(),A("div",Ze,[g(" Page Header "),e("div",et,[h[6]||(h[6]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Kelola Pelanggan"),e("p",{class:"text-gray-500 dark:text-gray-400"}," Kelola data pelanggan toko ")],-1)),c(d(K),{href:"/admin/customers/create"},{default:x(()=>[c(G,{icon:"i-heroicons-plus",color:"primary"},{default:x(()=>[...h[5]||(h[5]=[C(" Tambah Pelanggan ",-1)])]),_:1})]),_:1})]),g(" Stats Cards "),c(d(De),{stats:E.value},null,8,["stats"]),g(" Table with Filters "),c(d(Ge),{pagination:d(s),"onUpdate:pagination":h[2]||(h[2]=w=>M(s)?s.value=w:null),"global-filter":d(u),"onUpdate:globalFilter":h[3]||(h[3]=w=>M(u)?u.value=w:null),customers:o.customers.data,meta:o.customers.meta,"is-loading":d(f),onToggleActive:d(j),onToggleVerified:d(B),onImpersonate:d(R),onDelete:d(V),onPageChange:d(k)},{filters:x(()=>[c(d(je),{"global-filter":d(u),"onUpdate:globalFilter":h[0]||(h[0]=w=>M(u)?u.value=w:null),"selected-status":d(r),"onUpdate:selectedStatus":h[1]||(h[1]=w=>M(r)?r.value=w:null),"status-options":d(i),onSearch:d(a),onStatusChange:d(t),onClear:d(v)},null,8,["global-filter","selected-status","status-options","onSearch","onStatusChange","onClear"])]),_:1},8,["pagination","global-filter","customers","meta","is-loading","onToggleActive","onToggleVerified","onImpersonate","onDelete","onPageChange"]),g(" Delete Confirmation Modal "),c(d(Ye),{open:d(m).isOpen,"onUpdate:open":h[4]||(h[4]=w=>d(m).isOpen=w),"customer-name":d(m).targetName,onConfirm:d(P)},null,8,["open","customer-name","onConfirm"])])}}});export{ft as default};
