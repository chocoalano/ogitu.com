import{_ as F,a as K}from"./Button-CI_-soaG.js";import{d as T,a as g,F as M,r as L,e as $,w as v,b as t,n as H,f as m,t as i,o,Q as ae,R as Q,c as _,j as s,u as V,k as y,I as se,h as O,y as q,g as re,l as A}from"./app-CyjtdGoI.js";import{A as oe}from"./admin-BzR6vrex.js";import{g as ne,u as le,a as ie,_ as ue,b as de}from"./CancelModal.vue_vue_type_script_setup_true_lang-Boxm_nDO.js";import{_ as j}from"./Card-BjL1m_sW.js";import{_ as ce}from"./SelectMenu-DKAhKU-v.js";import{_ as me}from"./ColorModeButton-Bf7Nr8w3.js";import{_ as G}from"./Badge-DfumusWV.js";import"./Tooltip-BrTR-Vq7.js";import"./Modal-Bgd8PL5Y.js";import"./FormField-qFQ_28ZO.js";import"./Label-yeknIWsP.js";import"./Textarea-CZyY9J1c.js";import"./Alert-CrKiQ9oh.js";import"./useFormControl-D_pV87FU.js";import"./VisuallyHiddenInput-BGOu5NlX.js";import"./index-v4g8wp86.js";const ge={class:"grid grid-cols-2 lg:grid-cols-4 gap-4"},ve={class:"flex items-center gap-4"},pe={class:"text-2xl font-bold text-gray-900 dark:text-white"},fe={class:"text-sm text-gray-500 dark:text-gray-400"},xe=T({__name:"OrderStatsCards",props:{stats:{}},setup(a){const u=e=>({warning:"bg-yellow-100 dark:bg-yellow-900/30",primary:"bg-blue-100 dark:bg-blue-900/30",success:"bg-green-100 dark:bg-green-900/30",neutral:"bg-gray-100 dark:bg-gray-800"})[e],f=e=>({warning:"text-yellow-600 dark:text-yellow-400",primary:"text-blue-600 dark:text-blue-400",success:"text-green-600 dark:text-green-400",neutral:"text-gray-600 dark:text-gray-400"})[e];return(e,p)=>{const S=F,c=j;return o(),g("div",ge,[(o(!0),g(M,null,L(a.stats,h=>(o(),$(c,{key:h.label,class:"relative overflow-hidden"},{default:v(()=>[t("div",ve,[t("div",{class:H(["p-3 rounded-xl",u(h.color)])},[m(S,{name:h.icon,class:H(["w-6 h-6",f(h.color)])},null,8,["name","class"])],2),t("div",null,[t("p",pe,i(h.value),1),t("p",fe,i(h.label),1)])])]),_:2},1024))),128))])}}}),ye={class:"flex flex-col sm:flex-row gap-4"},he=T({__name:"OrderFilters",props:ae({statusOptions:{}},{search:{default:""},searchModifiers:{},status:{default:""},statusModifiers:{}}),emits:["update:search","update:status"],setup(a){const u=Q(a,"search"),f=Q(a,"status");return(e,p)=>{const S=me,c=F,h=ce,U=j;return o(),$(U,null,{default:v(()=>[t("div",ye,[m(S,{modelValue:u.value,"onUpdate:modelValue":p[0]||(p[0]=w=>u.value=w),placeholder:"Cari nomor pesanan atau nama customer...",icon:"i-heroicons-magnifying-glass",class:"flex-1",size:"lg"},null,8,["modelValue"]),m(h,{modelValue:f.value,"onUpdate:modelValue":p[1]||(p[1]=w=>f.value=w),items:a.statusOptions,"value-key":"value","option-attribute":"label",placeholder:"Filter Status",class:"w-full sm:w-64",size:"lg"},{leading:v(()=>[m(c,{name:"i-heroicons-funnel",class:"w-5 h-5 text-gray-400"})]),_:1},8,["modelValue","items"])])]),_:1})}}}),ke={class:"p-4 sm:p-6 hover:bg-gray-50 dark:hover:bg-gray-900/50 transition-colors"},be={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4"},Pe={class:"flex items-center gap-4"},we={class:"font-semibold text-gray-900 dark:text-white"},_e={class:"text-sm text-gray-500 dark:text-gray-400"},$e={class:"text-right"},Ce={class:"text-lg font-bold text-gray-900 dark:text-white"},Se={class:"text-sm text-gray-500 dark:text-gray-400"},Ue={key:0,class:"flex items-center gap-4 mb-4"},Oe=["src","alt"],Ie={class:"flex-1 min-w-0"},Ne={class:"font-medium text-gray-900 dark:text-white truncate"},Be={key:0,class:"text-gray-500"},ze={class:"text-sm text-gray-500 dark:text-gray-400"},Te={key:0,class:"text-sm text-gray-400 dark:text-gray-500"},Ve={key:1,class:"flex items-center gap-2 mb-4 text-sm text-gray-600 dark:text-gray-400"},Ae={key:2,class:"flex items-center gap-2 mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-sm"},Me={class:"font-medium text-blue-900 dark:text-blue-100"},Fe={class:"font-mono text-blue-800 dark:text-blue-200"},Le={key:3,class:"flex items-start gap-2 mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg text-sm"},je={class:"text-yellow-800 dark:text-yellow-200"},De={class:"flex flex-wrap items-center gap-2 pt-4 border-t border-gray-200 dark:border-gray-800"},Ee=T({__name:"OrderCard",props:{order:{}},emits:["view","process","ship","track","cancel"],setup(a,{emit:u}){const f=a,e=u,{formatCurrency:p,formatRelativeTime:S}=le(),c=_(()=>f.order.items?.[0]||null),h=_(()=>f.order.status==="paid"),U=_(()=>["paid","processing"].includes(f.order.status)),w=_(()=>f.order.status==="shipped"&&f.order.shipping?.waybill),x=_(()=>["pending_payment","paid"].includes(f.order.status)),k=I=>{I.target.src="https://placehold.co/80x80/1a1a2e/ffffff?text=No+Image"};return(I,n)=>{const N=G,b=F,P=K;return o(),g("div",ke,[s(" Header: Status & Order Info "),t("div",be,[t("div",Pe,[m(N,{color:V(ne)(a.order.statusColor),variant:"soft",size:"lg"},{default:v(()=>[y(i(a.order.statusLabel),1)]),_:1},8,["color"]),t("div",null,[t("p",we,i(a.order.orderNumber),1),t("p",_e,i(V(S)(a.order.createdAt)),1)])]),t("div",$e,[t("p",Ce,i(V(p)(a.order.total)),1),t("p",Se,i(a.order.itemCount)+" item",1)])]),s(" Product Preview "),c.value?(o(),g("div",Ue,[t("img",{src:a.order.firstItemImage||"https://placehold.co/80x80/1a1a2e/ffffff?text=No+Image",alt:c.value.productName||"Product",class:"w-16 h-16 rounded-lg object-cover bg-gray-100 dark:bg-gray-800",onError:k},null,40,Oe),t("div",Ie,[t("p",Ne,[y(i(c.value.productName)+" ",1),c.value.variantName?(o(),g("span",Be,"- "+i(c.value.variantName),1)):s("v-if",!0)]),t("p",ze,i(c.value.quantity)+"x "+i(V(p)(c.value.price||0)),1),a.order.itemCount>1?(o(),g("p",Te," +"+i(a.order.itemCount-1)+" produk lainnya ",1)):s("v-if",!0)])])):s("v-if",!0),s(" Customer Info "),a.order.customer?(o(),g("div",Ve,[m(b,{name:"i-heroicons-user",class:"w-4 h-4"}),t("span",null,i(a.order.customer.name),1),n[5]||(n[5]=t("span",{class:"text-gray-400"},"•",-1)),t("span",null,i(a.order.customer.phone),1)])):s("v-if",!0),s(" Shipping Info "),a.order.shipping?.waybill?(o(),g("div",Ae,[m(b,{name:"i-heroicons-truck",class:"w-5 h-5 text-blue-600 dark:text-blue-400"}),t("span",Me,i(a.order.shipping.courierName),1),n[6]||(n[6]=t("span",{class:"text-blue-600 dark:text-blue-400"},"•",-1)),t("span",Fe,i(a.order.shipping.waybill),1)])):s("v-if",!0),s(" Customer Notes "),a.order.customerNotes?(o(),g("div",Le,[m(b,{name:"i-heroicons-chat-bubble-left-ellipsis",class:"w-5 h-5 text-yellow-600 dark:text-yellow-400 shrink-0 mt-0.5"}),t("p",je,i(a.order.customerNotes),1)])):s("v-if",!0),s(" Action Buttons "),t("div",De,[m(P,{color:"neutral",variant:"ghost",size:"sm",icon:"i-heroicons-eye",onClick:n[0]||(n[0]=B=>e("view",a.order))},{default:v(()=>[...n[7]||(n[7]=[y(" Detail ",-1)])]),_:1}),h.value?(o(),$(P,{key:0,color:"primary",variant:"soft",size:"sm",icon:"i-heroicons-play",onClick:n[1]||(n[1]=B=>e("process",a.order))},{default:v(()=>[...n[8]||(n[8]=[y(" Proses Pesanan ",-1)])]),_:1})):s("v-if",!0),U.value?(o(),$(P,{key:1,color:"primary",size:"sm",icon:"i-heroicons-truck",onClick:n[2]||(n[2]=B=>e("ship",a.order))},{default:v(()=>[y(i(a.order.shipping?.waybill?"Update Resi":"Input Resi"),1)]),_:1})):s("v-if",!0),w.value?(o(),$(P,{key:2,color:"neutral",variant:"soft",size:"sm",icon:"i-heroicons-map-pin",onClick:n[3]||(n[3]=B=>e("track",a.order))},{default:v(()=>[...n[9]||(n[9]=[y(" Lacak ",-1)])]),_:1})):s("v-if",!0),x.value?(o(),$(P,{key:3,color:"error",variant:"ghost",size:"sm",icon:"i-heroicons-x-mark",onClick:n[4]||(n[4]=B=>e("cancel",a.order))},{default:v(()=>[...n[10]||(n[10]=[y(" Batalkan ",-1)])]),_:1})):s("v-if",!0)])])}}}),Re={class:"flex items-center justify-between"},He={key:0,class:"p-8 flex justify-center"},Qe={key:1,class:"p-8 text-center"},qe={key:2,class:"divide-y divide-gray-200 dark:divide-gray-800"},Ke=T({__name:"OrderList",props:{orders:{},total:{},loading:{type:Boolean}},emits:["view","process","ship","track","cancel"],setup(a,{emit:u}){const f=a,e=u,p=_(()=>f.orders.length>0);return(S,c)=>{const h=G,U=F,w=j;return o(),$(w,{ui:{body:{padding:""}}},{header:v(()=>[t("div",Re,[c[0]||(c[0]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Daftar Pesanan",-1)),m(h,{color:"neutral",variant:"soft"},{default:v(()=>[y(i(a.total)+" pesanan",1)]),_:1})])]),footer:v(()=>[se(S.$slots,"pagination")]),default:v(()=>[a.loading?(o(),g("div",He,[m(U,{name:"i-heroicons-arrow-path",class:"w-8 h-8 text-primary-500 animate-spin"})])):p.value?(o(),g("div",qe,[(o(!0),g(M,null,L(a.orders,x=>(o(),$(Ee,{key:x.id,order:x,onView:k=>e("view",x),onProcess:k=>e("process",x),onShip:k=>e("ship",x),onTrack:k=>e("track",x),onCancel:k=>e("cancel",x)},null,8,["order","onView","onProcess","onShip","onTrack","onCancel"]))),128))])):(o(),g("div",Qe,[m(U,{name:"i-heroicons-shopping-bag",class:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),c[1]||(c[1]=t("h3",{class:"mt-4 text-lg font-medium text-gray-900 dark:text-white"},"Belum Ada Pesanan",-1)),c[2]||(c[2]=t("p",{class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},"Pesanan dari pelanggan akan muncul di sini",-1))]))]),_:3})}}}),Ge={class:"space-y-6"},Je={class:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3"},We={class:"text-sm text-gray-500 dark:text-gray-400 order-2 sm:order-1"},Xe={class:"font-medium text-gray-700 dark:text-gray-300"},Ye={class:"font-medium text-gray-700 dark:text-gray-300"},Ze={class:"font-medium text-gray-700 dark:text-gray-300"},et={class:"flex items-center gap-2 order-1 sm:order-2"},tt={class:"flex items-center gap-1"},at={key:1,class:"px-2 text-gray-400"},st={key:2,class:"px-2 text-gray-400"},bt=T({layout:oe,__name:"index",props:{admin:{default:()=>({id:0,storeName:"",cityId:"",districtId:""})},orders:{default:()=>({data:[],meta:{total:0,perPage:10,currentPage:1,lastPage:1,firstPage:1,firstPageUrl:null,lastPageUrl:null,nextPageUrl:null,previousPageUrl:null}})},pagination:{default:()=>({currentPage:1,lastPage:1,total:0,perPage:10})},stats:{default:()=>({total:0,pendingPayment:0,paid:0,processing:0,shipped:0,delivered:0,cancelled:0,needsAction:0})},filters:{default:()=>({status:"",search:"",sortBy:"created_at",sortOrder:"desc"})},couriers:{default:()=>[]},statusOptions:{default:()=>[]}},setup(a){const u=a,f=_(()=>Array.isArray(u.orders)?u.orders:u.orders?.data??[]),e=_(()=>{if(Array.isArray(u.orders))return u.pagination;const l=u.orders?.meta;return{currentPage:l?.currentPage??1,lastPage:l?.lastPage??1,total:l?.total??0,perPage:l?.perPage??10,hasNextPage:l?.nextPageUrl!==null,hasPrevPage:l?.previousPageUrl!==null}}),p=_(()=>{const l=e.value.currentPage,r=e.value.perPage,C=e.value.total,d=C===0?0:(l-1)*r+1,R=Math.min(l*r,C);return{start:d,end:R,total:C}}),S=_(()=>e.value.lastPage>1),{processOrder:c,submitShipping:h,cancelOrder:U,reloadOrders:w}=ie(),x=O(u.filters.status),k=O(u.filters.search),I=O(!1),n=O(!1),N=O(!1),b=O(null),P=O(!1),B=_(()=>[{label:"Perlu Tindakan",value:u.stats?.needsAction??0,color:"warning",icon:"i-heroicons-exclamation-circle"},{label:"Sedang Dikirim",value:u.stats?.shipped??0,color:"primary",icon:"i-heroicons-truck"},{label:"Selesai",value:u.stats?.delivered??0,color:"success",icon:"i-heroicons-check-circle"},{label:"Total Pesanan",value:u.stats?.total??0,color:"neutral",icon:"i-heroicons-shopping-bag"}]),D=()=>{I.value=!0,A.get("/admin/orders",{status:x.value,search:k.value},{preserveState:!0,preserveScroll:!0,onFinish:()=>{I.value=!1}})};let E;q(k,()=>{clearTimeout(E),E=setTimeout(D,500)}),q(x,()=>{D()});const J=l=>{A.visit(`/admin/orders/${l.id}`)},W=async l=>{if(l.status!=="paid")return;await c(l.id)&&w()},X=l=>{b.value=l,n.value=!0},Y=l=>{A.visit(`/admin/orders/${l.id}`)},Z=l=>{b.value=l,N.value=!0},ee=async(l,r)=>{if(!b.value)return;P.value=!0,await h(b.value.id,l,r)&&(n.value=!1,w()),P.value=!1},te=async l=>{if(!b.value)return;P.value=!0,await U(b.value.id,l)&&(N.value=!1,w()),P.value=!1},z=l=>{A.get("/admin/orders",{page:l,status:x.value,search:k.value},{preserveState:!0,preserveScroll:!0})};return(l,r)=>{const C=K;return o(),g("div",Ge,[s(" Page Header "),r[13]||(r[13]=t("div",{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},[t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Pesanan"),t("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Kelola pesanan dari pelanggan Anda ")])],-1)),s(" Stats Cards "),m(xe,{stats:B.value},null,8,["stats"]),s(" Filters "),m(he,{search:k.value,"onUpdate:search":r[0]||(r[0]=d=>k.value=d),status:x.value,"onUpdate:status":r[1]||(r[1]=d=>x.value=d),"status-options":a.statusOptions},null,8,["search","status","status-options"]),s(" Order List "),m(Ke,{orders:f.value,total:e.value?.total??0,loading:I.value,onView:J,onProcess:W,onShip:X,onTrack:Y,onCancel:Z},re({_:2},[S.value?{name:"pagination",fn:v(()=>[t("div",Je,[s(" Info Text "),t("p",We,[r[8]||(r[8]=y(" Menampilkan ",-1)),t("span",Xe,i(p.value.start),1),r[9]||(r[9]=y(" - ",-1)),t("span",Ye,i(p.value.end),1),r[10]||(r[10]=y(" dari ",-1)),t("span",Ze,i(p.value.total),1),r[11]||(r[11]=y(" pesanan ",-1))]),s(" Pagination Controls "),t("div",et,[s(" Previous Button "),m(C,{color:"neutral",variant:"outline",size:"sm",icon:"i-heroicons-chevron-left",disabled:e.value.currentPage<=1,onClick:r[2]||(r[2]=d=>z(e.value.currentPage-1))},null,8,["disabled"]),s(" Page Numbers "),t("div",tt,[s(" First page "),e.value.currentPage>2?(o(),$(C,{key:0,color:"neutral",variant:e.value.currentPage===1?"solid":"ghost",size:"sm",onClick:r[3]||(r[3]=d=>z(1))},{default:v(()=>[...r[12]||(r[12]=[y(" 1 ",-1)])]),_:1},8,["variant"])):s("v-if",!0),s(" Ellipsis before "),e.value.currentPage>3?(o(),g("span",at,"...")):s("v-if",!0),s(" Page numbers around current "),(o(!0),g(M,null,L(e.value.lastPage,d=>(o(),g(M,{key:d},[d>=e.value.currentPage-1&&d<=e.value.currentPage+1?(o(),$(C,{key:0,color:d===e.value.currentPage?"primary":"neutral",variant:d===e.value.currentPage?"solid":"ghost",size:"sm",onClick:R=>z(d)},{default:v(()=>[y(i(d),1)]),_:2},1032,["color","variant","onClick"])):s("v-if",!0)],64))),128)),s(" Ellipsis after "),e.value.currentPage<e.value.lastPage-2?(o(),g("span",st,"...")):s("v-if",!0),s(" Last page "),e.value.currentPage<e.value.lastPage-1?(o(),$(C,{key:3,color:"neutral",variant:e.value.lastPage===e.value.currentPage?"solid":"ghost",size:"sm",onClick:r[4]||(r[4]=d=>z(e.value.lastPage))},{default:v(()=>[y(i(e.value.lastPage),1)]),_:1},8,["variant"])):s("v-if",!0)]),s(" Next Button "),m(C,{color:"neutral",variant:"outline",size:"sm",icon:"i-heroicons-chevron-right",disabled:e.value.currentPage>=e.value.lastPage,onClick:r[5]||(r[5]=d=>z(e.value.currentPage+1))},null,8,["disabled"])])])]),key:"0"}:void 0]),1032,["orders","total","loading"]),s(" Shipping Modal "),m(ue,{open:n.value,"onUpdate:open":r[6]||(r[6]=d=>n.value=d),order:b.value,couriers:a.couriers,loading:P.value,onSubmit:ee},null,8,["open","order","couriers","loading"]),s(" Cancel Modal "),m(de,{open:N.value,"onUpdate:open":r[7]||(r[7]=d=>N.value=d),order:b.value,loading:P.value,onConfirm:te},null,8,["open","order","loading"])])}}});export{bt as default};
